<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Jekyll Multi-Language without Plugin | The Coding Notes</title><meta name=keywords content="Tutorial,English,Blog"><meta name=description content="Goal  Support multi-language, mainly in English and supplemented by Chinese; When visiting pages begin with /, e.g. /about.html, /posts/hello-world, English pages would be shown; When visiting pages began with /zh/, e.g. /zh/about.html, /zh/posts/hello-world, Chinese pages would be shown; When visiting ../hello-world posts, corresponding langugage posts would be jumped via the link; Posts which are specified language would only be shown in archive and index pages.  Defect  As 404."><meta name=author content="Lex Cao"><link rel=canonical href=https://lexcao.io/posts/jekyll-multi-language-without-plugin/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c105fdc36edbfb42d308a2d6ec2b38187ba259d129d7574bcf561ecc44e72262.css integrity="sha256-wQX9w27b+0LTCKLW7Cs4GHuiWdEp11dLz1YezETnImI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://lexcao.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://lexcao.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://lexcao.io/favicon-32x32.png><link rel=apple-touch-icon href=https://lexcao.io/apple-touch-icon.png><link rel=mask-icon href=https://lexcao.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.98.0"><link rel=alternate hreflang=en href=https://lexcao.io/posts/jekyll-multi-language-without-plugin/><link rel=alternate hreflang=zh href=https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/><script async src="https://www.googletagmanager.com/gtag/js?id=G-DDVMDVDZMH"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DDVMDVDZMH",{anonymize_ip:!1})}</script><meta property="og:title" content="Jekyll Multi-Language without Plugin"><meta property="og:description" content="Goal  Support multi-language, mainly in English and supplemented by Chinese; When visiting pages begin with /, e.g. /about.html, /posts/hello-world, English pages would be shown; When visiting pages began with /zh/, e.g. /zh/about.html, /zh/posts/hello-world, Chinese pages would be shown; When visiting ../hello-world posts, corresponding langugage posts would be jumped via the link; Posts which are specified language would only be shown in archive and index pages.  Defect  As 404."><meta property="og:type" content="article"><meta property="og:url" content="https://lexcao.io/posts/jekyll-multi-language-without-plugin/"><meta property="og:image" content="https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format&fit=crop&w=720&q=80"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-27T00:00:00+00:00"><meta property="article:modified_time" content="2019-10-27T00:00:00+00:00"><meta property="og:site_name" content="The Coding Notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format&fit=crop&w=720&q=80"><meta name=twitter:title content="Jekyll Multi-Language without Plugin"><meta name=twitter:description content="Goal  Support multi-language, mainly in English and supplemented by Chinese; When visiting pages begin with /, e.g. /about.html, /posts/hello-world, English pages would be shown; When visiting pages began with /zh/, e.g. /zh/about.html, /zh/posts/hello-world, Chinese pages would be shown; When visiting ../hello-world posts, corresponding langugage posts would be jumped via the link; Posts which are specified language would only be shown in archive and index pages.  Defect  As 404."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://lexcao.io/posts/"},{"@type":"ListItem","position":3,"name":"Jekyll Multi-Language without Plugin","item":"https://lexcao.io/posts/jekyll-multi-language-without-plugin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Jekyll Multi-Language without Plugin","name":"Jekyll Multi-Language without Plugin","description":"Goal  Support multi-language, mainly in English and supplemented by Chinese; When visiting pages begin with /, e.g. /about.html, /posts/hello-world, English pages would be shown; When visiting pages began with /zh/, e.g. /zh/about.html, /zh/posts/hello-world, Chinese pages would be shown; When visiting ../hello-world posts, corresponding langugage posts would be jumped via the link; Posts which are specified language would only be shown in archive and index pages.  Defect  As 404.","keywords":["Tutorial","English","Blog"],"articleBody":"Goal  Support multi-language, mainly in English and supplemented by Chinese; When visiting pages begin with /, e.g. /about.html, /posts/hello-world, English pages would be shown; When visiting pages began with /zh/, e.g. /zh/about.html, /zh/posts/hello-world, Chinese pages would be shown; When visiting ../hello-world posts, corresponding langugage posts would be jumped via the link; Posts which are specified language would only be shown in archive and index pages.  Defect  As 404.html page was not supported for separate language file, two langugage content would be shown on it at the same time. The jekyll-paginate-v2, a plugin supports pagination for multi-language, is not supported by GitHub Pages. So the blog has not been supported pagination so far. See details below. It is a little bit tricky to show date in multi-language way. Some string formatting work should be taken as it is able to have done that but is not a better way. Please see Jekyll Date Formatting.  Setup Firstly, I found a i18n plugin Jekyll Multiple Languages Plugin.\nThe number of stars in this plugin is the most among multi-language plugins, and there are many other related multi-language plugins listed. You can use it without hesitate if you don’t want to setup custom configuration.\nCurrently for simplistic and customize, and also omitting unnecessary features in the plugin, I choose to use custom rules to support multi-language.\n1. Single Post Setting There are two properties needed to added for every posts and pages\n uid for unique post whose English and Chinese are the same uid;  Note: uid can be declared in any other name, e.g document_id.   locale for language symbol which specify what pages should be shown.  So add configuration in Front Matter of every posts\n--- uid: hello-world locale: zh --- 2. For Posts It is very redundant that locale has to be added in Front Matter every posts at every time. Do not repeat yourself. I am going to use different folders to distinguish posts in different languages and set a default value to locale in config file.\nCreate zh folder to store Chinese posts in _posts directory, which origin _posts folder is used to store English posts. When visiting /zh/posts/some-posts Chinese pages are shown.\n(Of course, follow below to set another path to use different directory)\ndefaults:  - values: #1   locale: en  - scope: #2  path: _posts/zh/**  type: posts  values:  locale: zh  #1 not set for scope means global default: all posts and pages are default to en; #2 set for scope means in the path of _posts/zh/**: all posts are default to zh.  3. For Common String The common string is such as Archive and About from menu or Next Page.\nBy the feature of site.data, create locales folder in /_data directory, and create en.yaml and zh.yaml for storing English and Chinese string.\n# in /_data/locales/en.yml menu:  about: About  archive: Archive  # in /_data/locales/zh.yml menu:  about: 关于  archive: 归档 Replace the old words specified by locale\nnav class=\"menu-content\"  a href=\"/about\"{{ site.data.locales[page.locale].menu.about }}a nav 4. For Pages The pages are archive.html and about.html such page type in Jekyll.\nAs use of collection, _zh folder need to be created independently in root directory.\ncollections:  zh:  output: true And create corresponding files in _zh folder\n /menu/archive.html /menu/about.html  5. Language Selector The selector is a button for switching pages or posts between different locale.\nCreate a new file named language-selector.html in _includes folder.\nFinding corresponding language page from posts, pages and collections.\n{% if page.uid %}  div class=\"language-selector\"  {% assign postsOrPages = site.posts   | concat: site.pages  | concat: site.zh  | where: \"uid\", page.uid  | sort: \"locale\" %}  {% for item in postsOrPages %}  {% unless item.url contains '/page/' %}   a href=\"{{ item.url }}\" class=\"{{ item.locale }}\"  {{ site.data.locales[item.locale].name }}   a  {% endunless %}  {% endfor %} div {% endif %}  #1 Selector is shown only on uid existed; #2 Concat the list of posts, pages and zh to find the same uid pages; #3 Filter the pages not in /pages/ folder; #4 Get the common string of language symbol form locale  6. For Archive Page The posts should be filtered in specified locale language manually in archive.html.\nThere is a convenient method to get the next post by post.next which dose not guarantee the same locale posts shown in one page. Should do an alternative way\n   {% assign posts = site.posts | where: \"locale\", page.locale %}  {% for index in (0..posts.size) limit: posts.size %} \t{% assign post = posts[index] %} \t{% assign prevIndex = index | minus: 1 %} \t{% assign prev = posts[prevIndex] %}  \t{% capture year %}{{ post.date | date: '%Y' }}{% endcapture %} \t{% capture prevYear %}{{ prev.date | date: '%Y' }}{% endcapture %}  \t{% if year != prevYear or index == 0 %} \th3{{ year }}h3 \t{% endif %}  \tli itemscope  a href=\"{{ post.url }}\"{{ post.title }}a  p class=\"post-date\"span{{ post.date | date: \"%B %-d\" }}spanp \tli {% endfor %} The key point is that using the index of posts after filtered by locale instead of post.next.\n7. Multi-Language SEO Create a new page named language-seo.html in _included folder to specify corresponding language pages by hreflang.\n{% assign posts = site.posts | where:\"uid\", page.uid | sort: 'locale' %} {% for post in posts %}  link rel=\"alternate\" hreflang=\"{{ post.locale }}\" href=\"{{ post.url }}\" / {% endfor %} As well as include in head.html.\n {% include language-seo.html %} Lastly Some unimportant and regular configuration are omitted, please to see the Source: lexcao.github.io if you want to learn the full setup.\nReferences  Jekyll Multiple Language Plugin Making Jekyll Multilingual Multi Languages with Jekyll Deploy A Multi-Language Jekyll Site Jekyll-Paginate-V2  One More Thing Support Pagination The old pagination plugin jekyll-pagination-v1 is no longer suitable for the short of filtering by the criteria. It is not able to show the one language list of posts on specified language.\nFortunately, jekyll-pagination-v2 announced to support pagination on multi-language way. As I mentioned above, the permitted plugins provided by GitHub Pages does not contain this plugin. Which you need to deploy automated manually if you want to use. Here are setup jekyll-pagination-v2.\nGemfile install $ gem 'jekyll-paginate-v2' _config.yaml setup Note: the configuration of v2 and v1 is not compatible.\nplugins:  - jekyll-paginate-v2  pagination:  enabled: true  per_page: 5  permalink: /page/:num/  sort_reverse: true pages configs You need add more configuration in Front Matter of index.html to paginate.\n# /index.html --- pagination:  enabled: true # yes, enable is needed here  locale: en --- pagination.locale is to specify the criteria of the language according to locale of the pages. I use locale for my custom rules for multi-language so that the pagination use the same filed for reusable.\nCorrespondly, create index.html in _zh folder.\n# /_zh/index.html --- permalink: /zh/ # I don't like suffix of .html so do this pagination:  enabled: true  locale: zh --- Note: I came cross a problem here that the pagination was not working after I put the index.html into _zh folder, which has not been solved yet.\nThe temporary solution was to put zh/index.html file to the root directory, and renamed to index_zh.html.\npaginating The use of paginating is as same as the v1 does. Please see Pagination.\nReferences  Jekyll-Paginate-v2 Jekyll-Paginate-V2 Filter Locales  ","wordCount":"1213","inLanguage":"en","datePublished":"2019-10-27T00:00:00Z","dateModified":"2019-10-27T00:00:00Z","author":{"@type":"Person","name":"Lex Cao"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://lexcao.io/posts/jekyll-multi-language-without-plugin/"},"publisher":{"@type":"Organization","name":"The Coding Notes","logo":{"@type":"ImageObject","url":"https://lexcao.io/favicon.ico"}}}</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-KJ277ZJ" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://lexcao.io accesskey=h title="The Coding Notes (Alt + H)">The Coding Notes</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://lexcao.io/zh/ title=中文 aria-label=中文>中文</a></li></ul></span></div><ul id=menu><li><a href=https://lexcao.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://lexcao.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://lexcao.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://lexcao.io/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://lexcao.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://lexcao.io>Home</a>&nbsp;»&nbsp;<a href=https://lexcao.io/posts/>Posts</a></div><h1 class=post-title>Jekyll Multi-Language without Plugin</h1><div class=post-meta>October 27, 2019&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Lex Cao&nbsp;|&nbsp;<ul class=i18n_list>Translations:<li><a href=https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/>中文</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#goal aria-label=Goal>Goal</a></li><li><a href=#defect aria-label=Defect>Defect</a></li><li><a href=#setup aria-label=Setup>Setup</a><ul><li><a href=#1-single-post-setting aria-label="1. Single Post Setting">1. Single Post Setting</a></li><li><a href=#2-for-posts aria-label="2. For Posts">2. For Posts</a></li><li><a href=#3-for-common-string aria-label="3. For Common String">3. For Common String</a></li><li><a href=#4-for-pages aria-label="4. For Pages">4. For Pages</a></li><li><a href=#5-language-selector aria-label="5. Language Selector">5. Language Selector</a></li><li><a href=#6-for-archive-page aria-label="6. For Archive Page">6. For Archive Page</a></li><li><a href=#7-multi-language-seo aria-label="7. Multi-Language SEO">7. Multi-Language SEO</a></li><li><a href=#lastly aria-label=Lastly>Lastly</a></li></ul></li><li><a href=#references aria-label=References>References</a></li><li><a href=#one-more-thing aria-label="One More Thing">One More Thing</a><ul><li><a href=#support-pagination aria-label="Support Pagination">Support Pagination</a><ul><li><a href=#gemfile-install aria-label="Gemfile install">Gemfile install</a></li><li><a href=#_configyaml-setup aria-label="_config.yaml setup">_config.yaml setup</a></li><li><a href=#pages-configs aria-label="pages configs">pages configs</a></li><li><a href=#paginating aria-label=paginating>paginating</a></li><li><a href=#references-1 aria-label=References>References</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=goal>Goal<a hidden class=anchor aria-hidden=true href=#goal>#</a></h1><ul><li>Support multi-language, mainly in English and supplemented by Chinese;</li><li>When visiting pages begin with <code>/</code>, e.g. <code>/about.html</code>, <code>/posts/hello-world</code>, English pages would be shown;</li><li>When visiting pages began with <code>/zh/</code>, e.g. <code>/zh/about.html</code>, <code>/zh/posts/hello-world</code>, Chinese pages would be shown;</li><li>When visiting <code>../hello-world</code> posts, corresponding langugage posts would be jumped via the link;</li><li>Posts which are specified language would only be shown in <code>archive</code> and <code>index</code> pages.</li></ul><h1 id=defect>Defect<a hidden class=anchor aria-hidden=true href=#defect>#</a></h1><ul><li>As <code>404.html</code> page was not supported for separate language file, two langugage content would be shown on it at the same time.</li><li>The <code>jekyll-paginate-v2</code>, a plugin supports pagination for multi-language, is not supported by GitHub Pages. So the blog has not been supported pagination so far. See details <a href=#pagination><em>below</em></a>.</li><li>It is a little bit tricky to show date in multi-language way. Some string formatting work should be taken as it is able to have done that but is not a better way. Please see <a href=http://alanwsmith.com/jekyll-liquid-date-formatting-examples><em>Jekyll Date Formatting</em></a>.</li></ul><h1 id=setup>Setup<a hidden class=anchor aria-hidden=true href=#setup>#</a></h1><p>Firstly, I found a <code>i18n</code> plugin <a href=https://github.com/kurtsson/jekyll-multiple-languages-plugin><em>Jekyll Multiple Languages Plugin</em></a>.</p><p>The number of stars in this plugin is the most among multi-language plugins, and there are many other related multi-language plugins listed. You can use it without hesitate if you don&rsquo;t want to setup custom configuration.</p><p>Currently for simplistic and customize, and also omitting unnecessary features in the plugin, I choose to use custom rules to support multi-language.</p><h2 id=1-single-post-setting>1. Single Post Setting<a hidden class=anchor aria-hidden=true href=#1-single-post-setting>#</a></h2><p>There are two properties needed to added for every posts and pages</p><ul><li><code>uid</code> for unique post whose English and Chinese are the same <code>uid</code>;<ul><li>Note: <code>uid</code> can be declared in any other name, e.g <code>document_id</code>.</li></ul></li><li><code>locale</code> for language symbol which specify what pages should be shown.</li></ul><p>So add configuration in <code>Front Matter</code> of every posts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>uid</span>: <span style=color:#ae81ff>hello-world</span>
</span></span><span style=display:flex><span><span style=color:#f92672>locale</span>: <span style=color:#ae81ff>zh</span>
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><h2 id=2-for-posts>2. For Posts<a hidden class=anchor aria-hidden=true href=#2-for-posts>#</a></h2><p>It is very redundant that <code>locale</code> has to be added in <code>Front Matter</code> every posts at every time. <strong>Do not repeat yourself</strong>. I am going to use different folders to distinguish posts in different languages and set a default value to <code>locale</code> in config file.</p><p>Create <code>zh</code> folder to store Chinese posts in <code>_posts</code> directory, which origin <code>_posts</code> folder is used to store English posts. When visiting <code>/zh/posts/some-posts</code> Chinese pages are shown.</p><p>(Of course, follow below to set another <code>path</code> to use different directory)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>defaults</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>values</span>: <span style=color:#75715e>#1 </span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>en</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>scope</span>: <span style=color:#75715e>#2</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>_posts/zh/**</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>posts</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>values</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>zh</span>
</span></span></code></pre></div><ul><li>#1 not set for <code>scope</code> means global default: all posts and pages are default to <code>en</code>;</li><li>#2 set for <code>scope</code> means in the path of <code>_posts/zh/**</code>: all posts are default to <code>zh</code>.</li></ul><h2 id=3-for-common-string>3. For Common String<a hidden class=anchor aria-hidden=true href=#3-for-common-string>#</a></h2><p>The common string is such as <code>Archive</code> and <code>About</code> from menu or <code>Next Page</code>.</p><p>By the feature of <code>site.data</code>, create <code>locales</code> folder in <code>/_data</code> directory, and create <code>en.yaml</code> and <code>zh.yaml</code> for storing English and Chinese string.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># in /_data/locales/en.yml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>menu</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>about</span>: <span style=color:#ae81ff>About</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>archive</span>: <span style=color:#ae81ff>Archive</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># in /_data/locales/zh.yml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>menu</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>about</span>: <span style=color:#ae81ff>关于</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>archive</span>: <span style=color:#ae81ff>归档</span>
</span></span></code></pre></div><p>Replace the old words specified by <code>locale</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>nav</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;menu-content&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about&#34;</span>&gt;{{ site.data.locales[page.locale].menu.about }}&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>nav</span>&gt;
</span></span></code></pre></div><h2 id=4-for-pages>4. For Pages<a hidden class=anchor aria-hidden=true href=#4-for-pages>#</a></h2><p>The pages are <code>archive.html</code> and <code>about.html</code> such <code>page</code> type in Jekyll.</p><p>As use of <code>collection</code>, <code>_zh</code> folder need to be created independently in root directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>collections</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>zh</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>output</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>And create corresponding files in <code>_zh</code> folder</p><ul><li><code>/menu/archive.html</code></li><li><code>/menu/about.html</code></li></ul><h2 id=5-language-selector>5. Language Selector<a hidden class=anchor aria-hidden=true href=#5-language-selector>#</a></h2><p>The selector is a button for switching pages or posts between different <code>locale</code>.</p><p>Create a new file named <code>language-selector.html</code> in <code>_includes</code> folder.</p><p>Finding corresponding language page from <code>posts</code>, <code>pages</code> and <code>collections</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{% if page.uid %} <span style=color:#75715e>&lt;!-- #1 --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;language-selector&#34;</span>&gt;
</span></span><span style=display:flex><span>  {% assign postsOrPages = site.posts <span style=color:#75715e>&lt;!-- #2 --&gt;</span>
</span></span><span style=display:flex><span>    | concat: site.pages  
</span></span><span style=display:flex><span>    | concat: site.zh 
</span></span><span style=display:flex><span>    | where: &#34;uid&#34;, page.uid 
</span></span><span style=display:flex><span>    | sort: &#34;locale&#34; %}
</span></span><span style=display:flex><span>  {% for item in postsOrPages %}
</span></span><span style=display:flex><span>  {% unless item.url contains &#39;/page/&#39; %} <span style=color:#75715e>&lt;!-- #3 --&gt;</span>
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ item.url }}&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ item.locale }}&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ site.data.locales[item.locale].name }} <span style=color:#75715e>&lt;!-- #4 --&gt;</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  {% endunless %}
</span></span><span style=display:flex><span>  {% endfor %}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>{% endif %}
</span></span></code></pre></div><ul><li>#1 Selector is shown only on <code>uid</code> existed;</li><li>#2 Concat the list of <code>posts</code>, <code>pages</code> and <code>zh</code> to find the same <code>uid</code> pages;</li><li>#3 Filter the pages not in <code>/pages/</code> folder;</li><li>#4 Get the common string of language symbol form <code>locale</code></li></ul><h2 id=6-for-archive-page>6. For Archive Page<a hidden class=anchor aria-hidden=true href=#6-for-archive-page>#</a></h2><p>The posts should be filtered in specified <code>locale</code> language manually in <code>archive.html</code>.</p><p>There is a convenient method to get the next post by <code>post.next</code> which dose not guarantee the same <code>locale</code> posts shown in one page. Should do an alternative way</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- archive.html --&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- use the index of posts instead of post.next --&gt;</span>
</span></span><span style=display:flex><span>{% assign posts = site.posts | where: &#34;locale&#34;, page.locale %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{% for index in (0..posts.size) limit: posts.size %}
</span></span><span style=display:flex><span>	{% assign post = posts[index] %}
</span></span><span style=display:flex><span>	{% assign prevIndex = index | minus: 1 %}
</span></span><span style=display:flex><span>	{% assign prev = posts[prevIndex] %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	{% capture year %}{{ post.date | date: &#39;%Y&#39; }}{% endcapture %}
</span></span><span style=display:flex><span>	{% capture prevYear %}{{ prev.date | date: &#39;%Y&#39; }}{% endcapture %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	{% if year != prevYear or index == 0 %}
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>h3</span>&gt;{{ year }}&lt;/<span style=color:#f92672>h3</span>&gt;
</span></span><span style=display:flex><span>	{% endif %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>li</span> <span style=color:#a6e22e>itemscope</span>&gt;
</span></span><span style=display:flex><span>  	&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ post.url }}&#34;</span>&gt;{{ post.title }}&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  	&lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post-date&#34;</span>&gt;&lt;<span style=color:#f92672>span</span>&gt;{{ post.date | date: &#34;%B %-d&#34; }}&lt;/<span style=color:#f92672>span</span>&gt;&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>	&lt;/<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>{% endfor %}
</span></span></code></pre></div><p>The key point is that using the <code>index</code> of posts after filtered by <code>locale</code> instead of <code>post.next</code>.</p><h2 id=7-multi-language-seo>7. Multi-Language SEO<a hidden class=anchor aria-hidden=true href=#7-multi-language-seo>#</a></h2><p>Create a new page named <code>language-seo.html</code> in <code>_included</code> folder to specify corresponding language pages by <code>hreflang</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{% assign posts = site.posts | where:&#34;uid&#34;, page.uid | sort: &#39;locale&#39; %}
</span></span><span style=display:flex><span>{% for post in posts %}
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alternate&#34;</span> <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ post.locale }}&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ post.url }}&#34;</span> /&gt;
</span></span><span style=display:flex><span>{% endfor %}
</span></span></code></pre></div><p>As well as include in <code>head.html</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- Language SEO --&gt;</span>
</span></span><span style=display:flex><span>{% include language-seo.html %}
</span></span></code></pre></div><h2 id=lastly>Lastly<a hidden class=anchor aria-hidden=true href=#lastly>#</a></h2><p>Some unimportant and regular configuration are omitted, please to see the <a href=https://github.com/lexcao/lexcao.github.io><em>Source: lexcao.github.io</em></a> if you want to learn the full setup.</p><h1 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h1><ul><li><a href=https://github.com/kurtsson/jekyll-multiple-languages-plugin><em>Jekyll Multiple Language Plugin</em></a></li><li><a href=https://www.sylvaindurand.org/making-jekyll-multilingual/><em>Making Jekyll Multilingual</em></a></li><li><a href=http://meumobi.github.io/jekyll/2019/06/05/multi-languages-with-jekyll.html><em>Multi Languages with Jekyll</em></a></li><li><a href=http://meumobi.github.io/jekyll/2019/06/05/multi-languages-with-jekyll.html><em>Deploy A Multi-Language Jekyll Site</em></a></li><li><a href=https://github.com/sverrirs/jekyll-paginate-v2/blob/master/README-GENERATOR.md><em>Jekyll-Paginate-V2</em></a></li></ul><h1 id=one-more-thing>One More Thing<a hidden class=anchor aria-hidden=true href=#one-more-thing>#</a></h1><h2 id=support-pagination>Support Pagination<a hidden class=anchor aria-hidden=true href=#support-pagination>#</a></h2><p>The old pagination plugin <code>jekyll-pagination-v1</code> is no longer suitable for the short of filtering by the criteria. It is not able to show the one language list of posts on specified language.</p><p>Fortunately, <code>jekyll-pagination-v2</code> announced to support pagination on multi-language way. As I mentioned above, the <a href=https://pages.github.com/versions/><em>permitted plugins</em></a> provided by GitHub Pages does not contain this plugin. Which you need to <a href=https://jekyllrb.com/docs/deployment/automated/><em>deploy automated manually</em></a> if you want to use. Here are setup <code>jekyll-pagination-v2</code>.</p><h3 id=gemfile-install>Gemfile install<a hidden class=anchor aria-hidden=true href=#gemfile-install>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gem <span style=color:#e6db74>&#39;jekyll-paginate-v2&#39;</span>
</span></span></code></pre></div><h3 id=_configyaml-setup>_config.yaml setup<a hidden class=anchor aria-hidden=true href=#_configyaml-setup>#</a></h3><p>Note: the configuration of <code>v2</code> and <code>v1</code> is not compatible.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>plugins</span>: 
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>jekyll-paginate-v2</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#f92672>pagination</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>per_page</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>permalink</span>: <span style=color:#ae81ff>/page/:num/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>sort_reverse</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h3 id=pages-configs>pages configs<a hidden class=anchor aria-hidden=true href=#pages-configs>#</a></h3><p>You need add more configuration in <code>Front Matter</code> of <code>index.html</code> to paginate.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /index.html</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>pagination</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span> <span style=color:#75715e># yes, enable is needed here</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>en</span>
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><p><code>pagination.locale</code> is to specify the criteria of the language according to <code>locale</code> of the pages. I use <code>locale</code> for my custom rules for multi-language so that the pagination use the same filed for reusable.</p><p>Correspondly, create <code>index.html</code> in <code>_zh</code> folder.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /_zh/index.html</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>permalink</span>: <span style=color:#ae81ff>/zh/</span> <span style=color:#75715e># I don&#39;t like suffix of .html so do this</span>
</span></span><span style=display:flex><span><span style=color:#f92672>pagination</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>zh</span>
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><p>Note: I came cross a problem here that the pagination was not working after I put the <code>index.html</code> into <code>_zh</code> folder, which has not been solved yet.</p><p>The temporary solution was to put <code>zh/index.html</code> file to the root directory, and renamed to <code>index_zh.html</code>.</p><h3 id=paginating>paginating<a hidden class=anchor aria-hidden=true href=#paginating>#</a></h3><p>The use of paginating is as same as the <code>v1</code> does. Please see <a href=https://jekyllrb.com/docs/pagination/><em>Pagination</em></a>.</p><h3 id=references-1>References<a hidden class=anchor aria-hidden=true href=#references-1>#</a></h3><ul><li><a href=https://github.com/sverrirs/jekyll-paginate-v2>Jekyll-Paginate-v2</a></li><li><a href=https://github.com/sverrirs/jekyll-paginate-v2/blob/master/README-GENERATOR.md#filtering-locales>Jekyll-Paginate-V2 Filter Locales</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://lexcao.io/tags/tutorial/>Tutorial</a></li><li><a href=https://lexcao.io/tags/english/>English</a></li><li><a href=https://lexcao.io/tags/blog/>Blog</a></li></ul><nav class=paginav><a class=prev href=https://lexcao.io/posts/jekyll-hugo-hexo/><span class=title>« Prev Page</span><br><span>Jekyll / Hugo / Hexo Comparison</span></a>
<a class=next href=https://lexcao.io/posts/hello-world/><span class=title>Next Page »</span><br><span>Hello World</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://lexcao.io>The Coding Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>