<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Jekyll 不使用插件支持多语言 | The Coding Notes</title><meta name=keywords content><meta name=description content="实现目标  支持多语言，英文为主，中文为辅； 当访问 / 根目录下页面，比如 /about.html /posts/hello-world 显示英文页面； 当访问 /zh/ 目录下页面，比如 /zh/about.html /zh/posts/hello-world 显示中文页面； 当访问 ../hello-world 文章时，可以通过链接跳转到对应语言页面； archive 和 index 页面中仅显示出当前语言页面。  相关缺陷  404 页面无法配置，只能在 404.html 页面写上两种语言； 支持多语言文章的分页插件 jekyll-paginate-v2 没在 GitHub Pages 支持的插件白名单内，目前本博客首页不支持分页。多语言分页详见下文； 多语言时间表示有点麻烦，需要做一些字符串处理工作，能实现但是不太优雅，具体可以参考 Jekyll-Date-Formatting。  开始配置 最初，我搜索到 i18n 插件 Jekyll-Multiple-Languages-Plugin。
该仓库的 Star 数是多语言插件中最多的，同时里面也列出了相关其他多语言插件，已经比较完善，不想折腾的可以直接使用。
目前我为了简单和可定制化，同时省略掉插件中不必要的功能，选择使用自定义规则来实现多语言功能。
1. 单个博文配置 每一篇文章和页面需要定义两个属性：
 uid 标示文章唯一，一篇文章的中文版本和英文版本 uid 相同；  注意：uid 可以设置为任意命名，比如 document_id 。   locale 标示文章语言，一篇文章被渲染后作为哪种语言展示。  所以每篇文章的 Front Matter 新增如下设置
--- uid: hello-world locale: zh --- 2."><meta name=author content="Lex Cao"><link rel=canonical href=https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b1540977aafa12664148f5c3a53472ca37129bcd9cbbdf6f6336462e0e1e9ecb.css integrity="sha256-sVQJd6r6EmZBSPXDpTRyyjcSm82cu99vYzZGLg4enss=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://lexcao.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://lexcao.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://lexcao.io/favicon-32x32.png><link rel=apple-touch-icon href=https://lexcao.io/apple-touch-icon.png><link rel=mask-icon href=https://lexcao.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.98.0"><link rel=alternate hreflang=en href=https://lexcao.io/posts/jekyll-multi-language-without-plugin/><link rel=alternate hreflang=zh href=https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/><script async src="https://www.googletagmanager.com/gtag/js?id=G-DDVMDVDZMH"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DDVMDVDZMH",{anonymize_ip:!1})}</script><meta property="og:title" content="Jekyll 不使用插件支持多语言"><meta property="og:description" content="实现目标  支持多语言，英文为主，中文为辅； 当访问 / 根目录下页面，比如 /about.html /posts/hello-world 显示英文页面； 当访问 /zh/ 目录下页面，比如 /zh/about.html /zh/posts/hello-world 显示中文页面； 当访问 ../hello-world 文章时，可以通过链接跳转到对应语言页面； archive 和 index 页面中仅显示出当前语言页面。  相关缺陷  404 页面无法配置，只能在 404.html 页面写上两种语言； 支持多语言文章的分页插件 jekyll-paginate-v2 没在 GitHub Pages 支持的插件白名单内，目前本博客首页不支持分页。多语言分页详见下文； 多语言时间表示有点麻烦，需要做一些字符串处理工作，能实现但是不太优雅，具体可以参考 Jekyll-Date-Formatting。  开始配置 最初，我搜索到 i18n 插件 Jekyll-Multiple-Languages-Plugin。
该仓库的 Star 数是多语言插件中最多的，同时里面也列出了相关其他多语言插件，已经比较完善，不想折腾的可以直接使用。
目前我为了简单和可定制化，同时省略掉插件中不必要的功能，选择使用自定义规则来实现多语言功能。
1. 单个博文配置 每一篇文章和页面需要定义两个属性：
 uid 标示文章唯一，一篇文章的中文版本和英文版本 uid 相同；  注意：uid 可以设置为任意命名，比如 document_id 。   locale 标示文章语言，一篇文章被渲染后作为哪种语言展示。  所以每篇文章的 Front Matter 新增如下设置
--- uid: hello-world locale: zh --- 2."><meta property="og:type" content="article"><meta property="og:url" content="https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/"><meta property="og:image" content="https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format&fit=crop&w=720&q=80"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-26T00:00:00+00:00"><meta property="article:modified_time" content="2019-10-26T00:00:00+00:00"><meta property="og:site_name" content="The Coding Notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format&fit=crop&w=720&q=80"><meta name=twitter:title content="Jekyll 不使用插件支持多语言"><meta name=twitter:description content="实现目标  支持多语言，英文为主，中文为辅； 当访问 / 根目录下页面，比如 /about.html /posts/hello-world 显示英文页面； 当访问 /zh/ 目录下页面，比如 /zh/about.html /zh/posts/hello-world 显示中文页面； 当访问 ../hello-world 文章时，可以通过链接跳转到对应语言页面； archive 和 index 页面中仅显示出当前语言页面。  相关缺陷  404 页面无法配置，只能在 404.html 页面写上两种语言； 支持多语言文章的分页插件 jekyll-paginate-v2 没在 GitHub Pages 支持的插件白名单内，目前本博客首页不支持分页。多语言分页详见下文； 多语言时间表示有点麻烦，需要做一些字符串处理工作，能实现但是不太优雅，具体可以参考 Jekyll-Date-Formatting。  开始配置 最初，我搜索到 i18n 插件 Jekyll-Multiple-Languages-Plugin。
该仓库的 Star 数是多语言插件中最多的，同时里面也列出了相关其他多语言插件，已经比较完善，不想折腾的可以直接使用。
目前我为了简单和可定制化，同时省略掉插件中不必要的功能，选择使用自定义规则来实现多语言功能。
1. 单个博文配置 每一篇文章和页面需要定义两个属性：
 uid 标示文章唯一，一篇文章的中文版本和英文版本 uid 相同；  注意：uid 可以设置为任意命名，比如 document_id 。   locale 标示文章语言，一篇文章被渲染后作为哪种语言展示。  所以每篇文章的 Front Matter 新增如下设置
--- uid: hello-world locale: zh --- 2."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":4,"name":"Jekyll 不使用插件支持多语言","item":"https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Jekyll 不使用插件支持多语言","name":"Jekyll 不使用插件支持多语言","description":"实现目标  支持多语言，英文为主，中文为辅； 当访问 / 根目录下页面，比如 /about.html /posts/hello-world 显示英文页面； 当访问 /zh/ 目录下页面，比如 /zh/about.html /zh/posts/hello-world 显示中文页面； 当访问 ../hello-world 文章时，可以通过链接跳转到对应语言页面； archive 和 index 页面中仅显示出当前语言页面。  相关缺陷  404 页面无法配置，只能在 404.html 页面写上两种语言； 支持多语言文章的分页插件 jekyll-paginate-v2 没在 GitHub Pages 支持的插件白名单内，目前本博客首页不支持分页。多语言分页详见下文； 多语言时间表示有点麻烦，需要做一些字符串处理工作，能实现但是不太优雅，具体可以参考 Jekyll-Date-Formatting。  开始配置 最初，我搜索到 i18n 插件 Jekyll-Multiple-Languages-Plugin。\n该仓库的 Star 数是多语言插件中最多的，同时里面也列出了相关其他多语言插件，已经比较完善，不想折腾的可以直接使用。\n目前我为了简单和可定制化，同时省略掉插件中不必要的功能，选择使用自定义规则来实现多语言功能。\n1. 单个博文配置 每一篇文章和页面需要定义两个属性：\n uid 标示文章唯一，一篇文章的中文版本和英文版本 uid 相同；  注意：uid 可以设置为任意命名，比如 document_id 。   locale 标示文章语言，一篇文章被渲染后作为哪种语言展示。  所以每篇文章的 Front Matter 新增如下设置\n--- uid: hello-world locale: zh --- 2.","keywords":[],"articleBody":"实现目标  支持多语言，英文为主，中文为辅； 当访问 / 根目录下页面，比如 /about.html /posts/hello-world 显示英文页面； 当访问 /zh/ 目录下页面，比如 /zh/about.html /zh/posts/hello-world 显示中文页面； 当访问 ../hello-world 文章时，可以通过链接跳转到对应语言页面； archive 和 index 页面中仅显示出当前语言页面。  相关缺陷  404 页面无法配置，只能在 404.html 页面写上两种语言； 支持多语言文章的分页插件 jekyll-paginate-v2 没在 GitHub Pages 支持的插件白名单内，目前本博客首页不支持分页。多语言分页详见下文； 多语言时间表示有点麻烦，需要做一些字符串处理工作，能实现但是不太优雅，具体可以参考 Jekyll-Date-Formatting。  开始配置 最初，我搜索到 i18n 插件 Jekyll-Multiple-Languages-Plugin。\n该仓库的 Star 数是多语言插件中最多的，同时里面也列出了相关其他多语言插件，已经比较完善，不想折腾的可以直接使用。\n目前我为了简单和可定制化，同时省略掉插件中不必要的功能，选择使用自定义规则来实现多语言功能。\n1. 单个博文配置 每一篇文章和页面需要定义两个属性：\n uid 标示文章唯一，一篇文章的中文版本和英文版本 uid 相同；  注意：uid 可以设置为任意命名，比如 document_id 。   locale 标示文章语言，一篇文章被渲染后作为哪种语言展示。  所以每篇文章的 Front Matter 新增如下设置\n--- uid: hello-world locale: zh --- 2. 对于文章 posts 每篇文章都需要在 Front Matter 中写上 locale 重复多余。不要重复自己。我准备使用不同文件夹来区分不同语言的文章，然后在配置文件设置 locale 的默认值。\n在 _posts 目录下创建 zh 文件夹用于存放中文文章。当访问 /zh/posts/xxx 时即展示中文页面。\n（当然，也可以设置不同的目录，参照以下配置进行设置不同的 path ）\ndefaults:  - values: #1   locale: en  - scope: #2  path: _posts/zh/**  type: posts  values:  locale: zh  #1 未指定 scope 全局默认：所有文章 posts 和页面 pages 默认 en； #2 指定 scope 路径 _posts/zh/** 下 posts 类型：zh。  3. 对于页面中通用的字符串 导航栏中 归档 关于 或者 下一页 等这样的通用字符串。\n使用 site.data 功能来实现，在 /_data 目录下创建 locales 文件夹，并分别创建 en.yml 和 zh.yml 用于存放英文和中文字符串。\n# /_data/locales/en.yml 文件中 menu:  about: About  archive: Archive  # /_data/locales/zh.yml 文件中 menu:  about: 关于  archive: 归档 配置好这些字符串后，在需要替换文字的地方使用\nnav class=\"menu-content\"  a href=\"/about\"{{ site.data.locales[page.locale].menu.about }}a nav 4. 对于页面 pages 一些通用页面：archive.html about.html 等 pages 类型。\n单独在项目根目录下创建一个文件夹 _zh，并作为 collection 来配置\ncollections:  zh:  output: true 在 _zh 文件夹下创建对应页面\n /menu/archive.html /menu/about.html  5. 语言选择器 用于在不同语言的文章或页面中根据 locale 进行切换。\n在 _includes 文件夹下添加一个新文件 language-selector.html。\n遍历 posts、 pages 和 collections 找到相应的语言页面\n{% if page.uid %}  div class=\"language-selector\"  {% assign postsOrPages = site.posts   | concat: site.pages  | concat: site.zh  | where: \"uid\", page.uid  | sort: \"locale\" %}  {% for item in postsOrPages %}  {% unless item.url contains '/page/' %}   a href=\"{{ item.url }}\" class=\"{{ item.locale }}\"  {{ site.data.locales[item.locale].name }}   a  {% endunless %}  {% endfor %} div {% endif %}  #1 仅在有 uid 的页面显示语言选择器 #2 拼接 posts pages zh 数组，找到 uid 对应的页面，根据 local 排序 #3 过滤掉 /pages/ 目录下页面 #4 拿到 locale 对应的语言文字，如 EN 中  6. 归档页面 需要手动多虑掉非本语言页面的文章。\npost.next 提供便捷获取下一篇文章的方法，但是在多语言文章中无法保证 locale 的一致性，需要作出如下修改\n   {% assign posts = site.posts | where: \"locale\", page.locale %}  {% for index in (0..posts.size) limit: posts.size %} \t{% assign post = posts[index] %} \t{% assign prevIndex = index | minus: 1 %} \t{% assign prev = posts[prevIndex] %}  \t{% capture year %}{{ post.date | date: '%Y' }}{% endcapture %} \t{% capture prevYear %}{{ prev.date | date: '%Y' }}{% endcapture %}  \t{% if year != prevYear or index == 0 %} \th3{{ year }}h3 \t{% endif %}  \tli itemscope  a href=\"{{ post.url }}\"{{ post.title }}a  p class=\"post-date\"span{{ post.date | date: \"%B %-d\" }}spanp \tli {% endfor %} 核心思想：先根据 locale 过滤，遍历的时候使用下标而不是 post.next。\n7. 多语言 SEO 在 _includes 文件夹下面创建一个新页面 language-seo.html。\n通过 hreflang 指示对应的语言\n{% assign posts = site.posts | where:\"uid\", page.uid | sort: 'locale' %} {% for post in posts %}  link rel=\"alternate\" hreflang=\"{{ post.locale }}\" href=\"{{ post.url }}\" / {% endfor %} 并且在 head.html 引用\n {% include language-seo.html %} 最后 我省略了一些不重要的常规配置，源码请看 GitHub: lexcao.github.io\n相关参考链接  Jekyll Multiple Language Plugin Making Jekyll Multilingual Multi-Languages-with-Jekyll Deploy A Multi-Language Jekyll Site jekyll-paginate-v2  另一件事 多语言支持分页 旧的分页插件 jekyll-pagination-v1 无法根据筛选条件过滤已经不再适合，不能在对应的语言页面显示对应的语言文章列表。\n如果想在多语言下支持分页，可以使用 jekyll-pagination-v2。我上面提到过 Github Pages 插件 白名单列表 不支持该插件，如果需要使用就需要 手动实现部署。以下是如何配置使用 jekyll-pagination-v2\nGemfile 安装 $ gem 'jekyll-paginate-v2' _config.yml 配置 注意：v2 和 v1 的配置不兼容，需要按照如下配置做相应修改\nplugins:  - jekyll-paginate-v2  pagination:  enabled: true  per_page: 5  permalink: /page/:num/  sort_reverse: true pages 页面配置 首页 index.html 进行分页，需要添加如下配置\n# /index.html --- pagination:  enabled: true # 是的，这里还需要再次开启一次  locale: en --- pagination.locale 此处用来配置分页筛选条件，根据页面的 locale 字段进行过滤。这也是我在 Front Matter 用 locale 字段来标志语言的原因，复用。\n对应的，在 _zh 文件夹下面创建中文首页 index.html。\n# /_zh/index.html --- permalink: /zh/ # 此处是为了让首页不显示 .html 后缀 pagination:  enabled: true  locale: zh --- 注意：我在这里配置的时候，遇到一个问题，当我把 index.html 放到 _zh 文件夹后，分页 locale 筛选不起作用，目前还没解决。\n临时解决方案是将 zh/index.html 放在根目录，并改名为 index_zh.html。\n分页使用 使用没有变化，和 v1 一样的使用方式，详细请看 Pagination\n相关参考链接  Jekyll-Paginate-v2 Jekyll-Paginate-V2 Filter Locales  ","wordCount":"582","inLanguage":"zh","datePublished":"2019-10-26T00:00:00Z","dateModified":"2019-10-26T00:00:00Z","author":{"@type":"Person","name":"Lex Cao"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/"},"publisher":{"@type":"Organization","name":"The Coding Notes","logo":{"@type":"ImageObject","url":"https://lexcao.io/favicon.ico"}}}</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-KJ277ZJ" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://lexcao.io/zh/ accesskey=h title="代码笔记 (Alt + H)">代码笔记</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://lexcao.io/ title=English aria-label=English>English</a></li></ul></span></div><ul id=menu><li><a href=https://lexcao.io/zh/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://lexcao.io/zh/archives/ title=归档><span>归档</span></a></li><li><a href=https://lexcao.io/zh/tags/ title=标签><span>标签</span></a></li><li><a href=https://lexcao.io/zh/projects/ title=项目><span>项目</span></a></li><li><a href=https://lexcao.io/zh/about/ title=关于><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://lexcao.io/zh/>主页</a></div><h1 class=post-title>Jekyll 不使用插件支持多语言</h1><div class=post-meta>2019 October 26&nbsp;·&nbsp;3 分钟&nbsp;·&nbsp;Lex Cao&nbsp;|&nbsp;<ul class=i18n_list>语言:<li><a href=https://lexcao.io/posts/jekyll-multi-language-without-plugin/>English</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>目录</div></summary><div class=inner><ul><li><a href=#%e5%ae%9e%e7%8e%b0%e7%9b%ae%e6%a0%87 aria-label=实现目标>实现目标</a></li><li><a href=#%e7%9b%b8%e5%85%b3%e7%bc%ba%e9%99%b7 aria-label=相关缺陷>相关缺陷</a></li><li><a href=#%e5%bc%80%e5%a7%8b%e9%85%8d%e7%bd%ae aria-label=开始配置>开始配置</a><ul><li><a href=#1-%e5%8d%95%e4%b8%aa%e5%8d%9a%e6%96%87%e9%85%8d%e7%bd%ae aria-label="1. 单个博文配置">1. 单个博文配置</a></li><li><a href=#2-%e5%af%b9%e4%ba%8e%e6%96%87%e7%ab%a0-posts aria-label="2. 对于文章 posts">2. 对于文章 posts</a></li><li><a href=#3-%e5%af%b9%e4%ba%8e%e9%a1%b5%e9%9d%a2%e4%b8%ad%e9%80%9a%e7%94%a8%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2 aria-label="3. 对于页面中通用的字符串">3. 对于页面中通用的字符串</a></li><li><a href=#4-%e5%af%b9%e4%ba%8e%e9%a1%b5%e9%9d%a2-pages aria-label="4. 对于页面 pages">4. 对于页面 pages</a></li><li><a href=#5-%e8%af%ad%e8%a8%80%e9%80%89%e6%8b%a9%e5%99%a8 aria-label="5. 语言选择器">5. 语言选择器</a></li><li><a href=#6-%e5%bd%92%e6%a1%a3%e9%a1%b5%e9%9d%a2 aria-label="6. 归档页面">6. 归档页面</a></li><li><a href=#7-%e5%a4%9a%e8%af%ad%e8%a8%80-seo aria-label="7. 多语言 SEO">7. 多语言 SEO</a></li><li><a href=#%e6%9c%80%e5%90%8e aria-label=最后>最后</a></li></ul></li><li><a href=#%e7%9b%b8%e5%85%b3%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=相关参考链接>相关参考链接</a></li><li><a href=#%e5%8f%a6%e4%b8%80%e4%bb%b6%e4%ba%8b aria-label=另一件事>另一件事</a><ul><li><a href=#%e5%a4%9a%e8%af%ad%e8%a8%80%e6%94%af%e6%8c%81%e5%88%86%e9%a1%b5 aria-label=多语言支持分页>多语言支持分页</a><ul><li><a href=#gemfile-%e5%ae%89%e8%a3%85 aria-label="Gemfile 安装">Gemfile 安装</a></li><li><a href=#_configyml-%e9%85%8d%e7%bd%ae aria-label="_config.yml 配置">_config.yml 配置</a></li><li><a href=#pages-%e9%a1%b5%e9%9d%a2%e9%85%8d%e7%bd%ae aria-label="pages 页面配置">pages 页面配置</a></li><li><a href=#%e5%88%86%e9%a1%b5%e4%bd%bf%e7%94%a8 aria-label=分页使用>分页使用</a></li><li><a href=#%e7%9b%b8%e5%85%b3%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5-1 aria-label=相关参考链接>相关参考链接</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=实现目标>实现目标<a hidden class=anchor aria-hidden=true href=#实现目标>#</a></h1><ul><li>支持多语言，英文为主，中文为辅；</li><li>当访问 <code>/</code> 根目录下页面，比如 <code>/about.html</code> <code>/posts/hello-world</code> 显示英文页面；</li><li>当访问 <code>/zh/</code> 目录下页面，比如 <code>/zh/about.html</code> <code>/zh/posts/hello-world</code> 显示中文页面；</li><li>当访问 <code>../hello-world</code> 文章时，可以通过链接跳转到对应语言页面；</li><li><code>archive</code> 和 <code>index</code> 页面中仅显示出当前语言页面。</li></ul><h1 id=相关缺陷>相关缺陷<a hidden class=anchor aria-hidden=true href=#相关缺陷>#</a></h1><ul><li>404 页面无法配置，只能在 <code>404.html</code> 页面写上两种语言；</li><li>支持多语言文章的分页插件 <code>jekyll-paginate-v2</code> 没在 GitHub Pages 支持的插件白名单内，目前本博客首页不支持分页。多语言分页详见<a href=#paginate>下文</a>；</li><li>多语言时间表示有点麻烦，需要做一些字符串处理工作，能实现但是不太优雅，具体可以参考 <a href=http://alanwsmith.com/jekyll-liquid-date-formatting-examples><em>Jekyll-Date-Formatting</em></a>。</li></ul><h1 id=开始配置>开始配置<a hidden class=anchor aria-hidden=true href=#开始配置>#</a></h1><p>最初，我搜索到 <code>i18n</code> 插件 <a href=https://github.com/kurtsson/jekyll-multiple-languages-plugin><em>Jekyll-Multiple-Languages-Plugin</em></a>。</p><p>该仓库的 Star 数是多语言插件中最多的，同时里面也列出了相关其他多语言插件，已经比较完善，不想折腾的可以直接使用。</p><p>目前我为了简单和可定制化，同时省略掉插件中不必要的功能，选择使用自定义规则来实现多语言功能。</p><h2 id=1-单个博文配置>1. 单个博文配置<a hidden class=anchor aria-hidden=true href=#1-单个博文配置>#</a></h2><p>每一篇文章和页面需要定义两个属性：</p><ul><li><code>uid</code> 标示文章唯一，一篇文章的中文版本和英文版本 <code>uid</code> 相同；<ul><li>注意：<code>uid</code> 可以设置为任意命名，比如 <code>document_id</code> 。</li></ul></li><li><code>locale</code> 标示文章语言，一篇文章被渲染后作为哪种语言展示。</li></ul><p>所以每篇文章的 <code>Front Matter</code> 新增如下设置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>uid</span>: <span style=color:#ae81ff>hello-world</span>
</span></span><span style=display:flex><span><span style=color:#f92672>locale</span>: <span style=color:#ae81ff>zh</span>
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><h2 id=2-对于文章-posts>2. 对于文章 posts<a hidden class=anchor aria-hidden=true href=#2-对于文章-posts>#</a></h2><p>每篇文章都需要在 <code>Front Matter</code> 中写上 <code>locale</code> 重复多余。<strong>不要重复自己</strong>。我准备使用不同文件夹来区分不同语言的文章，然后在配置文件设置 <code>locale</code> 的默认值。</p><p>在 <code>_posts</code> 目录下创建 <code>zh</code> 文件夹用于存放中文文章。当访问 <code>/zh/posts/xxx</code> 时即展示中文页面。</p><p>（当然，也可以设置不同的目录，参照以下配置进行设置不同的 <code>path</code> ）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>defaults</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>values</span>: <span style=color:#75715e>#1 </span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>en</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>scope</span>: <span style=color:#75715e>#2</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>_posts/zh/**</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>posts</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>values</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>zh</span>
</span></span></code></pre></div><ul><li>#1 未指定 <code>scope</code> 全局默认：所有文章 <code>posts</code> 和页面 <code>pages</code> 默认 <code>en</code>；</li><li>#2 指定 <code>scope</code> 路径 <code>_posts/zh/**</code> 下 <code>posts</code> 类型：<code>zh</code>。</li></ul><h2 id=3-对于页面中通用的字符串>3. 对于页面中通用的字符串<a hidden class=anchor aria-hidden=true href=#3-对于页面中通用的字符串>#</a></h2><p>导航栏中 <code>归档</code> <code>关于</code> 或者 <code>下一页</code> 等这样的通用字符串。</p><p>使用 <code>site.data</code> 功能来实现，在 <code>/_data</code> 目录下创建 <code>locales</code> 文件夹，并分别创建 <code>en.yml</code> 和 <code>zh.yml</code> 用于存放英文和中文字符串。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /_data/locales/en.yml 文件中</span>
</span></span><span style=display:flex><span><span style=color:#f92672>menu</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>about</span>: <span style=color:#ae81ff>About</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>archive</span>: <span style=color:#ae81ff>Archive</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># /_data/locales/zh.yml 文件中</span>
</span></span><span style=display:flex><span><span style=color:#f92672>menu</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>about</span>: <span style=color:#ae81ff>关于</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>archive</span>: <span style=color:#ae81ff>归档</span>
</span></span></code></pre></div><p>配置好这些字符串后，在需要替换文字的地方使用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>nav</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;menu-content&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about&#34;</span>&gt;{{ site.data.locales[page.locale].menu.about }}&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>nav</span>&gt;
</span></span></code></pre></div><h2 id=4-对于页面-pages>4. 对于页面 pages<a hidden class=anchor aria-hidden=true href=#4-对于页面-pages>#</a></h2><p>一些通用页面：<code>archive.html</code> <code>about.html</code> 等 <code>pages</code> 类型。</p><p>单独在项目根目录下创建一个文件夹 <code>_zh</code>，并作为 <code>collection</code> 来配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>collections</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>zh</span>: 
</span></span><span style=display:flex><span>    <span style=color:#f92672>output</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>在 <code>_zh</code> 文件夹下创建对应页面</p><ul><li><code>/menu/archive.html</code></li><li><code>/menu/about.html</code></li></ul><h2 id=5-语言选择器>5. 语言选择器<a hidden class=anchor aria-hidden=true href=#5-语言选择器>#</a></h2><p>用于在不同语言的文章或页面中根据 <code>locale</code> 进行切换。</p><p>在 <code>_includes</code> 文件夹下添加一个新文件 <code>language-selector.html</code>。</p><p>遍历 <code>posts</code>、 <code>pages</code> 和 <code>collections</code> 找到相应的语言页面</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{% if page.uid %} <span style=color:#75715e>&lt;!-- #1 --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;language-selector&#34;</span>&gt;
</span></span><span style=display:flex><span>  {% assign postsOrPages = site.posts <span style=color:#75715e>&lt;!-- #2 --&gt;</span>
</span></span><span style=display:flex><span>    | concat: site.pages  
</span></span><span style=display:flex><span>    | concat: site.zh 
</span></span><span style=display:flex><span>    | where: &#34;uid&#34;, page.uid 
</span></span><span style=display:flex><span>    | sort: &#34;locale&#34; %}
</span></span><span style=display:flex><span>  {% for item in postsOrPages %}
</span></span><span style=display:flex><span>  {% unless item.url contains &#39;/page/&#39; %} <span style=color:#75715e>&lt;!-- #3 --&gt;</span>
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ item.url }}&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ item.locale }}&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ site.data.locales[item.locale].name }} <span style=color:#75715e>&lt;!-- #4 --&gt;</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  {% endunless %}
</span></span><span style=display:flex><span>  {% endfor %}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>{% endif %}
</span></span></code></pre></div><ul><li>#1 仅在有 <code>uid</code> 的页面显示语言选择器</li><li>#2 拼接 <code>posts</code> <code>pages</code> <code>zh</code> 数组，找到 <code>uid</code> 对应的页面，根据 <code>local</code> 排序</li><li>#3 过滤掉 <code>/pages/</code> 目录下页面</li><li>#4 拿到 <code>locale</code> 对应的语言文字，如 <code>EN</code> <code>中</code></li></ul><h2 id=6-归档页面>6. 归档页面<a hidden class=anchor aria-hidden=true href=#6-归档页面>#</a></h2><p>需要手动多虑掉非本语言页面的文章。</p><p><code>post.next</code> 提供便捷获取下一篇文章的方法，但是在多语言文章中无法保证 <code>locale</code> 的一致性，需要作出如下修改</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- archive.html --&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- 使用 posts 的下标，而不用 post.next --&gt;</span>
</span></span><span style=display:flex><span>{% assign posts = site.posts | where: &#34;locale&#34;, page.locale %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{% for index in (0..posts.size) limit: posts.size %}
</span></span><span style=display:flex><span>	{% assign post = posts[index] %}
</span></span><span style=display:flex><span>	{% assign prevIndex = index | minus: 1 %}
</span></span><span style=display:flex><span>	{% assign prev = posts[prevIndex] %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	{% capture year %}{{ post.date | date: &#39;%Y&#39; }}{% endcapture %}
</span></span><span style=display:flex><span>	{% capture prevYear %}{{ prev.date | date: &#39;%Y&#39; }}{% endcapture %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	{% if year != prevYear or index == 0 %}
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>h3</span>&gt;{{ year }}&lt;/<span style=color:#f92672>h3</span>&gt;
</span></span><span style=display:flex><span>	{% endif %}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>li</span> <span style=color:#a6e22e>itemscope</span>&gt;
</span></span><span style=display:flex><span>  	&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ post.url }}&#34;</span>&gt;{{ post.title }}&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  	&lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post-date&#34;</span>&gt;&lt;<span style=color:#f92672>span</span>&gt;{{ post.date | date: &#34;%B %-d&#34; }}&lt;/<span style=color:#f92672>span</span>&gt;&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>	&lt;/<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>{% endfor %}
</span></span></code></pre></div><p>核心思想：先根据 <code>locale</code> 过滤，遍历的时候使用下标而不是 <code>post.next</code>。</p><h2 id=7-多语言-seo>7. 多语言 SEO<a hidden class=anchor aria-hidden=true href=#7-多语言-seo>#</a></h2><p>在 <code>_includes</code> 文件夹下面创建一个新页面 <code>language-seo.html</code>。</p><p>通过 <code>hreflang</code> 指示对应的语言</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{% assign posts = site.posts | where:&#34;uid&#34;, page.uid | sort: &#39;locale&#39; %}
</span></span><span style=display:flex><span>{% for post in posts %}
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;alternate&#34;</span> <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ post.locale }}&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ post.url }}&#34;</span> /&gt;
</span></span><span style=display:flex><span>{% endfor %}
</span></span></code></pre></div><p>并且在 <code>head.html</code> 引用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- Language SEO --&gt;</span>
</span></span><span style=display:flex><span>{% include language-seo.html %}
</span></span></code></pre></div><h2 id=最后>最后<a hidden class=anchor aria-hidden=true href=#最后>#</a></h2><p>我省略了一些不重要的常规配置，源码请看 <a href=https://github.com/lexcao/lexcao.github.io><em>GitHub: lexcao.github.io</em></a></p><h1 id=相关参考链接>相关参考链接<a hidden class=anchor aria-hidden=true href=#相关参考链接>#</a></h1><ul><li><a href=https://github.com/kurtsson/jekyll-multiple-languages-plugin><em>Jekyll Multiple Language Plugin</em></a></li><li><a href=https://www.sylvaindurand.org/making-jekyll-multilingual/><em>Making Jekyll Multilingual</em></a></li><li><a href=http://meumobi.github.io/jekyll/2019/06/05/multi-languages-with-jekyll.html><em>Multi-Languages-with-Jekyll</em></a></li><li><a href=http://meumobi.github.io/jekyll/2019/06/05/multi-languages-with-jekyll.html><em>Deploy A Multi-Language Jekyll Site</em></a></li><li><a href=https://github.com/sverrirs/jekyll-paginate-v2/blob/master/README-GENERATOR.md><em>jekyll-paginate-v2</em></a></li></ul><h1 id=另一件事>另一件事<a hidden class=anchor aria-hidden=true href=#另一件事>#</a></h1><h2 id=多语言支持分页>多语言支持分页<a hidden class=anchor aria-hidden=true href=#多语言支持分页>#</a></h2><p>旧的分页插件 <code>jekyll-pagination-v1</code> 无法根据筛选条件过滤已经不再适合，不能在对应的语言页面显示对应的语言文章列表。</p><p>如果想在多语言下支持分页，可以使用 <code>jekyll-pagination-v2</code>。我上面提到过 Github Pages 插件 <a href=https://pages.github.com/versions/>白名单列表</a> 不支持该插件，如果需要使用就需要 <a href=https://jekyllrb.com/docs/deployment/automated/>手动实现部署</a>。以下是如何配置使用 <code>jekyll-pagination-v2</code></p><h3 id=gemfile-安装>Gemfile 安装<a hidden class=anchor aria-hidden=true href=#gemfile-安装>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gem <span style=color:#e6db74>&#39;jekyll-paginate-v2&#39;</span>
</span></span></code></pre></div><h3 id=_configyml-配置>_config.yml 配置<a hidden class=anchor aria-hidden=true href=#_configyml-配置>#</a></h3><p>注意：<code>v2</code> 和 <code>v1</code> 的配置不兼容，需要按照如下配置做相应修改</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>plugins</span>: 
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>jekyll-paginate-v2</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#f92672>pagination</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>per_page</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>permalink</span>: <span style=color:#ae81ff>/page/:num/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>sort_reverse</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h3 id=pages-页面配置>pages 页面配置<a hidden class=anchor aria-hidden=true href=#pages-页面配置>#</a></h3><p>首页 <code>index.html</code> 进行分页，需要添加如下配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /index.html</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>pagination</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span> <span style=color:#75715e># 是的，这里还需要再次开启一次</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>en</span>
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><p><code>pagination.locale</code> 此处用来配置分页筛选条件，根据页面的 <code>locale</code> 字段进行过滤。这也是我在 <code>Front Matter</code> 用 <code>locale</code> 字段来标志语言的原因，复用。</p><p>对应的，在 <code>_zh</code> 文件夹下面创建中文首页 <code>index.html</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /_zh/index.html</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>permalink</span>: <span style=color:#ae81ff>/zh/</span> <span style=color:#75715e># 此处是为了让首页不显示 .html 后缀</span>
</span></span><span style=display:flex><span><span style=color:#f92672>pagination</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>enabled</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>locale</span>: <span style=color:#ae81ff>zh</span>
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><p>注意：我在这里配置的时候，遇到一个问题，当我把 <code>index.html</code> 放到 <code>_zh</code> 文件夹后，分页 <code>locale</code> 筛选不起作用，目前还没解决。</p><p>临时解决方案是将 <code>zh/index.html</code> 放在根目录，并改名为 <code>index_zh.html</code>。</p><h3 id=分页使用>分页使用<a hidden class=anchor aria-hidden=true href=#分页使用>#</a></h3><p>使用没有变化，和 <code>v1</code> 一样的使用方式，详细请看 <a href=https://jekyllrb.com/docs/pagination/><em>Pagination</em></a></p><h3 id=相关参考链接-1>相关参考链接<a hidden class=anchor aria-hidden=true href=#相关参考链接-1>#</a></h3><ul><li><a href=https://github.com/sverrirs/jekyll-paginate-v2>Jekyll-Paginate-v2</a></li><li><a href=https://github.com/sverrirs/jekyll-paginate-v2/blob/master/README-GENERATOR.md#filtering-locales>Jekyll-Paginate-V2 Filter Locales</a></li></ul></div><footer class=post-footer><nav class=paginav><a class=prev href=https://lexcao.io/zh/posts/jekyll-hugo-hexo/><span class=title>« 上一页</span><br><span>Jekyll / Hugo / Hexo 比较</span></a>
<a class=next href=https://lexcao.io/zh/posts/hello-world/><span class=title>下一页 »</span><br><span>你好 世界</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://lexcao.io/zh/>The Coding Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="复制";function s(){e.innerText="已复制！",setTimeout(()=>{e.innerText="复制"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>