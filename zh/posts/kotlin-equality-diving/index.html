<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶ | The Coding Notes</title>
<meta name=keywords content><meta name=description content='æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚
äº‹ç”±
ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚
è¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š
// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾
enum class MyState {
    OK, CANCELED
}

// æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState
fun processing(): MyState? {
		// å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€
    return MyState.CANCELED
}

// åœ¨å¤„ç†çŠ¶æ€æ—¶
fun handleState() {
		// æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State?
    val state = processing()
    if (state == CANCELED) {
        // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ
        println("Handle <CANCELED> state")
    }
}
å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚
import javax.print.attribute.standard.JobState.CANCELED
// æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹
// public static final JobState CANCELED = new JobState (7);
è§£å†³æ–¹æ³•ï¼š'><meta name=author content="Lex Cao"><link rel=canonical href=https://lexcao.io/zh/posts/kotlin-equality-diving/><link crossorigin=anonymous href=/assets/css/stylesheet.0633f72569546c04f177152a4fc857757796b843f92bb1208cf7114db62b1d94.css integrity="sha256-BjP3JWlUbATxdxUqT8hXdXeWuEP5K7EgjPcRTbYrHZQ=" rel="preload stylesheet" as=style><link rel=icon href=https://lexcao.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://lexcao.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://lexcao.io/favicon-32x32.png><link rel=apple-touch-icon href=https://lexcao.io/apple-touch-icon.png><link rel=mask-icon href=https://lexcao.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://lexcao.io/posts/kotlin-equality-diving/><link rel=alternate hreflang=zh href=https://lexcao.io/zh/posts/kotlin-equality-diving/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-DDVMDVDZMH"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DDVMDVDZMH")}</script><meta property="og:title" content="Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶"><meta property="og:description" content='æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚
äº‹ç”±
ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚
è¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š
// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾
enum class MyState {
    OK, CANCELED
}

// æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState
fun processing(): MyState? {
		// å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€
    return MyState.CANCELED
}

// åœ¨å¤„ç†çŠ¶æ€æ—¶
fun handleState() {
		// æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State?
    val state = processing()
    if (state == CANCELED) {
        // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ
        println("Handle <CANCELED> state")
    }
}
å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚
import javax.print.attribute.standard.JobState.CANCELED
// æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹
// public static final JobState CANCELED = new JobState (7);
è§£å†³æ–¹æ³•ï¼š'><meta property="og:type" content="article"><meta property="og:url" content="https://lexcao.io/zh/posts/kotlin-equality-diving/"><meta property="og:image" content="https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format&amp;fit=crop&amp;w=720&amp;q=80"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-21T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-21T00:00:00+00:00"><meta property="og:site_name" content="The Coding Notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format&amp;fit=crop&amp;w=720&amp;q=80"><meta name=twitter:title content="Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶"><meta name=twitter:description content='æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚
äº‹ç”±
ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚
è¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š
// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾
enum class MyState {
    OK, CANCELED
}

// æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState
fun processing(): MyState? {
		// å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€
    return MyState.CANCELED
}

// åœ¨å¤„ç†çŠ¶æ€æ—¶
fun handleState() {
		// æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State?
    val state = processing()
    if (state == CANCELED) {
        // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ
        println("Handle <CANCELED> state")
    }
}
å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚
import javax.print.attribute.standard.JobState.CANCELED
// æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹
// public static final JobState CANCELED = new JobState (7);
è§£å†³æ–¹æ³•ï¼š'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"åšæ–‡","item":"https://lexcao.io/zh/posts/"},{"@type":"ListItem","position":2,"name":"Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶","item":"https://lexcao.io/zh/posts/kotlin-equality-diving/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶","name":"Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶","description":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚\näº‹ç”± ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚\nè¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š\n// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾ enum class MyState { OK, CANCELED } // æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState fun processing(): MyState? { // å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€ return MyState.CANCELED } // åœ¨å¤„ç†çŠ¶æ€æ—¶ fun handleState() { // æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State? val state = processing() if (state == CANCELED) { // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ println(\u0026#34;Handle \u0026lt;CANCELED\u0026gt; state\u0026#34;) } } å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚\nimport javax.print.attribute.standard.JobState.CANCELED // æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹ // public static final JobState CANCELED = new JobState (7); è§£å†³æ–¹æ³•ï¼š\n","keywords":[],"articleBody":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚\näº‹ç”± ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚\nè¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š\n// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾ enum class MyState { OK, CANCELED } // æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState fun processing(): MyState? { // å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€ return MyState.CANCELED } // åœ¨å¤„ç†çŠ¶æ€æ—¶ fun handleState() { // æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State? val state = processing() if (state == CANCELED) { // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ println(\"Handle state\") } } å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚\nimport javax.print.attribute.standard.JobState.CANCELED // æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹ // public static final JobState CANCELED = new JobState (7); è§£å†³æ–¹æ³•ï¼š\n// åˆ é™¤ä¸Šé¢çš„é™æ€å¼•åŒ…ï¼Œæ¢æˆæˆ‘ä»¬çš„ MyState if (state == MyState.CANCELED) { ... } ğŸ‘æ‹æ‹æ‰‹ï¼Œè¿™ä¸ª BUG æ”¹èµ·æ¥çœŸå®¹æ˜“ã€‚åˆå¯ä»¥æ„‰å¿«åœ°æ‘¸é±¼äº†å‘¢ã€‚\nğŸ˜ ç­‰ç­‰ï¼Œä½œä¸ºé™æ€è¯­è¨€é¢å¯¹å¦‚æ­¤è¯¡å¼‚åœ°ç±»å‹ä¸åŒ¹é…ä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Ÿ\nğŸ¤”æ€è€ƒ â“é—®é¢˜ç‚¹ï¼š\nğŸ¤ Kotlin æšä¸¾ç±»å¯¹æ¯” Java çš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œç›´è§‰ä¸Šæ„Ÿè§‰ç±»å‹ä¸åŒ¹é…çš„æƒ…å†µï¼Œä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Ÿ â“â“â“å¤´ä¸Šçš„é—®å·å˜å¤šäº†ï¼š\nKotlin ä¸­å…¶ä»–ç±»å‹ä¼šå‡ºç°è¿™ç§ç±»ä¼¼çš„æƒ…å†µå—ï¼Ÿ Kotlin ç¼–è¯‘å™¨å…·ä½“æ€ä¹ˆå¤„ç†æšä¸¾ç±»å‹çš„ï¼Ÿ Java ä¼šå‡ºç°è¿™ç§æƒ…å†µå—ï¼Ÿï¼ˆåº”è¯¥ä¸ä¼šï¼‰ åœ¨ Stack Overflow å’Œ YouTrack æœäº†ä¸€åœˆï¼Œæ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚ å¯èƒ½æ˜¯æœç´¢å…³é”®å­—ä¸å¯¹ğŸ˜¢ã€‚\nä¸ºäº†æ¢ä¸ªç©¶ç«Ÿï¼Œé€šè¿‡ä»¥ä¸‹å®éªŒç ”ç©¶ Kotlin ç¼–è¯‘å™¨ç±»å‹ä¸åŒ¹é…è¡Œä¸ºã€‚\nã€Œç‚¹å‡»è·³è½¬åˆ°ç»“æœéƒ¨åˆ†ã€\nğŸ”¬å®éªŒ ç¬¬ä¸€æ­¥ å®éªŒé¢„æœŸ å…ˆçœ‹ä¸‹å„è‡ªçš„ç›¸ç­‰ï¼ˆequalityï¼‰è¯­æ³•è¯´æ˜ï¼š\nJava ä¸­ï¼Œ\n== æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å†…å­˜åœ°å€ã€‚å†…å­˜åœ°å€ç›¸åŒçš„å‰ææ˜¯ä¸¤ä¸ªå¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ç§ç±»å‹ï¼› equals() æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ã€‚ Kotlin ä¸­ï¼Œ\nIn Kotlin there are two types of equality: Structural equality (a check for equals()).\na == b =\u003e a?.equals(b) ?: (b === null) Referential equality (two references point to the same object);\na === b =\u003e a and b point to the same object â€” kotlin equality\nä»¥ä¸‹æ˜¯ç®€å•ç¿»è¯‘ï¼š\nKotlin ä¸­æœ‰ä¸¤ç§ç±»å‹çš„ç›¸ç­‰ï¼š\nç»“æ„ç›¸ç­‰ï¼ˆå¯¹ equals() çš„æ£€æŸ¥ï¼‰\na == b =\u003e a?.equals(b) ?: (b === null) å¼•ç”¨ç›¸ç­‰ï¼ˆä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡ï¼‰\na === b =\u003e a å’Œ b æŒ‡å‘åŒä¸€å¯¹åƒ ç®€å•æ¥è¯´ï¼Œ\nJava ä¸­çš„ == å¯¹åº” Kotlin ===ï¼› Kotlin ä¸­çš„ == åŒ…å« Java equals å’Œ ==ã€‚ å…ˆè®¾ç½®ä¸€ä¸ªé¢„æœŸï¼š\nJava ä¸­çš„ç›¸ç­‰ï¼Œ\nequals() æˆåŠŸé€šè¿‡ç¼–è¯‘ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œï¼› æ–¹æ³•å…¥å‚æ˜¯ Objectï¼Œä¸åŒç±»å‹ç›¸æ¯”ä¸ä¼šæŠ¥é”™ã€‚ == ä¸èƒ½ç¼–è¯‘ï¼› å¼•ç”¨ç›¸åŒå‰æéœ€è¦å¯¹è±¡ç›¸åŒã€‚ Kotlin ä¸­çš„ç›¸ç­‰ï¼Œ\n=== ä¸èƒ½ç¼–è¯‘ï¼› ä¸ Java çš„ == è¡Œä¸ºä¸€è‡´ï¼Œå¼•ç”¨ç›¸åŒå‰æéœ€è¦å¯¹è±¡ç›¸åŒã€‚ == ä¸èƒ½ç¼–è¯‘ï¼› a?.equals(b) ?: (b === null) è¿™é‡Œ equals å…¥å‚æ˜¯ Any? èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯åé¢ä¼šå¯¹æ¯”å¯¹è±¡å¼•ç”¨ï¼Œå‡­ç›´è§‰æ¥çœ‹ï¼Œæœ‰å¯¹æ¯”å¼•ç”¨çš„è¯ï¼Œå¦‚æœç±»å‹ä¸ä¸€è‡´ï¼Œä¸èƒ½ç¼–è¯‘ã€‚ ç¬¬äºŒæ­¥ æ”¶é›†å˜é‡ é€šè¿‡ä¸Šé¢å¤ç°å‡ºçš„é—®é¢˜æ¢³ç†å‡ºä»¥ä¸‹å˜é‡ï¼š\nvariable values æ¡ä»¶åˆ¤æ–­è¯­å¥ Kotlin: if / when | Java: if / switch è¡¨è¾¾å¼å¯¹è±¡ Kotlin: class / enum class / object Java: class / enum / static field è¡¨è¾¾å¼å£°æ˜ K - K / J - J / J - K ç¬¬ä¸‰æ­¥ åˆæ­¥ç­›é€‰ å¯¹äºæ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œ\nKotlin çš„ if å’Œ when çš„è¡Œä¸ºä¸€è‡´ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åªä½¿ç”¨ ifï¼› Java ä¸­ switch ä»…æ”¯æŒ enum / String / primitive ï¼Œå†åŠ ä¸Šå¯¹äº enum æœ‰ä¸¥æ ¼ç±»å‹æ ¡éªŒï¼ˆè¯­æ³•å±‚é¢ï¼Œå½“ switch(enum) case è¯­å¥å°±å¤„äºè¯¥ enum çš„ä¸Šä¸‹æ–‡ï¼Œåªèƒ½ä½¿ç”¨è¯¥ enum ä¸­å®šä¹‰çš„å€¼ã€‚ä¸è€ƒè™‘ï¼ŒåŒæ ·åªä½¿ç”¨ ifã€‚ if (condition) {} å¯¹äºç›¸ç­‰åˆ¤æ–­ï¼Œ\nJava ä½¿ç”¨ == å’Œ equals()ï¼› Kotlin ä»…ä½¿ç”¨ == ï¼ˆ=== è¡Œä¸ºä¸ Java ä¸­ == ä¸€è‡´ï¼Œæ•…çœç•¥ï¼‰ã€‚ å¯¹äºè¡¨è¾¾å¼å¯¹è±¡ï¼Œæ¯ä¸ªå®éªŒå¯¹è±¡å®šä¹‰ a / b ï¼Œb ç”¨äºåŒç±»å‹æ—¶å¤‡ç”¨ã€‚\nè¡¨è¾¾å¼å¯¹è±¡ Java Kotlin class MyJavaClassA / MyJavaClassB MyKotlinClassA / MyKotlinClassB enum RetentionPolicy / ElementType AnnotationRetention / AnnotationTarget object / static JobState / JobStateReason MyKotlinObjectA / MyKotlinObjectB public class MyJavaClassA {} // MyJavaClassA.java public class MyJavaClassB {} // MyJavaClassB.java class MyKotlinClassA // MyKotlinClassA.kt class MyKotlinClassB // MyKotlinClassB.kt object MyKotlinObject // MyKotlinObjectA object MyKotlinObject // MyKotlinObjectB // RetentionPolicy : java.lang.annotation.RetentionPolicy // ElementType : java.lang.annotation.ElementType // AnnotationRetention : kotlin.annotation.AnnotationRetention // AnnotationTarget : kotlin.annotation.AnnotationTarget // JobState : javax.print.attribute.standard.JobState // JobStateReason : javax.print.attribute.standard.JobStateReason å¯¹äºè¡¨è¾¾å¼å£°æ˜ï¼Œè¿˜éœ€è¦æ–°å¢ä¸€ä¸ª Kotlin ä¸­ nullable ç±»å‹\n// æ€»å…±æœ‰ä»¥ä¸‹å‡ ç±» J - J K - K K? - K? J - K J - K? K - K? ç¬¬å››æ­¥ éªŒè¯æ¡†æ¶ // java éªŒè¯ä»£ç  public class JavaGenerated { void if_JavaClass_To_JavaClass(MyJavaClassB a) { if (a.equals(new MyJavaClassA())) { } else if (a == new MyJavaClassA()) { } } } // kotlin éªŒè¯ä»£ç  class KotlinGenerated { fun if_JavaClass_To_JavaClass(a: MyJavaClassB) { if (a == MyJavaClassA()) { } } } ç¬¬äº”æ­¥ ç¼–ç éªŒè¯ æœ‰äº†ä¸Šé¢çš„æ¨¡ç‰ˆä¹‹åï¼Œå°±å¯ä»¥æ ¹æ®å˜é‡å¼€å§‹ç¼–ç éªŒè¯ã€‚\né¢å¯¹å¤šç§çš„å˜é‡ç»„åˆçš„æƒ…å†µï¼Œæ‰‹åŠ¨ç¼–å†™å¤§é‡çš„æ¨¡ç‰ˆä»£ç éå¸¸çš„åŠ³ç´¯ã€‚\næ‰€ä»¥åˆ©ç”¨å·¥å…·ï¼Œä½¿ç”¨ JavaPoet å’Œ KotlinPoet æ¥ç”Ÿæˆä»£ç ã€‚\n(èŠ±äº†ä¸€å¤©æ¥å†™è‡ªåŠ¨ç”Ÿæˆä»£ç é€»è¾‘ï¼Œå®Œæˆåæ„Ÿåˆ°ä¸€é˜µç©ºè™šï¼Œä¸ºä»€ä¹ˆè¦èŠ±é‚£ä¹ˆå¤šçš„æ—¶é—´æŠ˜è…¾ï¼Œæ‰‹åŠ¨å¤åˆ¶ç²˜è´´æ—©å†™å®Œäº†ã€‚)\nğŸ˜­è¿™é‡Œå¤§è‡´è¯´ä»¥ä¸‹ç”Ÿæˆçš„æ€è·¯ï¼š\n1. åˆ†åˆ«æšä¸¾å‡ºéœ€è¦æµ‹è¯•çš„ä¸‰ç§ç±»å‹ï¼ŒJavaCase å’Œ KotlinCase 2. JavaCase å’Œ KotlinCase ä¸­ç›¸ä¸¤ä¸¤ç»„åˆ å¾—åˆ° java-kotlin 3. æ ¹æ® java-kotlin å†æ¬¡ç»„åˆ 5 ç§æƒ…å†µ * J 2 J * J 2 K * K 2 K * K? 2 K * K? 2 J 4. æ ¹æ® java-kotlin-pairs ç”Ÿæˆå¯¹åº”çš„ KotlinIf å’Œ JavaIf æ–¹æ³• 5. æ ¹æ®æ–¹æ³•ï¼Œé€šè¿‡ JavaPoet å’Œ KotlinPoet ä»£ç  ç”Ÿæˆåçš„ä»£ç æŒºå¤šçš„ï¼Œæ„Ÿå…´è¶£çš„å»çœ‹ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š\nJavaGenerated.java KotlinGenerated.kt ç¬¬å…­æ­¥ è§‚å¯Ÿç»“æœ ç¯å¢ƒå¦‚ä¸‹\nJava Version 1.8.0_172 Kotlin Version 1.3.72 IDEA Version 2020.1 è¿™é‡Œç»“æœå¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼š\n[error] ï¼Œä¸èƒ½ç¼–è¯‘ã€‚ç¼–è¯‘å™¨å‘Šè­¦ï¼Œåœ¨ IDEA ä¸­çº¢è‰²æ³¢æµªçº¿æ ‡å‡ºï¼› [warning] ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚IDEA å‘Šè­¦ï¼Œä»¥é»„è‰²èƒŒæ™¯é«˜äº®ã€‚ JavaGenerated.java å®Œå…¨ç¬¦åˆé¢„æœŸï¼Œ\n== ä¸èƒ½ç¼–è¯‘ï¼› equals() èƒ½å¤Ÿç¼–è¯‘ï¼Œå¦å¤– IDEA ç»™å‡ºå‹å¥½æé†’ã€‚ type == equals Class [error] Operator â€˜==â€™ cannot be applied [warning] inconvertible types Static [error] Operator â€˜==â€™ cannot be applied [warning] inconvertible types Enum [error] Operator â€˜==â€™ cannot be applied [warning] condition is always false KotlinGenerated.kt éƒ¨åˆ†ç¬¦åˆé¢„æœŸï¼Œ\n=== ä¸èƒ½ç¼–è¯‘ï¼› == å¯¹äº Kotlin çš„ Class / Static ä¸èƒ½ç¼–è¯‘ã€‚ type == Class [error] EQUALITY_NOT_APPLICABLE,Operator â€˜==â€™ cannot be applied Static [error] EQUALITY_NOT_APPLICABLE,Operator â€˜==â€™ cannot be applied Enum [warning] INCOMPATIBLE_ENUM_COMPARISON,Comparison of incompatible enums is always unsuccessful ä¸ç¬¦åˆé¢„æœŸï¼Œ\nJava Class / Static å¯ä»¥ç¼–è¯‘ï¼› Enum å¯ä»¥ç¼–è¯‘ã€‚ ä¸‹é¢æ˜¯ç›¸å…³ä»£ç ï¼š\nfun if_JavaClass_To_JavaClass(a: MyJavaClassB) { if (a == MyJavaClassA()) { } } fun if_JavaStatic_To_JavaStatic(a: JobStateReason) { if (a == JobState.CANCELED) { } } fun if_NullableKotlinEnum_To_JavaStatic(a: AnnotationRetention?) { if (a == JobState.CANCELED) { } } ä»¥ä¸Šæƒ…å†µå¯ä»¥å½’çº³ä¸ºï¼š\nJava å¯¹è±¡ç±»å‹(Class/Static)ï¼Œèƒ½é€šè¿‡ç¼–è¯‘ï¼› JavaClass_To_JavaClass JavaStatic_To_JavaStatic å¯ç©ºçš„ Kotlin æšä¸¾ç±»å‹å¯¹åº” Java é™æ€ç±»å‹ï¼Œèƒ½é€šè¿‡ç¼–è¯‘ï¼› NullableKotlinEnum_To_JavaStatic å¤§è‡´æ¢³ç†å‡ºä»¥ä¸‹ç–‘é—®ç‚¹ï¼š 2. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ 3. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ 4. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ 5. nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ\nç¬¬ä¸ƒæ­¥ æ¢ç©¶åŸå›  å†å›é¡¾ä¸€ä¸‹ Kotlin å®˜æ–¹æ–‡æ¡£ä¸­å¯¹ç›¸ç­‰ï¼ˆequalityï¼‰çš„å®šä¹‰ï¼š\na == b =\u003e a?.equals(b) ?: (b === null) a === b =\u003e a and b point to the same object 1. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ ï¼ˆç›®å‰æ²¡æœ‰æƒ³æ¸…æ¥šåŸå› ï¼‰TODO ï¼šè¿™é‡Œåº”è¯¥å»çœ‹ Kotlin ç¼–è¯‘å™¨åœ¨å¤„ç† EQUALITY_NOT_APPLICABLE è¿™ä¸ªæŠ¥é”™ã€‚\n2. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ åœ¨ Java ä¸­ enum å…¶å®æ˜¯è¯­æ³•ç³–ï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘ä¸ºèŒƒå‹ç±»ã€‚\nabstract class Enum\u003cE extends Enum\u003cE\u003e\u003e { ... } Kotlin ä¸ä¾‹å¤–ï¼Œenum class ä¹Ÿæ˜¯è¯­æ³•ç³–ï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘ä¸ºèŒƒå‹ç±»ã€‚\nabstract class Enum","wordCount":"940","inLanguage":"zh","image":"https://images.unsplash.com/photo-1510843572979-e4b9e790fdd7?auto=format\u0026fit=crop\u0026w=720\u0026q=80","datePublished":"2020-04-21T00:00:00Z","dateModified":"2020-04-21T00:00:00Z","author":{"@type":"Person","name":"Lex Cao"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://lexcao.io/zh/posts/kotlin-equality-diving/"},"publisher":{"@type":"Organization","name":"The Coding Notes","logo":{"@type":"ImageObject","url":"https://lexcao.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://lexcao.io/zh/ accesskey=h title="ä»£ç ç¬”è®° (Alt + H)">ä»£ç ç¬”è®°</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://lexcao.io/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://lexcao.io/zh/search/ title="æœç´¢ (Alt + /)" accesskey=/><span>æœç´¢</span></a></li><li><a href=https://lexcao.io/zh/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://lexcao.io/zh/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://lexcao.io/zh/projects/ title=é¡¹ç›®><span>é¡¹ç›®</span></a></li><li><a href=https://lexcao.io/zh/about/ title=å…³äº><span>å…³äº</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://lexcao.io/zh/>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://lexcao.io/zh/posts/>åšæ–‡</a></div><h1 class="post-title entry-hint-parent">Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶</h1><div class=post-meta><span title='2020-04-21 00:00:00 +0000 UTC'>å››æœˆ 21, 2020</span>&nbsp;Â·&nbsp;5 åˆ†é’Ÿ&nbsp;Â·&nbsp;Lex Cao&nbsp;|&nbsp;ç¿»è¯‘:<ul class=i18n_list><li><a href=https://lexcao.io/posts/kotlin-equality-diving/>English</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e4%ba%8b%e7%94%b1 aria-label=äº‹ç”±>äº‹ç”±</a></li><li><a href=#%e6%80%9d%e8%80%83 aria-label=ğŸ¤”æ€è€ƒ>ğŸ¤”æ€è€ƒ</a></li><li><a href=#%e5%ae%9e%e9%aa%8c aria-label=ğŸ”¬å®éªŒ>ğŸ”¬å®éªŒ</a><ul><li><a href=#%e7%ac%ac%e4%b8%80%e6%ad%a5-%e5%ae%9e%e9%aa%8c%e9%a2%84%e6%9c%9f aria-label="ç¬¬ä¸€æ­¥ å®éªŒé¢„æœŸ">ç¬¬ä¸€æ­¥ å®éªŒé¢„æœŸ</a></li><li><a href=#%e7%ac%ac%e4%ba%8c%e6%ad%a5-%e6%94%b6%e9%9b%86%e5%8f%98%e9%87%8f aria-label="ç¬¬äºŒæ­¥ æ”¶é›†å˜é‡">ç¬¬äºŒæ­¥ æ”¶é›†å˜é‡</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e6%ad%a5-%e5%88%9d%e6%ad%a5%e7%ad%9b%e9%80%89 aria-label="ç¬¬ä¸‰æ­¥ åˆæ­¥ç­›é€‰">ç¬¬ä¸‰æ­¥ åˆæ­¥ç­›é€‰</a></li><li><a href=#%e7%ac%ac%e5%9b%9b%e6%ad%a5-%e9%aa%8c%e8%af%81%e6%a1%86%e6%9e%b6 aria-label="ç¬¬å››æ­¥ éªŒè¯æ¡†æ¶">ç¬¬å››æ­¥ éªŒè¯æ¡†æ¶</a></li><li><a href=#%e7%ac%ac%e4%ba%94%e6%ad%a5-%e7%bc%96%e7%a0%81%e9%aa%8c%e8%af%81 aria-label="ç¬¬äº”æ­¥ ç¼–ç éªŒè¯">ç¬¬äº”æ­¥ ç¼–ç éªŒè¯</a></li><li><a href=#%e7%ac%ac%e5%85%ad%e6%ad%a5-%e8%a7%82%e5%af%9f%e7%bb%93%e6%9e%9c aria-label="ç¬¬å…­æ­¥ è§‚å¯Ÿç»“æœ">ç¬¬å…­æ­¥ è§‚å¯Ÿç»“æœ</a><ul><li><a href=#javageneratedjava aria-label=JavaGenerated.java>JavaGenerated.java</a><ul><li><a href=#kotlingeneratedkt aria-label=KotlinGenerated.kt>KotlinGenerated.kt</a></li></ul></li></ul></li><li><a href=#%e7%ac%ac%e4%b8%83%e6%ad%a5-%e6%8e%a2%e7%a9%b6%e5%8e%9f%e5%9b%a0 aria-label="ç¬¬ä¸ƒæ­¥ æ¢ç©¶åŸå›  ">ç¬¬ä¸ƒæ­¥ æ¢ç©¶åŸå› </a><ul><li><a href=#1-class--static-%e7%9a%84%e5%af%b9%e6%af%94%e4%b8%ba%e4%bb%80%e4%b9%88%e6%af%94-java-%e7%9a%84-equals-%e6%9b%b4%e4%b8%a5%e6%a0%bc aria-label="1. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ">1. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ</a></li><li><a href=#2-%e4%b8%ba%e4%bb%80%e4%b9%88-enum-%e7%9a%84%e5%af%b9%e6%af%94%e5%8f%af%e4%bb%a5%e9%80%9a%e8%bf%87%e7%bc%96%e8%af%91%e6%b2%a1%e6%9c%89%e5%83%8f%e4%b8%8a%e9%9d%a2%e9%82%a3%e4%b9%88%e4%b8%a5%e6%a0%bc aria-label="2. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ">2. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ</a></li><li><a href=#3-%e4%bd%bf%e7%94%a8%e4%b8%a4%e4%b8%aa%e4%b8%8d%e5%90%8c%e7%9a%84-java-%e7%9a%84%e5%af%b9%e8%b1%a1%e5%af%b9%e6%af%94%e4%b8%ba%e4%bb%80%e4%b9%88%e5%8f%af%e4%bb%a5%e9%80%9a%e8%bf%87%e7%bc%96%e8%af%91 aria-label="3. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ">3. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ</a></li><li><a href=#4-kotlin-nullable-%e7%9a%84%e6%9e%9a%e4%b8%be%e7%b1%bb%e4%b8%ba%e4%bb%80%e4%b9%88%e5%8f%af%e4%bb%a5%e4%b8%8e-java-%e7%9a%84%e9%9d%99%e6%80%81%e7%b1%bb%e5%9e%8b%e5%af%b9%e6%af%94 aria-label="4. Kotlin nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ">4. Kotlin nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ</a></li></ul></li></ul></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=ğŸ‘€æ€»ç»“>ğŸ‘€æ€»ç»“</a></li><li><a href=#%e7%9b%b8%e5%85%b3%e9%93%be%e6%8e%a5 aria-label=ğŸ”—ç›¸å…³é“¾æ¥>ğŸ”—ç›¸å…³é“¾æ¥</a></li></ul></div></details></div><div class=post-content><p>æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚</p><h1 id=äº‹ç”±>äº‹ç”±<a hidden class=anchor aria-hidden=true href=#äº‹ç”±>#</a></h1><p>ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ <code>1.3.72</code>ã€‚</p><p>è¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyState</span> {
</span></span><span style=display:flex><span>    OK, CANCELED
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>processing</span>(): MyState? {
</span></span><span style=display:flex><span>		<span style=color:#75715e>// å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>MyState</span>.CANCELED
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åœ¨å¤„ç†çŠ¶æ€æ—¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>handleState</span>() {
</span></span><span style=display:flex><span>		<span style=color:#75715e>// æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State?
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>val</span> state = processing()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (state <span style=color:#f92672>==</span> CANCELED) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        println(<span style=color:#e6db74>&#34;Handle &lt;CANCELED&gt; state&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> javax.print.attribute.standard.JobState.CANCELED
</span></span><span style=display:flex><span><span style=color:#75715e>// æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// public static final JobState CANCELED = new JobState (7);</span>
</span></span></code></pre></div><p>è§£å†³æ–¹æ³•ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// åˆ é™¤ä¸Šé¢çš„é™æ€å¼•åŒ…ï¼Œæ¢æˆæˆ‘ä»¬çš„ MyState
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (state <span style=color:#f92672>==</span> <span style=color:#a6e22e>MyState</span>.CANCELED) { <span style=color:#f92672>..</span>. }
</span></span></code></pre></div><p>ğŸ‘æ‹æ‹æ‰‹ï¼Œè¿™ä¸ª BUG æ”¹èµ·æ¥çœŸå®¹æ˜“ã€‚åˆå¯ä»¥æ„‰å¿«åœ°æ‘¸é±¼äº†å‘¢ã€‚</p><p>ğŸ˜ ç­‰ç­‰ï¼Œä½œä¸ºé™æ€è¯­è¨€é¢å¯¹å¦‚æ­¤è¯¡å¼‚åœ°ç±»å‹ä¸åŒ¹é…ä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Ÿ</p><h1 id=æ€è€ƒ>ğŸ¤”æ€è€ƒ<a hidden class=anchor aria-hidden=true href=#æ€è€ƒ>#</a></h1><p>â“é—®é¢˜ç‚¹ï¼š</p><ul><li>ğŸ¤ Kotlin æšä¸¾ç±»å¯¹æ¯” Java çš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œç›´è§‰ä¸Šæ„Ÿè§‰ç±»å‹ä¸åŒ¹é…çš„æƒ…å†µï¼Œä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Ÿ</li></ul><p>â“â“â“å¤´ä¸Šçš„é—®å·å˜å¤šäº†ï¼š</p><ul><li>Kotlin ä¸­å…¶ä»–ç±»å‹ä¼šå‡ºç°è¿™ç§ç±»ä¼¼çš„æƒ…å†µå—ï¼Ÿ</li><li>Kotlin ç¼–è¯‘å™¨å…·ä½“æ€ä¹ˆå¤„ç†æšä¸¾ç±»å‹çš„ï¼Ÿ</li><li>Java ä¼šå‡ºç°è¿™ç§æƒ…å†µå—ï¼Ÿï¼ˆåº”è¯¥ä¸ä¼šï¼‰</li></ul><p>åœ¨ Stack Overflow å’Œ YouTrack æœäº†ä¸€åœˆï¼Œæ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚<br>å¯èƒ½æ˜¯æœç´¢å…³é”®å­—ä¸å¯¹ğŸ˜¢ã€‚</p><p>ä¸ºäº†æ¢ä¸ªç©¶ç«Ÿï¼Œé€šè¿‡ä»¥ä¸‹å®éªŒç ”ç©¶ Kotlin ç¼–è¯‘å™¨ç±»å‹ä¸åŒ¹é…è¡Œä¸ºã€‚</p><p><a href=/zh/posts/kotlin-equality-diving/#conclusion>ã€Œç‚¹å‡»è·³è½¬åˆ°ç»“æœéƒ¨åˆ†ã€</a></p><h1 id=å®éªŒ>ğŸ”¬å®éªŒ<a hidden class=anchor aria-hidden=true href=#å®éªŒ>#</a></h1><h2 id=ç¬¬ä¸€æ­¥-å®éªŒé¢„æœŸ>ç¬¬ä¸€æ­¥ å®éªŒé¢„æœŸ<a hidden class=anchor aria-hidden=true href=#ç¬¬ä¸€æ­¥-å®éªŒé¢„æœŸ>#</a></h2><p>å…ˆçœ‹ä¸‹å„è‡ªçš„ç›¸ç­‰ï¼ˆ<em><strong>equality</strong></em>ï¼‰è¯­æ³•è¯´æ˜ï¼š</p><p>Java ä¸­ï¼Œ</p><ul><li><code>==</code> æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å†…å­˜åœ°å€ã€‚å†…å­˜åœ°å€ç›¸åŒçš„å‰ææ˜¯ä¸¤ä¸ªå¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ç§ç±»å‹ï¼›</li><li><code>equals()</code> æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ã€‚</li></ul><p>Kotlin ä¸­ï¼Œ</p><blockquote><p>In Kotlin there are two types of equality:
Structural equality (a check for equals()).</p><ul><li><code>a == b</code> => a?.equals(b) ?: (b === null)</li></ul><p>Referential equality (two references point to the same object);</p><ul><li><code>a === b</code> => a and b point to the same object</li></ul><p>&mdash; <a href=https://kotlinlang.org/docs/reference/equality.html>kotlin equality</a></p><p>ä»¥ä¸‹æ˜¯ç®€å•ç¿»è¯‘ï¼š</p><p>Kotlin ä¸­æœ‰ä¸¤ç§ç±»å‹çš„ç›¸ç­‰ï¼š</p><p>ç»“æ„ç›¸ç­‰ï¼ˆå¯¹ equals() çš„æ£€æŸ¥ï¼‰</p><ul><li><code>a == b</code> => <code>a?.equals(b) ?: (b === null)</code></li></ul><p>å¼•ç”¨ç›¸ç­‰ï¼ˆä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡ï¼‰</p><ul><li><code>a === b</code> => a å’Œ b æŒ‡å‘åŒä¸€å¯¹åƒ</li></ul></blockquote><p>ç®€å•æ¥è¯´ï¼Œ</p><ul><li>Java ä¸­çš„ <code>==</code> å¯¹åº” Kotlin <code>===</code>ï¼›</li><li>Kotlin ä¸­çš„ <code>==</code> åŒ…å« Java <code>equals</code> å’Œ <code>==</code>ã€‚</li></ul><p>å…ˆè®¾ç½®ä¸€ä¸ªé¢„æœŸï¼š</p><p>Java ä¸­çš„ç›¸ç­‰ï¼Œ</p><ul><li><code>equals()</code> æˆåŠŸé€šè¿‡ç¼–è¯‘ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œï¼›<ul><li>æ–¹æ³•å…¥å‚æ˜¯ <code>Object</code>ï¼Œä¸åŒç±»å‹ç›¸æ¯”ä¸ä¼šæŠ¥é”™ã€‚</li></ul></li><li><code>==</code> ä¸èƒ½ç¼–è¯‘ï¼›<ul><li>å¼•ç”¨ç›¸åŒå‰æéœ€è¦å¯¹è±¡ç›¸åŒã€‚</li></ul></li></ul><p>Kotlin ä¸­çš„ç›¸ç­‰ï¼Œ</p><ul><li><code>===</code> ä¸èƒ½ç¼–è¯‘ï¼›<ul><li>ä¸ Java çš„ <code>==</code> è¡Œä¸ºä¸€è‡´ï¼Œå¼•ç”¨ç›¸åŒå‰æéœ€è¦å¯¹è±¡ç›¸åŒã€‚</li></ul></li><li><code>==</code> ä¸èƒ½ç¼–è¯‘ï¼›<ul><li><code>a?.equals(b) ?: (b === null)</code> è¿™é‡Œ <code>equals</code> å…¥å‚æ˜¯ <code>Any?</code> èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯åé¢ä¼šå¯¹æ¯”å¯¹è±¡å¼•ç”¨ï¼Œå‡­ç›´è§‰æ¥çœ‹ï¼Œæœ‰å¯¹æ¯”å¼•ç”¨çš„è¯ï¼Œå¦‚æœç±»å‹ä¸ä¸€è‡´ï¼Œä¸èƒ½ç¼–è¯‘ã€‚</li></ul></li></ul><h2 id=ç¬¬äºŒæ­¥-æ”¶é›†å˜é‡>ç¬¬äºŒæ­¥ æ”¶é›†å˜é‡<a hidden class=anchor aria-hidden=true href=#ç¬¬äºŒæ­¥-æ”¶é›†å˜é‡>#</a></h2><p>é€šè¿‡ä¸Šé¢å¤ç°å‡ºçš„é—®é¢˜æ¢³ç†å‡ºä»¥ä¸‹å˜é‡ï¼š</p><table><thead><tr><th>variable</th><th>values</th></tr></thead><tbody><tr><td>æ¡ä»¶åˆ¤æ–­è¯­å¥</td><td>Kotlin: if / when | Java: if / switch</td></tr><tr><td>è¡¨è¾¾å¼å¯¹è±¡</td><td>Kotlin: class / enum class / object<br>Java: class / enum / static field</td></tr><tr><td>è¡¨è¾¾å¼å£°æ˜</td><td>K - K / J - J / J - K</td></tr></tbody></table><h2 id=ç¬¬ä¸‰æ­¥-åˆæ­¥ç­›é€‰>ç¬¬ä¸‰æ­¥ åˆæ­¥ç­›é€‰<a hidden class=anchor aria-hidden=true href=#ç¬¬ä¸‰æ­¥-åˆæ­¥ç­›é€‰>#</a></h2><p>å¯¹äºæ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œ</p><ul><li>Kotlin çš„ if å’Œ when çš„è¡Œä¸ºä¸€è‡´ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åªä½¿ç”¨ ifï¼›</li><li>Java ä¸­ switch ä»…æ”¯æŒ enum / String / primitive ï¼Œå†åŠ ä¸Šå¯¹äº enum æœ‰ä¸¥æ ¼ç±»å‹æ ¡éªŒï¼ˆè¯­æ³•å±‚é¢ï¼Œå½“ <code>switch(enum)</code> case è¯­å¥å°±å¤„äºè¯¥ enum çš„ä¸Šä¸‹æ–‡ï¼Œåªèƒ½ä½¿ç”¨è¯¥ enum ä¸­å®šä¹‰çš„å€¼ã€‚ä¸è€ƒè™‘ï¼ŒåŒæ ·åªä½¿ç”¨ ifã€‚</li></ul><pre tabindex=0><code>if (condition) {}
</code></pre><p>å¯¹äºç›¸ç­‰åˆ¤æ–­ï¼Œ</p><ul><li>Java ä½¿ç”¨ <code>==</code> å’Œ <code>equals()</code>ï¼›</li><li>Kotlin ä»…ä½¿ç”¨ <code>==</code> ï¼ˆ<code>===</code> è¡Œä¸ºä¸ Java ä¸­ <code>==</code> ä¸€è‡´ï¼Œæ•…çœç•¥ï¼‰ã€‚</li></ul><p>å¯¹äºè¡¨è¾¾å¼å¯¹è±¡ï¼Œæ¯ä¸ªå®éªŒå¯¹è±¡å®šä¹‰ a / b ï¼Œb ç”¨äºåŒç±»å‹æ—¶å¤‡ç”¨ã€‚</p><table><thead><tr><th>è¡¨è¾¾å¼<br>å¯¹è±¡</th><th>Java</th><th>Kotlin</th></tr></thead><tbody><tr><td>class</td><td>MyJavaClassA / MyJavaClassB</td><td>MyKotlinClassA / MyKotlinClassB</td></tr><tr><td>enum</td><td>RetentionPolicy / ElementType</td><td>AnnotationRetention / AnnotationTarget</td></tr><tr><td>object / static</td><td>JobState / JobStateReason</td><td>MyKotlinObjectA / MyKotlinObjectB</td></tr></tbody></table><pre tabindex=0><code>public class MyJavaClassA {} // MyJavaClassA.java

public class MyJavaClassB {} // MyJavaClassB.java

class MyKotlinClassA // MyKotlinClassA.kt

class MyKotlinClassB // MyKotlinClassB.kt

object MyKotlinObject // MyKotlinObjectA

object MyKotlinObject // MyKotlinObjectB

// RetentionPolicy      : java.lang.annotation.RetentionPolicy
// ElementType          : java.lang.annotation.ElementType
// AnnotationRetention  : kotlin.annotation.AnnotationRetention
// AnnotationTarget     : kotlin.annotation.AnnotationTarget
// JobState             : javax.print.attribute.standard.JobState
// JobStateReason       : javax.print.attribute.standard.JobStateReason
</code></pre><p>å¯¹äºè¡¨è¾¾å¼å£°æ˜ï¼Œè¿˜éœ€è¦æ–°å¢ä¸€ä¸ª Kotlin ä¸­ nullable ç±»å‹</p><pre tabindex=0><code>// æ€»å…±æœ‰ä»¥ä¸‹å‡ ç±»
J - J
K - K
K? - K?

J - K
J - K?
K - K?
</code></pre><h2 id=ç¬¬å››æ­¥-éªŒè¯æ¡†æ¶>ç¬¬å››æ­¥ éªŒè¯æ¡†æ¶<a hidden class=anchor aria-hidden=true href=#ç¬¬å››æ­¥-éªŒè¯æ¡†æ¶>#</a></h2><pre tabindex=0><code>// java éªŒè¯ä»£ç 
public class JavaGenerated {
		void if_JavaClass_To_JavaClass(MyJavaClassB a) {
    		if (a.equals(new MyJavaClassA())) {
    		} else if (a == new MyJavaClassA()) {
    		}
  	}
}

// kotlin éªŒè¯ä»£ç 
class KotlinGenerated {
  	fun if_JavaClass_To_JavaClass(a: MyJavaClassB) {
    		if (a == MyJavaClassA()) {
    		}
  	}
}
</code></pre><h2 id=ç¬¬äº”æ­¥-ç¼–ç éªŒè¯>ç¬¬äº”æ­¥ ç¼–ç éªŒè¯<a hidden class=anchor aria-hidden=true href=#ç¬¬äº”æ­¥-ç¼–ç éªŒè¯>#</a></h2><p>æœ‰äº†ä¸Šé¢çš„æ¨¡ç‰ˆä¹‹åï¼Œå°±å¯ä»¥æ ¹æ®å˜é‡å¼€å§‹ç¼–ç éªŒè¯ã€‚</p><p>é¢å¯¹å¤šç§çš„å˜é‡ç»„åˆçš„æƒ…å†µï¼Œæ‰‹åŠ¨ç¼–å†™å¤§é‡çš„æ¨¡ç‰ˆä»£ç éå¸¸çš„åŠ³ç´¯ã€‚</p><p>æ‰€ä»¥åˆ©ç”¨å·¥å…·ï¼Œä½¿ç”¨ <a href=https://github.com/square/javapoet><em>JavaPoet</em></a> å’Œ <a href=https://github.com/square/kotlinpoet><em>KotlinPoet</em></a> æ¥ç”Ÿæˆä»£ç ã€‚</p><p>(èŠ±äº†ä¸€å¤©æ¥å†™è‡ªåŠ¨ç”Ÿæˆä»£ç é€»è¾‘ï¼Œå®Œæˆåæ„Ÿåˆ°ä¸€é˜µç©ºè™šï¼Œä¸ºä»€ä¹ˆè¦èŠ±é‚£ä¹ˆå¤šçš„æ—¶é—´æŠ˜è…¾ï¼Œæ‰‹åŠ¨å¤åˆ¶ç²˜è´´æ—©å†™å®Œäº†ã€‚)</p><p>ğŸ˜­è¿™é‡Œå¤§è‡´è¯´ä»¥ä¸‹ç”Ÿæˆçš„æ€è·¯ï¼š</p><pre tabindex=0><code>1. åˆ†åˆ«æšä¸¾å‡ºéœ€è¦æµ‹è¯•çš„ä¸‰ç§ç±»å‹ï¼ŒJavaCase å’Œ KotlinCase
2. JavaCase å’Œ KotlinCase ä¸­ç›¸ä¸¤ä¸¤ç»„åˆ å¾—åˆ° java-kotlin
3. æ ¹æ® java-kotlin å†æ¬¡ç»„åˆ 5 ç§æƒ…å†µ
    * J 2 J
    * J 2 K
    * K 2 K
    * K? 2 K
    * K? 2 J
4. æ ¹æ® java-kotlin-pairs ç”Ÿæˆå¯¹åº”çš„ KotlinIf å’Œ JavaIf æ–¹æ³•
5. æ ¹æ®æ–¹æ³•ï¼Œé€šè¿‡ JavaPoet å’Œ KotlinPoet ä»£ç 
</code></pre><p>ç”Ÿæˆåçš„ä»£ç æŒºå¤šçš„ï¼Œæ„Ÿå…´è¶£çš„å»çœ‹ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š</p><ul><li><a href=https://github.com/lexcao/kotlin-equality/blob/generated/src/main/java/io/github/lexcao/equality/generated/JavaGenerated.java><em>JavaGenerated.java</em></a></li><li><a href=https://github.com/lexcao/kotlin-equality/blob/generated/src/main/kotlin/io/github/lexcao/equality/generated/KotlinGenerated.kt><em>KotlinGenerated.kt</em></a></li></ul><h2 id=ç¬¬å…­æ­¥-è§‚å¯Ÿç»“æœ>ç¬¬å…­æ­¥ è§‚å¯Ÿç»“æœ<a hidden class=anchor aria-hidden=true href=#ç¬¬å…­æ­¥-è§‚å¯Ÿç»“æœ>#</a></h2><blockquote><p>ç¯å¢ƒå¦‚ä¸‹</p><ul><li>Java Version 1.8.0_172</li><li>Kotlin Version 1.3.72</li><li>IDEA Version 2020.1</li></ul></blockquote><p>è¿™é‡Œç»“æœå¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li><strong>[error]</strong> ï¼Œä¸èƒ½ç¼–è¯‘ã€‚ç¼–è¯‘å™¨å‘Šè­¦ï¼Œåœ¨ IDEA ä¸­çº¢è‰²æ³¢æµªçº¿æ ‡å‡ºï¼›</li><li><strong>[warning]</strong> ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚IDEA å‘Šè­¦ï¼Œä»¥é»„è‰²èƒŒæ™¯é«˜äº®ã€‚</li></ul><h3 id=javageneratedjava>JavaGenerated.java<a hidden class=anchor aria-hidden=true href=#javageneratedjava>#</a></h3><p>å®Œå…¨ç¬¦åˆé¢„æœŸï¼Œ</p><ul><li><code>==</code> ä¸èƒ½ç¼–è¯‘ï¼›</li><li><code>equals()</code> èƒ½å¤Ÿç¼–è¯‘ï¼Œå¦å¤– IDEA ç»™å‡ºå‹å¥½æé†’ã€‚</li></ul><table><thead><tr><th>type</th><th>==</th><th>equals</th></tr></thead><tbody><tr><td>Class</td><td><strong>[error]</strong> Operator &lsquo;==&rsquo;<br>cannot be applied</td><td><strong>[warning]</strong> inconvertible types</td></tr><tr><td>Static</td><td><strong>[error]</strong> Operator &lsquo;==&rsquo;<br>cannot be applied</td><td><strong>[warning]</strong> inconvertible types</td></tr><tr><td>Enum</td><td><strong>[error]</strong> Operator &lsquo;==&rsquo;<br>cannot be applied</td><td><strong>[warning]</strong> condition is always false</td></tr></tbody></table><h4 id=kotlingeneratedkt>KotlinGenerated.kt<a hidden class=anchor aria-hidden=true href=#kotlingeneratedkt>#</a></h4><p>éƒ¨åˆ†ç¬¦åˆé¢„æœŸï¼Œ</p><ul><li><code>===</code> ä¸èƒ½ç¼–è¯‘ï¼›</li><li><code>==</code> å¯¹äº Kotlin çš„ Class / Static ä¸èƒ½ç¼–è¯‘ã€‚</li></ul><table><thead><tr><th>type</th><th>==</th></tr></thead><tbody><tr><td>Class</td><td><strong>[error]</strong> EQUALITY_NOT_APPLICABLE,<br>Operator &lsquo;==&rsquo; cannot be applied</td></tr><tr><td>Static</td><td><strong>[error]</strong> EQUALITY_NOT_APPLICABLE,<br>Operator &lsquo;==&rsquo; cannot be applied</td></tr><tr><td>Enum</td><td><strong>[warning]</strong> INCOMPATIBLE_ENUM_COMPARISON,<br>Comparison of incompatible enums is always unsuccessful</td></tr></tbody></table><p>ä¸ç¬¦åˆé¢„æœŸï¼Œ</p><ul><li>Java Class / Static å¯ä»¥ç¼–è¯‘ï¼›</li><li>Enum å¯ä»¥ç¼–è¯‘ã€‚</li></ul><p>ä¸‹é¢æ˜¯ç›¸å…³ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>if</span>_JavaClass_To_JavaClass(a: MyJavaClassB) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> MyJavaClassA()) {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>if</span>_JavaStatic_To_JavaStatic(a: JobStateReason) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#a6e22e>JobState</span>.CANCELED) {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>if</span>_NullableKotlinEnum_To_JavaStatic(a: AnnotationRetention?) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#a6e22e>JobState</span>.CANCELED) {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä»¥ä¸Šæƒ…å†µå¯ä»¥å½’çº³ä¸ºï¼š</p><ul><li>Java å¯¹è±¡ç±»å‹(Class/Static)ï¼Œèƒ½é€šè¿‡ç¼–è¯‘ï¼›<ul><li>JavaClass_To_JavaClass</li><li>JavaStatic_To_JavaStatic</li></ul></li><li>å¯ç©ºçš„ Kotlin æšä¸¾ç±»å‹å¯¹åº” Java é™æ€ç±»å‹ï¼Œèƒ½é€šè¿‡ç¼–è¯‘ï¼›<ul><li>NullableKotlinEnum_To_JavaStatic</li></ul></li></ul><p>å¤§è‡´æ¢³ç†å‡ºä»¥ä¸‹ç–‘é—®ç‚¹ï¼š
2. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ
3. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ
4. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ
5. nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ</p><h2 id=ç¬¬ä¸ƒæ­¥-æ¢ç©¶åŸå› >ç¬¬ä¸ƒæ­¥ æ¢ç©¶åŸå›  <a name=conclusion><a hidden class=anchor aria-hidden=true href=#ç¬¬ä¸ƒæ­¥-æ¢ç©¶åŸå› >#</a></h2><p>å†å›é¡¾ä¸€ä¸‹ Kotlin å®˜æ–¹æ–‡æ¡£ä¸­å¯¹ç›¸ç­‰ï¼ˆ<em><strong>equality</strong></em>ï¼‰çš„å®šä¹‰ï¼š</p><pre tabindex=0><code>a == b =&gt; a?.equals(b) ?: (b === null)
a === b =&gt; a and b point to the same object
</code></pre><h3 id=1-class--static-çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯”-java-çš„-equals-æ›´ä¸¥æ ¼>1. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#1-class--static-çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯”-java-çš„-equals-æ›´ä¸¥æ ¼>#</a></h3><p>ï¼ˆç›®å‰æ²¡æœ‰æƒ³æ¸…æ¥šåŸå› ï¼‰TODO ï¼šè¿™é‡Œåº”è¯¥å»çœ‹ Kotlin ç¼–è¯‘å™¨åœ¨å¤„ç† <code>EQUALITY_NOT_APPLICABLE</code> è¿™ä¸ªæŠ¥é”™ã€‚</p><h3 id=2-ä¸ºä»€ä¹ˆ-enum-çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘æ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼>2. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#2-ä¸ºä»€ä¹ˆ-enum-çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘æ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼>#</a></h3><p>åœ¨ Java ä¸­ <code>enum</code> å…¶å®æ˜¯è¯­æ³•ç³–ï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘ä¸ºèŒƒå‹ç±»ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Enum</span><span style=color:#f92672>&lt;</span>E <span style=color:#66d9ef>extends</span> Enum<span style=color:#f92672>&lt;</span>E<span style=color:#f92672>&gt;&gt;</span> { ... }
</span></span></code></pre></div><p>Kotlin ä¸ä¾‹å¤–ï¼Œ<code>enum class</code> ä¹Ÿæ˜¯è¯­æ³•ç³–ï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘ä¸ºèŒƒå‹ç±»ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Enum</span>&lt;E : Enum&lt;E&gt;&gt; { <span style=color:#f92672>..</span>. }
</span></span></code></pre></div><p>å½“ä¸¤ä¸ªæšä¸¾å¯¹æ¯”çš„æ—¶å€™ï¼Œç›¸å½“ä¸æ˜¯åŒä¸€ä¸ªç±»çš„ä¸åŒèŒƒå‹ï¼Œæ‰€ä»¥èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä¸ä¼šå‡ºç°ç±»å‹ä¸åŒ¹é…é—®é¢˜ã€‚</p><p>è¿™é‡Œï¼ŒIDEA å‘Šè­¦ <code>INCOMPATIBLE_ENUM_COMPARISON</code> ç»™å‡ºå‹å¥½æç¤ºã€‚</p><h3 id=3-ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„-java-çš„å¯¹è±¡å¯¹æ¯”ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘>3. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#3-ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„-java-çš„å¯¹è±¡å¯¹æ¯”ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘>#</a></h3><p>Kotlin ä¸­æœ‰ä¸¥æ ¼çš„ <code>Nullable / Notnull</code> è¯­æ³•ã€‚</p><p>å½“ä¸ Java çš„ç±»è¿›è¡Œäº’ç›¸è°ƒç”¨æ—¶ï¼Œç”±äº Java ä¸­çš„ <code>Null</code> ä¿¡æ¯ä¸ç¡®å®šï¼Œç¼–è¯‘å™¨æ— æ³•æ¨æ–­å‡º Java ç±»çš„å…·ä½“ <code>Null</code> ä¿¡æ¯(é»˜è®¤è§†ä¸º <code>Nullable</code>)ã€‚<br>å¯ä»¥åœ¨ IDEA çš„æ™ºèƒ½ç±»å‹æ¨æ–­ä¸­çœ‹åˆ° <code>!</code> çš„æ ‡è¯†ã€‚<br>ï¼ˆåœ¨ Java ä¸­æ˜¾å¼ä½¿ç”¨ JetBrains æä¾›çš„ <code>@Nullable / @NotNull</code> è¿™ä¸¤ä¸ªæ³¨è§£ï¼Œå¯ä»¥è®© Kotlin ç¼–è¯‘å™¨æ­£ç¡®æ¨æ–­å‡º <code>Null</code> ä¿¡æ¯ï¼‰
ã€TODOï¼Œæä¾› IDEA æˆªå›¾æ›´å¥½ã€‘</p><p>æ‰€ä»¥ä¸¤ä¸ª <code>Nullable</code> ç±»å‹çš„è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šèµ°åˆ° <code>b === null</code> è¿™ä¸ªåˆ¤æ–­ï¼Œä¸ä¼šæŠ¥é”™ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚</p><h3 id=4-kotlin-nullable-çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸-java-çš„é™æ€ç±»å‹å¯¹æ¯”>4. Kotlin nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#4-kotlin-nullable-çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸-java-çš„é™æ€ç±»å‹å¯¹æ¯”>#</a></h3><p>è¿›è¡Œä¸Šè¿°å‰ç½®æ¢ç´¢ï¼Œç»ˆäºåˆ°è¿™æ¬¡é—®é¢˜çš„ç»ˆç‚¹ã€‚ç»“åˆä¸Šé¢çš„ç»“è®ºï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>æšä¸¾ç±»ç¼–è¯‘åæ˜¯åŒä¸€ä¸ª <code>Enum</code> ç±»ï¼›</li><li>Java çš„é™æ€ç±»å‹ <code>Null</code> ä¿¡æ¯æœªçŸ¥ï¼›</li><li>ä¸¤ä¸ª <code>Nullable</code> ç±»å‹è¿›è¡Œå¯¹æ¯”ï¼Œä¼šèµ°åˆ° <code>b === null</code> åˆ¤æ–­ï¼Œä¸ä¼šæŠ¥é”™ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// ç»™ Java çš„ç±»æ˜ç¡®çš„ Null ä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#75715e>// IDEA å‡ºç°å‹å¥½è­¦å‘Š [INCOMPATIBLE_ENUM_COMPARISON]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>if</span>_NullableKotlinEnum_To_JavaStatic(a: AnnotationRetention?) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ä½¿ç”¨ !! å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ˜ç¡® Null ä¿¡æ¯æ˜¯ Notnull
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#a6e22e>JobState</span>.CANCELED<span style=color:#f92672>!!</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// [INCOMPATIBLE_ENUM_COMPARISON] Comparison of incompatible enums 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// &#39;AnnotationRetention?&#39; and &#39;JobState&#39; is always unsuccessful
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=æ€»ç»“>ğŸ‘€æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h1><ul><li>æ•´ä¸ªæ¢æ±‚çœŸç›¸çš„è¿‡ç¨‹è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ï¼›</li><li>æœ€åçŸ¥é“çœŸç›¸åï¼Œè¿˜æ˜¯è‡ªå·±å¤ªèœäº†ï¼ŒåŸºç¡€çŸ¥è¯†æ²¡æœ‰å®Œå…¨æŒæ¡ï¼›</li><li>æ·±å…¥æ¢ç©¶äº† Kotlin å’Œ Java çš„ç›¸ç­‰å’Œæšä¸¾ç›¸å…³çš„å†…å®¹ï¼›</li><li>ä¸‹ä¸€æ­¥ï¼šè¶ç€è¿™è‚¡å¥½å¥‡å¿ƒï¼Œå»äº†è§£ Kotlin ç¼–è¯‘å™¨çš„ç›¸ç­‰ç±»å‹åˆ¤æ–­æºç ã€‚</li></ul><h1 id=ç›¸å…³é“¾æ¥>ğŸ”—ç›¸å…³é“¾æ¥<a hidden class=anchor aria-hidden=true href=#ç›¸å…³é“¾æ¥>#</a></h1><ul><li><a href=https://github.com/lexcao/kotlin-java-equality-palyground><em><strong>GitHub Source Code</strong></em></a></li><li><a href=https://kotlinlang.org/docs/reference/equality.html><em><strong>Kotlin Equality Docs</strong></em></a></li><li><a href=https://github.com/square/javapoet><em>JavaPoet</em></a></li><li><a href=https://github.com/square/kotlinpoet><em>KotlinPoet</em></a></li><li><a href=https://github.com/lexcao/kotlin-equality/blob/generated/src/main/java/io/github/lexcao/equality/generated/JavaGenerated.java><em>JavaGenerated.java</em></a></li><li><a href=https://github.com/lexcao/kotlin-equality/blob/generated/src/main/kotlin/io/github/lexcao/equality/generated/KotlinGenerated.kt><em>KotlinGenerated.kt</em></a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://lexcao.io/zh/posts/kotlin-java-tdd-example/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>Kotlin/Java TDD å¼€å‘æµç¨‹è®°å½•</span>
</a><a class=next href=https://lexcao.io/zh/posts/konverter/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>ä½¿ç”¨ KAPT ç”Ÿæˆ Kotlin Data Class è½¬æ¢å™¨</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://lexcao.io/zh/>The Coding Notes</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>