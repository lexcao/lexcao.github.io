[{"content":"é€šè¿‡ä½¿ç”¨ Kotlin / Java ä¸­ Junit5 å’Œ Mockito æµ‹è¯•æ¡†æ¶ï¼Œåœ¨é¢„çº¦åŠŸèƒ½ä¸­æ¼”ç¤º TDD å¼€å‘æµç¨‹ã€‚\nTDD ä»‹ç» TDDï¼ˆTest-Driven Developmentï¼‰ æ˜¯ä¸€ç§å¼€å‘æµç¨‹ï¼Œä¸­æ–‡æ˜¯ã€Œæµ‹è¯•é©±åŠ¨å¼€å‘ã€ã€‚ç”¨ä¸€å¥ç™½è¯å½¢å®¹ï¼Œå°±æ˜¯ã€Œå…ˆå†™æµ‹è¯•å†å¼€å‘ã€ã€‚å…ˆå†™æµ‹è¯•é™¤äº†èƒ½ç¡®ä¿æµ‹è¯•ç¨‹å¼çš„æ’°å†™ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼šæœ‰åŠ©äºåœ¨å¼€å‘åˆæœŸå˜æ¸…ç¨‹å¼ä»‹é¢å¦‚ä½•è®¾è®¡ã€‚è¯¦ç»†ç†è®ºçŸ¥è¯†å¯ä»¥å‰å¾€ Wiki äº†è§£ï¼Œè¿™é‡Œä¸å†è¿‡å¤šä»‹ç»ã€‚\n æµ‹è¯•é©±åŠ¨å¼€å‘ Test Driven Development  TDD å¼€å‘æµç¨‹ï¼ˆ5æ­¥ï¼‰ æœ¯è¯­è¯´æ˜ï¼š\n çº¢ç¯ - Failure - æµ‹è¯•ç”¨ä¾‹å¤±è´¥ ç»¿ç¯ - Success - æµ‹è¯•ç”¨ä¾‹æˆåŠŸ é‡æ„ - Refactor - é‡æ„åŠŸèƒ½ä»£ç   å…·ä½“æ­¥éª¤ï¼š\n é€‰å®šä¸€ä¸ªåŠŸèƒ½ï¼Œç¼–å†™æµ‹è¯•ç”¨ä¾‹ æ‰§è¡Œæµ‹è¯•ï¼Œå¾—åˆ°ã€çº¢ç¯ã€‘ ç¼–å†™æ»¡è¶³æµ‹è¯•ç”¨ä¾‹çš„åŠŸèƒ½ä»£ç  å†æ¬¡æ‰§è¡Œï¼Œå¾—åˆ°ã€ç»¿ç¯ã€‘ ã€é‡æ„ã€‘ä»£ç   å°ç»“ï¼š\nå¯¹äºæ¯ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ã€çº¢ç¯ã€‘-ã€ç»¿ç¯ã€‘-ã€é‡æ„ã€‘é—´æ¥å›å¾ªç¯å¾€å¤ï¼Œä¸æ–­å¾—åˆ°å®Œå–„ã€‚\nå‰ç½®å·¥ä½œ ä»£ç è¯´æ˜  ä½¿ç”¨ Kotlin è¯­è¨€ï¼ˆä¼šæœ‰ç›¸å¯¹åº”çš„ Java ä»£ç ï¼‰ ä½¿ç”¨åˆ°çš„æµ‹è¯•æ¡†æ¶  Running: JUnit5 Mock: MockK / Mockito Assertion: Kotest / AssertJ   åªæ¶‰åŠ TDD çš„å…·ä½“æµç¨‹ï¼Œä¸æ¶‰åŠå•å…ƒæµ‹è¯•å¦‚ä½•ç¼–å†™ï¼ˆå¯ä»¥çœ‹ SpringBoot å•å…ƒæµ‹è¯•å„å±‚ï¼‰  åŠŸèƒ½ä»‹ç» å‡è®¾ä¸€ä¸ªç”¨æˆ·é¢„çº¦çš„åœºæ™¯ã€‚\n ç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ä¸ªé¢„çº¦ åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œåªæœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥ä¸‹å•æˆåŠŸ  ä½¿ç”¨åˆ°çš„åº“ kotlin  plugins { java id(\u0026#34;io.freefair.lombok\u0026#34;) version \u0026#34;6.0.0-m2\u0026#34; kotlin(\u0026#34;jvm\u0026#34;) version \u0026#34;1.5.0-RC\u0026#34; } group = \u0026#34;io.github.lexcao\u0026#34; version = \u0026#34;1.0-SNAPSHOT\u0026#34; repositories { mavenCentral() } dependencies { implementation(kotlin(\u0026#34;stdlib\u0026#34;)) // for Java mocking and assertion  testImplementation(\u0026#34;org.mockito:mockito-core:3.9.0\u0026#34;) testImplementation(\u0026#34;org.assertj:assertj-core:3.19.0\u0026#34;) // for Kotlin mocking and assertion  testImplementation(\u0026#34;io.mockk:mockk:1.11.0\u0026#34;) testImplementation(\u0026#34;io.kotest:kotest-assertions-core:4.4.3\u0026#34;) testImplementation(\u0026#34;org.junit.jupiter:junit-jupiter-api:5.6.0\u0026#34;) testRuntimeOnly(\u0026#34;org.junit.jupiter:junit-jupiter-engine\u0026#34;) } tasks { test { useJUnitPlatform() } }  ReservationService å‰ç½® æå‰åˆ›å»ºä»¥ä¸‹ç©ºæ–‡ä»¶ï¼Œé¿å…ä»£ç æ— æ³•è¿è¡Œ\n Reservation.java ReservationService.java ReservationRepository.java  Red - 01 - ç¼–å†™å•å…ƒæµ‹è¯• æ‰§è¡Œå•å…ƒæµ‹è¯•ï¼Œæ˜¾ç¤ºã€çº¢ç¯ã€‘ï¼Œä»£ç åˆ†æ”¯ï¼š\n kotlin-red-01 java-red-01  kotlin  @TestInstance(TestInstance.Lifecycle.PER_CLASS) internal class ReservationServiceImplTest { private val service: ReservationService = ReservationServiceImpl() @Nested inner class MakeReservation { private val time: LocalDateTime = LocalDateTime.of(2021, 5, 1, 21, 30) @Test fun shouldSuccess() { // given  val reservation = Reservation(name = \u0026#34;Tom\u0026#34;, time = time) // actual  val reserved: Reservation = service.makeReservation(reservation) // expect  reserved shouldBe reservation } } }   Green - 01 - ç¼–å†™å®ç° æ‰§è¡Œå•å…ƒæµ‹è¯•ï¼Œæ˜¾ç¤ºã€ç»¿ç¯ã€‘ï¼Œä»£ç åˆ†æ”¯ï¼š\n kotlin-green-01 java-green-01  kotlin  class ReservationServiceImpl : ReservationService { override fun makeReservation(reservation: Reservation): Reservation { return reservation } }   Red - 02 - åŠ å…¥åŠŸèƒ½ - å®Œå–„å•å…ƒæµ‹è¯• ï¼ˆæ³¨æ„ï¼šæŒä¹…åŒ–å±‚ç›®å‰ä¸éœ€è¦å…³å¿ƒï¼Œåœ¨è¿™é‡Œä½¿ç”¨ mock ç›¸å…³åŠŸèƒ½ï¼‰\nåŠ å…¥æŒä¹…åŒ–é€»è¾‘ï¼Œå®Œå–„ä»£ç ï¼Œæ˜¾ç¤ºã€çº¢ç¯ã€‘ï¼Œä»£ç åˆ†æ”¯ï¼š\n kotlin-red-02 java-red-02  kotlin  private val mockRepository: ReservationRepository = mockk() private val service: ReservationService = ReservationServiceImpl(mockRepository) @AfterEach fun clear() { clearAllMocks() } @Test fun shouldSuccess() { // given  every { mockRepository.save(any()) } returns reservation // verify  verifySequence { mockRepository.save(reservation) } // ... }  Green - 02 - ç¼–å†™å®ç° - å®Œå–„åŠŸèƒ½ ä»£ç åˆ†æ”¯ï¼š\n kotlin-green-02 java-green-02  kotlin  override fun makeReservation(reservation: Reservation): Reservation { return repository.save(reservation) }  Red - 03 - è¾¹ç•Œæµ‹è¯• å½“åŒä¸€æ—¶é—´å†…å·²æœ‰é¢„çº¦çš„æƒ…å†µä¸‹ï¼Œä»£ç åˆ†æ”¯ï¼š\n kotlin-red-03 java-red-03  kotlin  @Test fun shouldSuccess() { // given ...  every { mockRepository.findByTime(time) } returns null // verify ...  mockRepository.findByTime(time) } @Test fun shouldFailure() { // given  val reservation = Reservation(name = \u0026#34;Tom\u0026#34;, time = time) every { mockRepository.findByTime(time) } returns reservation // actual  shouldThrow\u0026lt;ReservationTimeNotAvailable\u0026gt; { service.makeReservation(reservation) } // verify  verifySequence { mockRepository.findByTime(time) mockRepository.save(reservation) wasNot Called } }  Green - 03 - å®Œå–„è¾¹ç•Œæ£€æŸ¥ kotlin  override fun makeReservation(reservation: Reservation): Reservation { val mayBeReserved = repository.findByTime(reservation.time) if (mayBeReserved != null) { throw ReservationTimeNotAvailable } return repository.save(reservation) }  Refactor - ç®€å•çš„å°é‡æ„ åˆ«å¿˜äº†ï¼Œé‡æ„å®Œä¹‹åï¼Œè¿è¡Œä¸€éå•å…ƒæµ‹è¯•ï¼Œã€ç»¿ç¯ã€‘ã€‚ä»£ç åˆ†æ”¯ï¼š\n kotlin-refactor  override fun makeReservation(reservation: Reservation): Reservation { repository.findByTime(reservation.time)?.run { throw ReservationTimeNotAvailable } return repository.save(reservation) } å°ç»“ ä¸€ä¸ªç®€å•çš„å°åŠŸèƒ½é€šè¿‡ TDD å¼€å‘æµç¨‹å°±æ­¤å¼€å‘å®Œæˆã€‚\nå®Œæ•´ä»£ç \nğŸ”— å‚è€ƒé“¾æ¥  æµ‹è¯•é©±åŠ¨å¼€å‘ Test Driven Development TDD é–‹ç™¼äº”æ­¥é©Ÿï¼Œå¸¶ä½ å¯¦æˆ° Test Driven Development ç¯„ä¾‹ è‡ªå‹•è»Ÿé«”æ¸¬è©¦-tdd-èˆ‡-bdd spring-boot-testing testing-web-layer  ","permalink":"https://lexcao.io/zh/posts/kotlin-java-tdd-example/","summary":"é€šè¿‡ä½¿ç”¨ Kotlin / Java ä¸­ Junit5 å’Œ Mockito æµ‹è¯•æ¡†æ¶ï¼Œåœ¨é¢„çº¦åŠŸèƒ½ä¸­æ¼”ç¤º TDD å¼€å‘æµç¨‹ã€‚\nTDD ä»‹ç» TDDï¼ˆTest-Driven Developmentï¼‰ æ˜¯ä¸€ç§å¼€å‘æµç¨‹ï¼Œä¸­æ–‡æ˜¯ã€Œæµ‹è¯•é©±åŠ¨å¼€å‘ã€ã€‚ç”¨ä¸€å¥ç™½è¯å½¢å®¹ï¼Œå°±æ˜¯ã€Œå…ˆå†™æµ‹è¯•å†å¼€å‘ã€ã€‚å…ˆå†™æµ‹è¯•é™¤äº†èƒ½ç¡®ä¿æµ‹è¯•ç¨‹å¼çš„æ’°å†™ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼šæœ‰åŠ©äºåœ¨å¼€å‘åˆæœŸå˜æ¸…ç¨‹å¼ä»‹é¢å¦‚ä½•è®¾è®¡ã€‚è¯¦ç»†ç†è®ºçŸ¥è¯†å¯ä»¥å‰å¾€ Wiki äº†è§£ï¼Œè¿™é‡Œä¸å†è¿‡å¤šä»‹ç»ã€‚\n æµ‹è¯•é©±åŠ¨å¼€å‘ Test Driven Development  TDD å¼€å‘æµç¨‹ï¼ˆ5æ­¥ï¼‰ æœ¯è¯­è¯´æ˜ï¼š\n çº¢ç¯ - Failure - æµ‹è¯•ç”¨ä¾‹å¤±è´¥ ç»¿ç¯ - Success - æµ‹è¯•ç”¨ä¾‹æˆåŠŸ é‡æ„ - Refactor - é‡æ„åŠŸèƒ½ä»£ç   å…·ä½“æ­¥éª¤ï¼š\n é€‰å®šä¸€ä¸ªåŠŸèƒ½ï¼Œç¼–å†™æµ‹è¯•ç”¨ä¾‹ æ‰§è¡Œæµ‹è¯•ï¼Œå¾—åˆ°ã€çº¢ç¯ã€‘ ç¼–å†™æ»¡è¶³æµ‹è¯•ç”¨ä¾‹çš„åŠŸèƒ½ä»£ç  å†æ¬¡æ‰§è¡Œï¼Œå¾—åˆ°ã€ç»¿ç¯ã€‘ ã€é‡æ„ã€‘ä»£ç   å°ç»“ï¼š\nå¯¹äºæ¯ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ã€çº¢ç¯ã€‘-ã€ç»¿ç¯ã€‘-ã€é‡æ„ã€‘é—´æ¥å›å¾ªç¯å¾€å¤ï¼Œä¸æ–­å¾—åˆ°å®Œå–„ã€‚\nå‰ç½®å·¥ä½œ ä»£ç è¯´æ˜  ä½¿ç”¨ Kotlin è¯­è¨€ï¼ˆä¼šæœ‰ç›¸å¯¹åº”çš„ Java ä»£ç ï¼‰ ä½¿ç”¨åˆ°çš„æµ‹è¯•æ¡†æ¶  Running: JUnit5 Mock: MockK / Mockito Assertion: Kotest / AssertJ   åªæ¶‰åŠ TDD çš„å…·ä½“æµç¨‹ï¼Œä¸æ¶‰åŠå•å…ƒæµ‹è¯•å¦‚ä½•ç¼–å†™ï¼ˆå¯ä»¥çœ‹ SpringBoot å•å…ƒæµ‹è¯•å„å±‚ï¼‰  åŠŸèƒ½ä»‹ç» å‡è®¾ä¸€ä¸ªç”¨æˆ·é¢„çº¦çš„åœºæ™¯ã€‚","title":"Kotlin/Java TDD å¼€å‘æµç¨‹è®°å½•"},{"content":"ç—›ç‚¹ é¡¹ç›®ä¸­ä½¿ç”¨ Spring Data JPA ä½œä¸º ORM æ¡†æ¶çš„æ—¶å€™ï¼Œå®ä½“æ˜ å°„éå¸¸æ–¹ä¾¿ã€‚Spring Data Repository çš„é¡¶å±‚æŠ½è±¡å®Œå…¨è§£å†³å•å®ä½“çš„æŸ¥è¯¢ï¼Œé¢å¯¹å•å®ä½“çš„å¤æ‚æŸ¥è¯¢ï¼Œä¹Ÿèƒ½ä½¿ç”¨ JpaSpecificationExecutor\u0026lt;T\u0026gt; æ„é€  Specification\u0026lt;T\u0026gt; è½»æ¾åº”å¯¹ã€‚\nè€Œå¯¹äºåå°ç®¡ç†æŠ¥è¡¨æŸ¥è¯¢éœ€æ±‚æ¥è¯´ï¼Œéœ€è¦è¿›è¡Œè¿è¡¨å¤šæ¡ä»¶åŠ¨æ€æŸ¥è¯¢çš„æ—¶å€™ï¼Œå°±æ˜¾å¾—æ— ä»ä¸‹æ‰‹ã€‚å› ä¸ºå®ƒå¹¶ä¸åƒ MyBatis ä¸€æ ·èƒ½å¤Ÿåœ¨ XML æ–‡ä»¶ä¸­å†™å‡ºåŠ¨æ€ SQL è¯­å¥ã€‚\nå°½ç®¡å¯ä»¥ä½¿ç”¨ EntityManager åŠ¨æ€æ‹¼æ¥åŸç”Ÿ SQL è¯­å¥ï¼Œä½†æ˜¯è¯¥æ–¹æ³•è¿”å›å€¼ä¸º ResultSet ï¼Œä¹Ÿå°±æ˜¯è¯´æŸ¥å‡ºæ¥çš„å®ä½“æ˜ å°„å…³ç³»éœ€è¦æ‰‹åŠ¨æ˜ å°„ï¼ˆğŸ˜¢è¿™æ ·ä¸å¤ªä¼˜é›…ï¼Œå·²ç»å®šä¹‰å‡ºå®ä½“ï¼Œè¿˜éœ€è¦è‡ªå·±å»æ˜ å°„ï¼‰ã€‚\næ‰€ä»¥ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯ï¼Œåœ¨ç°æœ‰å®ä½“å…³ç³»çš„åŸºç¡€ä¸Šï¼Œç»“åˆ Specification\u0026lt;T\u0026gt; è®°å½•ä¸‹ Spring Data JPA å¤šæ¡ä»¶åŠ¨æ€è¿è¡¨æŸ¥è¯¢æ“ä½œï¼Œä»¥åŠå…¶ä¸­çš„è¸©å‘å’Œä¼˜åŒ–ã€‚\nåŸºç¡€æ“ä½œ é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬å¼€å§‹è¿›å…¥ä»£ç æ“ä½œã€‚ã€æœ¬æ–‡æ‰€æœ‰ä»£ç åœ¨æ­¤ã€‘\nå‰ç½®è¯´æ˜ ç›¸å…³ä¾èµ–  Java 11 SpringBoot 2.4.2  build.gradle\nplugins { id \u0026#39;org.springframework.boot\u0026#39; version \u0026#39;2.4.2\u0026#39; id \u0026#39;io.spring.dependency-management\u0026#39; version \u0026#39;1.0.11.RELEASE\u0026#39; id \u0026#39;java\u0026#39; } dependencies { implementation \u0026#39;org.springframework.boot:spring-boot-starter-data-jpa\u0026#39; compileOnly \u0026#39;org.projectlombok:lombok\u0026#39; runtimeOnly \u0026#39;mysql:mysql-connector-java\u0026#39; annotationProcessor \u0026#39;org.projectlombok:lombok\u0026#39; testImplementation \u0026#39;org.springframework.boot:spring-boot-starter-test\u0026#39; testRuntimeOnly \u0026#39;com.h2database:h2\u0026#39; } maven.xml\n\u0026lt;build\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;excludes\u0026gt; \u0026lt;exclude\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;/exclude\u0026gt; \u0026lt;/excludes\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/plugins\u0026gt; \u0026lt;/build\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-jpa\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;scope\u0026gt;runtime\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;optional\u0026gt;true\u0026lt;/optional\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; æ¨¡æ‹Ÿåœºæ™¯ ä¸‰ä¸ªå®ä½“ï¼šä½œè€…ã€ä¹¦ã€ä¹¦è¯„ã€‚å…¶ä¸­ï¼Œä½œè€…ä¸ä¹¦æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä¹¦ä¸ä¹¦è¯„æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼ˆå½“ç„¶ä¹¦è¯„ä¸è¯»è€…çš„è¯„ä»·æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œè¿™é‡Œçœå»ï¼Œä»…ç”¨ä¸€å¯¹ä¸€æ¥è¿›è¡Œæ¼”ç¤ºå³å¯ï¼‰ã€‚\nå‡è®¾æœ‰è¿™æ ·çš„åå°æŸ¥è¯¢æ¡ä»¶ï¼šä½œè€…åç§°ã€ä¹¦çš„å‘å¸ƒæ—¶é—´ã€ä¹¦è¯„çš„è¯„åˆ†ã€‚ï¼ˆè¿™é‡Œæ¯ä¸ªå®ä½“å–ä¸€ä¸ªå­—æ®µè¿›è¡Œè¿è¡¨æŸ¥è¯¢æ¼”ç¤ºï¼Œå…¶ä»–å­—æ®µåŒç†ï¼‰ã€‚è¿”å›ä¹¦ç±åˆ—è¡¨ä»¥åŠç›¸å…³è¡¨å­—æ®µã€‚\nå®ä½“å…³ç³» è¡¨ç»“æ„ CREATE TABLE `author` ( `id` VARCHAR(255) PRIMARY KEY, `name` VARCHAR(255) ); CREATE TABLE `book` ( `id` VARCHAR(255) PRIMARY KEY, `publish_time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP, `author_id` VARCHAR(255), `review_id` VARCHAR(255) ); CREATE TABLE `review` ( `id` VARCHAR(255) PRIMARY KEY, `score` INT ); -- æ•°æ®åˆå§‹åŒ– INSERT INTO `author` (`id`, `name`) VALUES (\u0026#39;A_1\u0026#39;, \u0026#39;Author_1\u0026#39;), (\u0026#39;A_2\u0026#39;, \u0026#39;Author_2\u0026#39;), (\u0026#39;A_3\u0026#39;, \u0026#39;Author_3\u0026#39;), (\u0026#39;A_4\u0026#39;, \u0026#39;Author_4\u0026#39;), (\u0026#39;A_5\u0026#39;, \u0026#39;Author_5\u0026#39;); INSERT INTO `review` (`id`, `score`) VALUES (\u0026#39;R_1\u0026#39;, 20), (\u0026#39;R_2\u0026#39;, 30), (\u0026#39;R_3\u0026#39;, 40), (\u0026#39;R_4\u0026#39;, 50), (\u0026#39;R_5\u0026#39;, 60), (\u0026#39;R_6\u0026#39;, 70), (\u0026#39;R_7\u0026#39;, 80), (\u0026#39;R_8\u0026#39;, 90); INSERT INTO `book` (`id`, `author_id`, `review_id`) VALUES (\u0026#39;B_1\u0026#39;, \u0026#39;A_1\u0026#39;, \u0026#39;R_1\u0026#39;), (\u0026#39;B_2\u0026#39;, \u0026#39;A_2\u0026#39;, \u0026#39;R_2\u0026#39;), (\u0026#39;B_3\u0026#39;, \u0026#39;A_3\u0026#39;, \u0026#39;R_3\u0026#39;), (\u0026#39;B_4\u0026#39;, \u0026#39;A_4\u0026#39;, \u0026#39;R_4\u0026#39;), (\u0026#39;B_5\u0026#39;, \u0026#39;A_5\u0026#39;, \u0026#39;R_5\u0026#39;), (\u0026#39;B_6\u0026#39;, \u0026#39;A_2\u0026#39;, \u0026#39;R_6\u0026#39;), (\u0026#39;B_7\u0026#39;, \u0026#39;A_2\u0026#39;, \u0026#39;R_7\u0026#39;), (\u0026#39;B_8\u0026#39;, \u0026#39;A_3\u0026#39;, \u0026#39;R_8\u0026#39;); JPA å®ä½“å…³ç³» ä½¿ç”¨ Java persistence API æ„å»ºå¦‚ä¸‹å®ä½“å…³ç³»ï¼Œå…¶ä»–ä¸šåŠ¡å­—æ®µçœç•¥ã€‚\n@Data @Table @Entity public class Author { @Id private String id; private String name; } @Data @Table @Entity public class Book { @Id private String id; @Column(name = \u0026#34;publish_time\u0026#34;) private LocalDateTime publishTime; @ManyToOne(fetch = FetchType.LAZY) @JoinColumn(name = \u0026#34;author_id\u0026#34;, foreignKey = @ForeignKey(ConstraintMode.NO_CONSTRAINT)) private Author author; @OneToOne(fetch = FetchType.LAZY) @JoinColumn(name = \u0026#34;review_id\u0026#34;, foreignKey = @ForeignKey(ConstraintMode.NO_CONSTRAINT)) private Review review; } @Data @Table @Entity public class Review { @Id private String id; } ç›¸å…³è§£é‡Šï¼š\n @Data Lombok æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆ getterã€setterã€hashcodeã€equals @Table @Entity @Id @Column @JoinColumn å‡ä¸º persistence API @ManyToOne å®ä½“æ˜ å°„å…³ç³» å¤šå¯¹ä¸€ @OneToOne å®ä½“æ˜ å°„å…³ç³» ä¸€å¯¹ä¸€  åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œè¿è¡¨çš„æ—¶å€™ä¸ä¸€å®šæ˜¯æŸ¥è¯¢å¤šä¸ªå®ä½“çš„å…¨éƒ¨å­—æ®µï¼Œä¸ºäº†ä¸å½±å“åŸæœ‰å®ä½“å…³ç³»çš„æ­£å¸¸æ˜ å°„ï¼Œè¿™é‡Œå•ç‹¬å£°æ˜ä¸€ä¸ªç±» BookJoin æ¥æ˜ å°„æŸ¥è¯¢æ¡ä»¶è¿”å›ã€‚ä¼˜é›…çš„å®ç° Spring Data JPA è¿è¡¨æ“ä½œï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š\n åªæœ‰ SELECT æŸ¥è¯¢å‡ºæ¥çš„å­—æ®µï¼Œæ‰éœ€è¦åœ¨å®ä½“é‡Œé¢å£°æ˜å‡ºæ¥ JOIN ON åé¢çš„æ¡ä»¶ï¼Œéœ€è¦åœ¨å®ä½“é‡Œé¢å£°æ˜å‡ºæ¥ å†æ ¹æ® Specification ä¸­çš„ query.join æ¥è¿›è¡Œ JOIN  ä»¥ä¸‹æ˜¯è¿è¡¨å®ä½“ BookJoin.java æ–‡ä»¶\n@Data @Entity @Table(name = \u0026#34;book\u0026#34;) public class BookJoin { @Id private String id; @Column(name = \u0026#34;publish_time\u0026#34;) private LocalDateTime publishTime; @ManyToOne @JoinColumn(name = \u0026#34;author_id\u0026#34;, foreignKey = @ForeignKey(ConstraintMode.NO_CONSTRAINT)) private Author author; @OneToOne @JoinColumn(name = \u0026#34;review_id\u0026#34;, foreignKey = @ForeignKey(ConstraintMode.NO_CONSTRAINT)) private Review review; @Data @Entity @Table(name = \u0026#34;author\u0026#34;) public static class Author { @Id private String id; private String name; } @Data @Entity @Table(name = \u0026#34;review\u0026#34;) public static class Review { @Id private String id; private Integer score; } } æ„å»ºæµ‹è¯•ç¯å¢ƒ ä¸ºäº†æ¼”ç¤ºå¤šæ¡ä»¶æŸ¥è¯¢ç»“æœï¼Œè¿™é‡Œä½¿ç”¨ JUnit æ¥è¿›è¡Œå•å…ƒæµ‹è¯•\n SpringBoot x JUnit å•å…ƒæµ‹è¯•æ›´è¯¦ç»†çš„å†…å®¹ï¼Œè¯·çœ‹å¦ä¸€ç¯‡åšå®¢\n /** * given: * empty query * then: * paged data */ @Test void multiQuery() { var spec = BookJoinSpec.multiQuery(emptyQuery()); var page = PageRequest.of(0, 5); queryBySpecMethod(spec, page); } private Page\u0026lt;BookJoin\u0026gt; queryBySpecMethod(Specification\u0026lt;BookJoin\u0026gt; spec, PageRequest pageRequest) { var books = repo.findAll(spec, pageRequest); assertThat(books.getNumberOfElements()).isGreaterThan(0); books.getContent().forEach(it -\u0026gt; { assertThat(it).isNotNull(); // è®¿é—®ç»“æœé›†çš„å±æ€§ï¼ŒéªŒè¯æ˜¯å¦æ‡’åŠ è½½  assertThat(it.getAuthor().getName()).isNotNull(); assertThat(it.getReview().getScore()).isNotNull(); } ); return books; } è¿è¡¨æ“ä½œ å¦‚ä½•è¿›è¡Œå£°æ˜å¼è¿è¡¨æŸ¥è¯¢ï¼Œè¿™é‡Œè®²æ¼”ç¤ºå„ç§å†™æ³•çš„ä¸åŒï¼Œ ä»¥åŠå„ä¸ªå‚æ•°æ‰€èµ·çš„ä½œç”¨ï¼Œæœ€åä¼šç»™å‡ºä¸€ä¸ªæœ€ç»ˆç‰ˆæœ¬ä½œä¸ºæœ€ä½³å®è·µå‚è€ƒã€‚\n01 ç‰ˆæœ¬ static Specification\u0026lt;BookJoin\u0026gt; multiQuery_01(BookJoinQuery param) { return (root, query, cb) -\u0026gt; { var predicates = new LinkedList\u0026lt;Predicate\u0026gt;(); root.join(\u0026#34;author\u0026#34;); root.join(\u0026#34;review\u0026#34;); // ...  }; } é€šè¿‡ä»¥ä¸Šçš„å•å…ƒæµ‹è¯•ï¼Œæ‰“å°å‡ºçš„ SQL å¦‚ä¸‹\nHibernate: SELECT `bookjoin0_`.`id` AS `id1_1_`, `bookjoin0_`.`author_id` AS `author_i3_1_`, `bookjoin0_`.`publish_time` AS `publish_2_1_`, `bookjoin0_`.`review_id` AS `review_i4_1_` FROM `book` `bookjoin0_` INNER JOIN `author` `bookjoin_a1_` ON `bookjoin0_`.`author_id` = `bookjoin_a1_`.`id` INNER JOIN `review` `bookjoin_r2_` ON `bookjoin0_`.`review_id` = `bookjoin_r2_`.`id` WHERE 1 = 1 LIMIT ? OFFSET ? Hibernate: SELECT `bookjoin_a0_`.`id` AS `id1_0_0_`, `bookjoin_a0_`.`name` AS `name2_0_0_` FROM `author` `bookjoin_a0_` WHERE `bookjoin_a0_`.`id` = ? Hibernate: SELECT `bookjoin_r0_`.`id` AS `id1_2_0_`, `bookjoin_r0_`.`score` AS `score2_2_0_` FROM `review` `bookjoin_r0_` WHERE `bookjoin_r0_`.`id` = ? Hibernate: SELECT `bookjoin_r0_`.`id` AS `id1_2_0_`, `bookjoin_r0_`.`score` AS `score2_2_0_` FROM `review` `bookjoin_r0_` WHERE `bookjoin_r0_`.`id` = ? Hibernate: SELECT `bookjoin_a0_`.`id` AS `id1_0_0_`, `bookjoin_a0_`.`name` AS `name2_0_0_` FROM `author` `bookjoin_a0_` WHERE `bookjoin_a0_`.`id` = ? Hibernate: SELECT `bookjoin_r0_`.`id` AS `id1_2_0_`, `bookjoin_r0_`.`score` AS `score2_2_0_` FROM `review` `bookjoin_r0_` WHERE `bookjoin_r0_`.`id` = ? å¯ä»¥çœ‹åˆ°ï¼š\n æ•°æ®æ€»å…±æŸ¥å‡ºæ¥ 3 æ¡ï¼Œç»“æœæ‰§è¡Œçš„ SQL è¯­å¥æœ‰ 7 æ¡ åˆ†åˆ«æ˜¯ï¼š1 æ¡è¿è¡¨æŸ¥è¯¢ï¼Œ3 æ¡ author è¡¨çš„å•æŸ¥è¯¢ï¼Œ3 æ¡ review è¡¨çš„å•æŸ¥è¯¢  02 ç‰ˆæœ¬ - ä½¿ç”¨ fetch ä¼˜åŒ– ä½¿ç”¨ fetch æ›¿ä»£ join\n join ä»…è¿è¡¨æŸ¥è¯¢ï¼Œè¿”å›çš„ä¸»å®ä½“çš„æ‰€æœ‰å±æ€§ï¼Œå¯ä»¥ç†è§£ä¸º SELECT book.* fetch è¿è¡¨æŸ¥è¯¢ + å¿«åŠ è½½ï¼Œè¿”å›è¿è¡¨æ‰€æœ‰å®ä½“çš„å±æ€§ï¼Œå¯ä»¥ç†è§£ä¸º SELECT *  static Specification\u0026lt;BookJoin\u0026gt; multiQuery_02(BookJoinQuery param) { return (root, query, cb) -\u0026gt; { // ...  root.fetch(\u0026#34;author\u0026#34;); root.fetch(\u0026#34;review\u0026#34;); // ...  }; } é€šè¿‡ä»¥ä¸Šçš„å•å…ƒæµ‹è¯•ï¼Œæ‰“å°å‡ºçš„ SQL å¦‚ä¸‹\nHibernate: SELECT `bookjoin0_`.`id` AS `id1_1_0_`, `bookjoin_a1_`.`id` AS `id1_0_1_`, `bookjoin_r2_`.`id` AS `id1_2_2_`, `bookjoin0_`.`author_id` AS `author_i3_1_0_`, `bookjoin0_`.`publish_time` AS `publish_2_1_0_`, `bookjoin0_`.`review_id` AS `review_i4_1_0_`, `bookjoin_a1_`.`name` AS `name2_0_1_`, `bookjoin_r2_`.`score` AS `score2_2_2_` FROM `book` `bookjoin0_` INNER JOIN `author` `bookjoin_a1_` ON `bookjoin0_`.`author_id` = `bookjoin_a1_`.`id` INNER JOIN `review` `bookjoin_r2_` ON `bookjoin0_`.`review_id` = `bookjoin_r2_`.`id` WHERE 1 = 1 LIMIT ? OFFSET ? å¯ä»¥çœ‹åˆ°ï¼š\n æ‰§è¡Œçš„ SQL åªæœ‰ 1 æ¡ SELECT ä¸­çš„å­—æ®µåŒ…æ‹¬è¿è¡¨çš„å­—æ®µ  è¸©å‘ - åˆ†é¡µé—®é¢˜ åˆ›å»ºä¸€ä¸ªæ–°çš„å•å…ƒæµ‹è¯•ï¼Œç›´æ¥ä½¿ç”¨ fetch åˆ†é¡µæŠ¥é”™\n@Test void multiQuery_02() { var spec = BookJoinSpec.multiQuery_02(emptyQuery()); var page = PageRequest.of(0, 5); assertThatThrownBy(() -\u0026gt; queryBySpecMethod(spec, page)) .hasCauseInstanceOf(QueryException.class); } å½“ä½¿ç”¨ fetch å†è¿›è¡Œåˆ†é¡µçš„æ—¶å€™ï¼Œä¼šæŠ¥ä»¥ä¸‹é”™è¯¯\nCaused by: org.hibernate.QueryException: query specified join fetching, but the owner of the fetched association was not present in the select list. åŸå› åˆ†æï¼š\n å®é™…æŠ¥é”™å‡ºç°åœ¨ count è¯­å¥ï¼Œé”™è¯¯ä¿¡æ¯è¡¨ç¤ºè¯¥ count è¯­å¥è¿”å›å€¼æ²¡æœ‰æ‰¾åˆ°å…·ä½“çš„æ˜ å°„å±æ€§  è§£å†³æ–¹æ³•ï¼š\n é’ˆå¯¹åˆ†é¡µçš„ count æŸ¥è¯¢è¯­å¥å•ç‹¬åšå¤„ç†ï¼Œä»£ç å¦‚ä¸‹  static Specification\u0026lt;BookJoin\u0026gt; multiQuery_02_fix(BookJoinQuery param) { return (root, query, cb) -\u0026gt; { // ...  if (Long.class.equals(query.getResultType()) || long.class.equals(query.getResultType())) { root.join(\u0026#34;author\u0026#34;); root.join(\u0026#34;review\u0026#34;); } else { root.fetch(\u0026#34;author\u0026#34;); root.fetch(\u0026#34;review\u0026#34;); } // ...  }; } æ³¨æ„ å¯èƒ½ç–‘é—®ã€Œä¸Šé¢ BookJoin å®ä½“é‡Œé¢å£°æ˜å…³ç³»ä¸æ˜¯ fetch = FetchType.LAZY ï¼Œæ²¡æœ‰æŒ‡æ˜æ˜¯æ‡’åŠ è½½ï¼Œä¸ºä»€ä¹ˆè¿è¡¨æŸ¥è¯¢çš„æ—¶å€™è¿˜æ˜¯æ²¡æœ‰åŠ è½½å‡ºæ¥ã€ã€‚\nåŸå› æ˜¯ JPA é‡Œé¢ join æœºåˆ¶å¤„ç†ï¼ŒåŸç†å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š\n æ ¹æ® join å’Œ fetch ç”Ÿæˆä¸åŒçš„ JpaQL è¯­å¥ï¼Œå·®åˆ«åœ¨äº join ä¸ join fetch  -- fetch ç”Ÿæˆçš„ JpaQL è¯­å¥ select generatedAlias0 from BookJoin as generatedAlias0 inner join fetch generatedAlias0.author as generatedAlias1 inner join fetch generatedAlias0.review as generatedAlias2 where 1=1 -- join ç”Ÿæˆçš„ JpaQL è¯­å¥ select generatedAlias0 from BookJoin as generatedAlias0 inner join generatedAlias0.author as generatedAlias1 inner join generatedAlias0.review as generatedAlias2 where 1=1 JpaQL è¯­å¥æ ¹æ® join fetch è½¬æ¢ä¸º HQL å†è½¬æ¢ä¸ºæœ€ç»ˆçš„ SQL è¯­å¥ï¼Œé€šè¿‡ QueryTranslatorImpl ç±»ï¼Œåœ¨ doCompile æ–¹æ³•çœ‹åˆ°å®Œæ•´è½¬æ¢è¿‡ç¨‹ï¼Œéƒ¨åˆ†ä»£ç å¦‚ä¸‹  // QueryTranslatorImpl // doCompile -\u0026gt; analyze -\u0026gt; HqlSqlBaseWalker.statement -\u0026gt; selectStatement // selectClause -\u0026gt; fromClause -\u0026gt; fromElementList -\u0026gt; fromElement -\u0026gt; joinElement  // HqlSqlWalker.java createFromJoinElement #367 // DotNode æ­¤å¤„è®¾ç½® fetch DotNode dot = (DotNode) path; JoinType hibernateJoinType = JoinProcessor.toHibernateJoinType( joinType ); dot.setJoinType( hibernateJoinType ); // Tell the dot node about the join type. dot.setFetch( fetch ); // Generate an explicit join for the root dot node. The implied joins will be collected and passed up // to the root dot node. dot.resolve( true, false, alias == null ? null : alias.getText() ); // è§£æé˜¶æ®µ // selectStatement -\u0026gt; query -\u0026gt; processQuery // ä¸Šé¢çš„æŠ¥é”™åœ¨æ­¤å¤„ SelectClause.java #212 if ( !fromElementsForLoad.contains( origin ) \u0026amp;\u0026amp; !fromElementsForLoad.contains( fromElement.getFetchOrigin() ) ) throw new QueryException( \u0026#34;query specified join fetching, but the owner \u0026#34; + \u0026#34;of the fetched association was not present in the select list \u0026#34; + \u0026#34;[\u0026#34; + fromElement.getDisplayText() + \u0026#34;]\u0026#34; ); } 03 ç‰ˆæœ¬ - åŠ ä¸Šæ¡ä»¶ç­›é€‰ åˆ›å»ºä¸€ä¸ªæ–°çš„å•å…ƒæµ‹è¯•ï¼Œç­›é€‰ä¸€ä¸‹ Join æ¡ä»¶\n@Test void multiQuery_03() { var query = BookJoinQuery.builder() .authorName(\u0026#34;Author_2\u0026#34;) .build(); var spec = BookJoinSpec.multiQuery_03(query); var page = PageRequest.of(0, 5); var result = queryBySpecMethod(spec, page); var givenAuthor = result.getContent().get(0).getAuthor(); assertThat(givenAuthor.getName()).isEqualTo(\u0026#34;Author_2\u0026#34;); } å…·ä½“çš„è¿è¡¨æŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹\nstatic Specification\u0026lt;BookJoin\u0026gt; multiQuery_03(BookJoinQuery param) { return (root, query, cb) -\u0026gt; { var predicates = new LinkedList\u0026lt;Predicate\u0026gt;(); if (Long.class.equals(query.getResultType()) || long.class.equals(query.getResultType())) { root.join(\u0026#34;author\u0026#34;); root.join(\u0026#34;review\u0026#34;); } else { root.fetch(\u0026#34;author\u0026#34;); root.fetch(\u0026#34;review\u0026#34;); } if (null != param.getBookPublishTime()) { predicates.add(cb.equal(root.get(\u0026#34;publishTime\u0026#34;), param.getBookPublishTime())); } if (null != param.getAuthorName()) { predicates.add(cb.equal(root.get(\u0026#34;author\u0026#34;).get(\u0026#34;name\u0026#34;), param.getAuthorName())); } if (null != param.getReviewScore()) { predicates.add(cb.equal(root.get(\u0026#34;review\u0026#34;).get(\u0026#34;score\u0026#34;), param.getReviewScore())); } query.where(predicates.toArray(new Predicate[0])); return query.getRestriction(); }; } æ€»ç»“è¿è¡¨æ“ä½œ  éœ€è¦ SELECT æŸ¥è¯¢å‡ºæ¥çš„å­—æ®µï¼Œé€šè¿‡å•ç‹¬çš„ç±» BookJoin æ˜ å°„å‡ºæ¥ ä½¿ç”¨ fetch ç›´æ¥åŠ è½½è¿è¡¨ä¸­çš„å…¶ä»–å­—æ®µï¼Œæ­¤å¤„æ³¨æ„åˆ†é¡µè¿˜éœ€è¦ä½¿ç”¨ join å¯¹äºè¿è¡¨å­—æ®µç­›é€‰ï¼Œä½¿ç”¨ root.get(\u0026quot;author\u0026quot;).get(\u0026quot;name\u0026quot;) å³å¯  æ³¨æ„ ä¸Šé¢ä½¿ç”¨çš„ç¤ºä¾‹æ˜¯é’ˆå¯¹ã€å¼ºä¸€å¯¹ä¸€å…³ç³»ã€‘æ‰€ä»¥ä½¿ç”¨é»˜è®¤çš„è¿æ¥ç±»å‹ INNER JOIN\nå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å·¦å¤–è¿æ¥ï¼ˆå³å¤–è¿æ¥ä¸æ”¯æŒï¼‰\nroot.join(\u0026#34;author\u0026#34;, JoinType.LEFT); root.fetch(\u0026#34;author\u0026#34;, JoinType.LEFT); æ‰©å±•é˜…è¯»  Advanced Spring Data JPA - Specifications and Querydsl REST Query Language with Spring Data JPA Specifications Spring Data JPA Specification DSL for Kotlin  ğŸ”— é“¾æ¥  Github source Spring Data JPAä½¿ç”¨Specification  ğŸ‘€æ€»ç»“  ä½¿ç”¨ SpringJPA æ¥å†™åŠ¨æ€å¤šæ¡ä»¶è¿è¡¨æŸ¥è¯¢ï¼Œé€šè¿‡ä»£ç æ¥æ§åˆ¶ SQL è¯­å¥ï¼Œéœ€è¦å¯¹ JPA ä»¥åŠ Hibernate ç›¸å…³ API ç›¸å¯¹ç†Ÿç»ƒæ‰å¯ä»¥å†™å‡ºä¼˜è´¨çš„ SQL è¯­å¥ç”Ÿæˆã€‚ å’Œ MyBatis å¯ä»¥ç›´æ¥æ‹¼æ¥ SQL çš„ç›¸æ¯”ï¼Œå„æœ‰åº”ç”¨åœºæ™¯ã€‚ æ•´ä½“æ¥è¯´ç”¨ä»£ç æ¥å†™ JPA çš„åŠ¨æ€æŸ¥è¯¢ï¼Œå¯¹äºä¹ æƒ¯ SQL è¯­å¥çš„äººæ¥è¯´ï¼Œè¿˜æ˜¯æ„Ÿè§‰éš”äº†ä¸€å±‚ã€‚ å¯¹äºè¿™æ ·çš„åˆ†é¡µè¿è¡¨æŸ¥è¯¢ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯ MyBatis èˆ’æœä¸€ç‚¹ï¼Œç®€å•ã€‚  ","permalink":"https://lexcao.io/zh/posts/spring-data-jpa-join-table/","summary":"ç—›ç‚¹ é¡¹ç›®ä¸­ä½¿ç”¨ Spring Data JPA ä½œä¸º ORM æ¡†æ¶çš„æ—¶å€™ï¼Œå®ä½“æ˜ å°„éå¸¸æ–¹ä¾¿ã€‚Spring Data Repository çš„é¡¶å±‚æŠ½è±¡å®Œå…¨è§£å†³å•å®ä½“çš„æŸ¥è¯¢ï¼Œé¢å¯¹å•å®ä½“çš„å¤æ‚æŸ¥è¯¢ï¼Œä¹Ÿèƒ½ä½¿ç”¨ JpaSpecificationExecutor\u0026lt;T\u0026gt; æ„é€  Specification\u0026lt;T\u0026gt; è½»æ¾åº”å¯¹ã€‚\nè€Œå¯¹äºåå°ç®¡ç†æŠ¥è¡¨æŸ¥è¯¢éœ€æ±‚æ¥è¯´ï¼Œéœ€è¦è¿›è¡Œè¿è¡¨å¤šæ¡ä»¶åŠ¨æ€æŸ¥è¯¢çš„æ—¶å€™ï¼Œå°±æ˜¾å¾—æ— ä»ä¸‹æ‰‹ã€‚å› ä¸ºå®ƒå¹¶ä¸åƒ MyBatis ä¸€æ ·èƒ½å¤Ÿåœ¨ XML æ–‡ä»¶ä¸­å†™å‡ºåŠ¨æ€ SQL è¯­å¥ã€‚\nå°½ç®¡å¯ä»¥ä½¿ç”¨ EntityManager åŠ¨æ€æ‹¼æ¥åŸç”Ÿ SQL è¯­å¥ï¼Œä½†æ˜¯è¯¥æ–¹æ³•è¿”å›å€¼ä¸º ResultSet ï¼Œä¹Ÿå°±æ˜¯è¯´æŸ¥å‡ºæ¥çš„å®ä½“æ˜ å°„å…³ç³»éœ€è¦æ‰‹åŠ¨æ˜ å°„ï¼ˆğŸ˜¢è¿™æ ·ä¸å¤ªä¼˜é›…ï¼Œå·²ç»å®šä¹‰å‡ºå®ä½“ï¼Œè¿˜éœ€è¦è‡ªå·±å»æ˜ å°„ï¼‰ã€‚\næ‰€ä»¥ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯ï¼Œåœ¨ç°æœ‰å®ä½“å…³ç³»çš„åŸºç¡€ä¸Šï¼Œç»“åˆ Specification\u0026lt;T\u0026gt; è®°å½•ä¸‹ Spring Data JPA å¤šæ¡ä»¶åŠ¨æ€è¿è¡¨æŸ¥è¯¢æ“ä½œï¼Œä»¥åŠå…¶ä¸­çš„è¸©å‘å’Œä¼˜åŒ–ã€‚\nåŸºç¡€æ“ä½œ é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬å¼€å§‹è¿›å…¥ä»£ç æ“ä½œã€‚ã€æœ¬æ–‡æ‰€æœ‰ä»£ç åœ¨æ­¤ã€‘\nå‰ç½®è¯´æ˜ ç›¸å…³ä¾èµ–  Java 11 SpringBoot 2.4.2  build.gradle\nplugins { id \u0026#39;org.springframework.boot\u0026#39; version \u0026#39;2.4.2\u0026#39; id \u0026#39;io.spring.dependency-management\u0026#39; version \u0026#39;1.0.11.RELEASE\u0026#39; id \u0026#39;java\u0026#39; } dependencies { implementation \u0026#39;org.springframework.boot:spring-boot-starter-data-jpa\u0026#39; compileOnly \u0026#39;org.projectlombok:lombok\u0026#39; runtimeOnly \u0026#39;mysql:mysql-connector-java\u0026#39; annotationProcessor \u0026#39;org.projectlombok:lombok\u0026#39; testImplementation \u0026#39;org.","title":"Spring Data JPA å¤šæ¡ä»¶åŠ¨æ€è¿è¡¨æŸ¥è¯¢"},{"content":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚\näº‹ç”± ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚\nè¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š\n// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾ enum class MyState { OK, CANCELED } // æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState fun processing(): MyState? { // å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€  return MyState.CANCELED } // åœ¨å¤„ç†çŠ¶æ€æ—¶ fun handleState() { // æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State?  val state = processing() if (state == CANCELED) { // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ  println(\u0026#34;Handle \u0026lt;CANCELED\u0026gt; state\u0026#34;) } } å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚\nimport javax.print.attribute.standard.JobState.CANCELED // æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹ // public static final JobState CANCELED = new JobState (7); è§£å†³æ–¹æ³•ï¼š\n// åˆ é™¤ä¸Šé¢çš„é™æ€å¼•åŒ…ï¼Œæ¢æˆæˆ‘ä»¬çš„ MyState if (state == MyState.CANCELED) { ... } ğŸ‘æ‹æ‹æ‰‹ï¼Œè¿™ä¸ª BUG æ”¹èµ·æ¥çœŸå®¹æ˜“ã€‚åˆå¯ä»¥æ„‰å¿«åœ°æ‘¸é±¼äº†å‘¢ã€‚\nğŸ˜ ç­‰ç­‰ï¼Œä½œä¸ºé™æ€è¯­è¨€é¢å¯¹å¦‚æ­¤è¯¡å¼‚åœ°ç±»å‹ä¸åŒ¹é…ä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Ÿ\nğŸ¤”æ€è€ƒ â“é—®é¢˜ç‚¹ï¼š\n ğŸ¤ Kotlin æšä¸¾ç±»å¯¹æ¯” Java çš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œç›´è§‰ä¸Šæ„Ÿè§‰ç±»å‹ä¸åŒ¹é…çš„æƒ…å†µï¼Œä¸ºä»€ä¹ˆèƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Ÿ  â“â“â“å¤´ä¸Šçš„é—®å·å˜å¤šäº†ï¼š\n Kotlin ä¸­å…¶ä»–ç±»å‹ä¼šå‡ºç°è¿™ç§ç±»ä¼¼çš„æƒ…å†µå—ï¼Ÿ Kotlin ç¼–è¯‘å™¨å…·ä½“æ€ä¹ˆå¤„ç†æšä¸¾ç±»å‹çš„ï¼Ÿ Java ä¼šå‡ºç°è¿™ç§æƒ…å†µå—ï¼Ÿï¼ˆåº”è¯¥ä¸ä¼šï¼‰  åœ¨ Stack Overflow å’Œ YouTrack æœäº†ä¸€åœˆï¼Œæ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚å¯èƒ½æ˜¯æœç´¢å…³é”®å­—ä¸å¯¹ğŸ˜¢ã€‚\nä¸ºäº†æ¢ä¸ªç©¶ç«Ÿï¼Œé€šè¿‡ä»¥ä¸‹å®éªŒç ”ç©¶ Kotlin ç¼–è¯‘å™¨ç±»å‹ä¸åŒ¹é…è¡Œä¸ºã€‚\nã€Œç‚¹å‡»è·³è½¬åˆ°ç»“æœéƒ¨åˆ†ã€\nğŸ”¬å®éªŒ ç¬¬ä¸€æ­¥ å®éªŒé¢„æœŸ å…ˆçœ‹ä¸‹å„è‡ªçš„ç›¸ç­‰ï¼ˆequalityï¼‰è¯­æ³•è¯´æ˜ï¼š\nJava ä¸­ï¼Œ\n == æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å†…å­˜åœ°å€ã€‚å†…å­˜åœ°å€ç›¸åŒçš„å‰ææ˜¯ä¸¤ä¸ªå¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ç§ç±»å‹ï¼› equals() æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ã€‚  Kotlin ä¸­ï¼Œ\n In Kotlin there are two types of equality: Structural equality (a check for equals()).\n a == b =\u0026gt; a?.equals(b) ?: (b === null)  Referential equality (two references point to the same object);\n a === b =\u0026gt; a and b point to the same object  \u0026mdash; kotlin equality\nä»¥ä¸‹æ˜¯ç®€å•ç¿»è¯‘ï¼š\nKotlin ä¸­æœ‰ä¸¤ç§ç±»å‹çš„ç›¸ç­‰ï¼š\nç»“æ„ç›¸ç­‰ï¼ˆå¯¹ equals() çš„æ£€æŸ¥ï¼‰\n a == b =\u0026gt; a?.equals(b) ?: (b === null)  å¼•ç”¨ç›¸ç­‰ï¼ˆä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡ï¼‰\n a === b =\u0026gt; a å’Œ b æŒ‡å‘åŒä¸€å¯¹åƒ   ç®€å•æ¥è¯´ï¼Œ\n Java ä¸­çš„ == å¯¹åº” Kotlin ===ï¼› Kotlin ä¸­çš„ == åŒ…å« Java equals å’Œ ==ã€‚  å…ˆè®¾ç½®ä¸€ä¸ªé¢„æœŸï¼š\nJava ä¸­çš„ç›¸ç­‰ï¼Œ\n equals() æˆåŠŸé€šè¿‡ç¼–è¯‘ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œï¼›  æ–¹æ³•å…¥å‚æ˜¯ Objectï¼Œä¸åŒç±»å‹ç›¸æ¯”ä¸ä¼šæŠ¥é”™ã€‚   == ä¸èƒ½ç¼–è¯‘ï¼›  å¼•ç”¨ç›¸åŒå‰æéœ€è¦å¯¹è±¡ç›¸åŒã€‚    Kotlin ä¸­çš„ç›¸ç­‰ï¼Œ\n === ä¸èƒ½ç¼–è¯‘ï¼›  ä¸ Java çš„ == è¡Œä¸ºä¸€è‡´ï¼Œå¼•ç”¨ç›¸åŒå‰æéœ€è¦å¯¹è±¡ç›¸åŒã€‚   == ä¸èƒ½ç¼–è¯‘ï¼›  a?.equals(b) ?: (b === null) è¿™é‡Œ equals å…¥å‚æ˜¯ Any? èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯åé¢ä¼šå¯¹æ¯”å¯¹è±¡å¼•ç”¨ï¼Œå‡­ç›´è§‰æ¥çœ‹ï¼Œæœ‰å¯¹æ¯”å¼•ç”¨çš„è¯ï¼Œå¦‚æœç±»å‹ä¸ä¸€è‡´ï¼Œä¸èƒ½ç¼–è¯‘ã€‚    ç¬¬äºŒæ­¥ æ”¶é›†å˜é‡ é€šè¿‡ä¸Šé¢å¤ç°å‡ºçš„é—®é¢˜æ¢³ç†å‡ºä»¥ä¸‹å˜é‡ï¼š\n   variable values     æ¡ä»¶åˆ¤æ–­è¯­å¥ Kotlin: if / when | Java: if / switch   è¡¨è¾¾å¼å¯¹è±¡ Kotlin: class / enum class / object Java: class / enum / static field   è¡¨è¾¾å¼å£°æ˜ K - K / J - J / J - K    ç¬¬ä¸‰æ­¥ åˆæ­¥ç­›é€‰ å¯¹äºæ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œ\n Kotlin çš„ if å’Œ when çš„è¡Œä¸ºä¸€è‡´ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åªä½¿ç”¨ ifï¼› Java ä¸­ switch ä»…æ”¯æŒ enum / String / primitive ï¼Œå†åŠ ä¸Šå¯¹äº enum æœ‰ä¸¥æ ¼ç±»å‹æ ¡éªŒï¼ˆè¯­æ³•å±‚é¢ï¼Œå½“ switch(enum) case è¯­å¥å°±å¤„äºè¯¥ enum çš„ä¸Šä¸‹æ–‡ï¼Œåªèƒ½ä½¿ç”¨è¯¥ enum ä¸­å®šä¹‰çš„å€¼ã€‚ä¸è€ƒè™‘ï¼ŒåŒæ ·åªä½¿ç”¨ ifã€‚  if (condition) {} å¯¹äºç›¸ç­‰åˆ¤æ–­ï¼Œ\n Java ä½¿ç”¨ == å’Œ equals()ï¼› Kotlin ä»…ä½¿ç”¨ == ï¼ˆ=== è¡Œä¸ºä¸ Java ä¸­ == ä¸€è‡´ï¼Œæ•…çœç•¥ï¼‰ã€‚  å¯¹äºè¡¨è¾¾å¼å¯¹è±¡ï¼Œæ¯ä¸ªå®éªŒå¯¹è±¡å®šä¹‰ a / b ï¼Œb ç”¨äºåŒç±»å‹æ—¶å¤‡ç”¨ã€‚\n   è¡¨è¾¾å¼å¯¹è±¡ Java Kotlin     class MyJavaClassA / MyJavaClassB MyKotlinClassA / MyKotlinClassB   enum RetentionPolicy / ElementType AnnotationRetention / AnnotationTarget   object / static JobState / JobStateReason MyKotlinObjectA / MyKotlinObjectB    public class MyJavaClassA {} // MyJavaClassA.java public class MyJavaClassB {} // MyJavaClassB.java class MyKotlinClassA // MyKotlinClassA.kt class MyKotlinClassB // MyKotlinClassB.kt object MyKotlinObject // MyKotlinObjectA object MyKotlinObject // MyKotlinObjectB // RetentionPolicy : java.lang.annotation.RetentionPolicy // ElementType : java.lang.annotation.ElementType // AnnotationRetention : kotlin.annotation.AnnotationRetention // AnnotationTarget : kotlin.annotation.AnnotationTarget // JobState : javax.print.attribute.standard.JobState // JobStateReason : javax.print.attribute.standard.JobStateReason å¯¹äºè¡¨è¾¾å¼å£°æ˜ï¼Œè¿˜éœ€è¦æ–°å¢ä¸€ä¸ª Kotlin ä¸­ nullable ç±»å‹\n// æ€»å…±æœ‰ä»¥ä¸‹å‡ ç±» J - J K - K K? - K? J - K J - K? K - K? ç¬¬å››æ­¥ éªŒè¯æ¡†æ¶ // java éªŒè¯ä»£ç  public class JavaGenerated { void if_JavaClass_To_JavaClass(MyJavaClassB a) { if (a.equals(new MyJavaClassA())) { } else if (a == new MyJavaClassA()) { } } } // kotlin éªŒè¯ä»£ç  class KotlinGenerated { fun if_JavaClass_To_JavaClass(a: MyJavaClassB) { if (a == MyJavaClassA()) { } } } ç¬¬äº”æ­¥ ç¼–ç éªŒè¯ æœ‰äº†ä¸Šé¢çš„æ¨¡ç‰ˆä¹‹åï¼Œå°±å¯ä»¥æ ¹æ®å˜é‡å¼€å§‹ç¼–ç éªŒè¯ã€‚\né¢å¯¹å¤šç§çš„å˜é‡ç»„åˆçš„æƒ…å†µï¼Œæ‰‹åŠ¨ç¼–å†™å¤§é‡çš„æ¨¡ç‰ˆä»£ç éå¸¸çš„åŠ³ç´¯ã€‚\næ‰€ä»¥åˆ©ç”¨å·¥å…·ï¼Œä½¿ç”¨ JavaPoet å’Œ KotlinPoet æ¥ç”Ÿæˆä»£ç ã€‚\n(èŠ±äº†ä¸€å¤©æ¥å†™è‡ªåŠ¨ç”Ÿæˆä»£ç é€»è¾‘ï¼Œå®Œæˆåæ„Ÿåˆ°ä¸€é˜µç©ºè™šï¼Œä¸ºä»€ä¹ˆè¦èŠ±é‚£ä¹ˆå¤šçš„æ—¶é—´æŠ˜è…¾ï¼Œæ‰‹åŠ¨å¤åˆ¶ç²˜è´´æ—©å†™å®Œäº†ã€‚)\nğŸ˜­è¿™é‡Œå¤§è‡´è¯´ä»¥ä¸‹ç”Ÿæˆçš„æ€è·¯ï¼š\n1. åˆ†åˆ«æšä¸¾å‡ºéœ€è¦æµ‹è¯•çš„ä¸‰ç§ç±»å‹ï¼ŒJavaCase å’Œ KotlinCase 2. JavaCase å’Œ KotlinCase ä¸­ç›¸ä¸¤ä¸¤ç»„åˆ å¾—åˆ° java-kotlin 3. æ ¹æ® java-kotlin å†æ¬¡ç»„åˆ 5 ç§æƒ…å†µ * J 2 J * J 2 K * K 2 K * K? 2 K * K? 2 J 4. æ ¹æ® java-kotlin-pairs ç”Ÿæˆå¯¹åº”çš„ KotlinIf å’Œ JavaIf æ–¹æ³• 5. æ ¹æ®æ–¹æ³•ï¼Œé€šè¿‡ JavaPoet å’Œ KotlinPoet ä»£ç  ç”Ÿæˆåçš„ä»£ç æŒºå¤šçš„ï¼Œæ„Ÿå…´è¶£çš„å»çœ‹ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š\n JavaGenerated.java KotlinGenerated.kt  ç¬¬å…­æ­¥ è§‚å¯Ÿç»“æœ  ç¯å¢ƒå¦‚ä¸‹\n Java Version 1.8.0_172 Kotlin Version 1.3.72 IDEA Version 2020.1   è¿™é‡Œç»“æœå¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼š\n [error] ï¼Œä¸èƒ½ç¼–è¯‘ã€‚ç¼–è¯‘å™¨å‘Šè­¦ï¼Œåœ¨ IDEA ä¸­çº¢è‰²æ³¢æµªçº¿æ ‡å‡ºï¼› [warning] ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚IDEA å‘Šè­¦ï¼Œä»¥é»„è‰²èƒŒæ™¯é«˜äº®ã€‚  JavaGenerated.java å®Œå…¨ç¬¦åˆé¢„æœŸï¼Œ\n == ä¸èƒ½ç¼–è¯‘ï¼› equals() èƒ½å¤Ÿç¼–è¯‘ï¼Œå¦å¤– IDEA ç»™å‡ºå‹å¥½æé†’ã€‚     type == equals     Class [error] Operator \u0026lsquo;==\u0026rsquo; cannot be applied [warning] inconvertible types   Static [error] Operator \u0026lsquo;==\u0026rsquo; cannot be applied [warning] inconvertible types   Enum [error] Operator \u0026lsquo;==\u0026rsquo; cannot be applied [warning] condition is always false    KotlinGenerated.kt éƒ¨åˆ†ç¬¦åˆé¢„æœŸï¼Œ\n === ä¸èƒ½ç¼–è¯‘ï¼› == å¯¹äº Kotlin çš„ Class / Static ä¸èƒ½ç¼–è¯‘ã€‚     type ==     Class [error] EQUALITY_NOT_APPLICABLE,Operator \u0026lsquo;==\u0026rsquo; cannot be applied   Static [error] EQUALITY_NOT_APPLICABLE,Operator \u0026lsquo;==\u0026rsquo; cannot be applied   Enum [warning] INCOMPATIBLE_ENUM_COMPARISON,Comparison of incompatible enums is always unsuccessful    ä¸ç¬¦åˆé¢„æœŸï¼Œ\n Java Class / Static å¯ä»¥ç¼–è¯‘ï¼› Enum å¯ä»¥ç¼–è¯‘ã€‚  ä¸‹é¢æ˜¯ç›¸å…³ä»£ç ï¼š\nfun if_JavaClass_To_JavaClass(a: MyJavaClassB) { if (a == MyJavaClassA()) { } } fun if_JavaStatic_To_JavaStatic(a: JobStateReason) { if (a == JobState.CANCELED) { } } fun if_NullableKotlinEnum_To_JavaStatic(a: AnnotationRetention?) { if (a == JobState.CANCELED) { } } ä»¥ä¸Šæƒ…å†µå¯ä»¥å½’çº³ä¸ºï¼š\n Java å¯¹è±¡ç±»å‹(Class/Static)ï¼Œèƒ½é€šè¿‡ç¼–è¯‘ï¼›  JavaClass_To_JavaClass JavaStatic_To_JavaStatic   å¯ç©ºçš„ Kotlin æšä¸¾ç±»å‹å¯¹åº” Java é™æ€ç±»å‹ï¼Œèƒ½é€šè¿‡ç¼–è¯‘ï¼›  NullableKotlinEnum_To_JavaStatic    å¤§è‡´æ¢³ç†å‡ºä»¥ä¸‹ç–‘é—®ç‚¹ï¼š 2. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ 3. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ 4. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ 5. nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ\nç¬¬ä¸ƒæ­¥ æ¢ç©¶åŸå›   å†å›é¡¾ä¸€ä¸‹ Kotlin å®˜æ–¹æ–‡æ¡£ä¸­å¯¹ç›¸ç­‰ï¼ˆequalityï¼‰çš„å®šä¹‰ï¼š\na == b =\u0026gt; a?.equals(b) ?: (b === null) a === b =\u0026gt; a and b point to the same object 1. Class / Static çš„å¯¹æ¯”ä¸ºä»€ä¹ˆæ¯” Java çš„ equals æ›´ä¸¥æ ¼ï¼Ÿ ï¼ˆç›®å‰æ²¡æœ‰æƒ³æ¸…æ¥šåŸå› ï¼‰TODO ï¼šè¿™é‡Œåº”è¯¥å»çœ‹ Kotlin ç¼–è¯‘å™¨åœ¨å¤„ç† EQUALITY_NOT_APPLICABLE è¿™ä¸ªæŠ¥é”™ã€‚\n2. ä¸ºä»€ä¹ˆ Enum çš„å¯¹æ¯”å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œæ²¡æœ‰åƒä¸Šé¢é‚£ä¹ˆä¸¥æ ¼ï¼Ÿ åœ¨ Java ä¸­ enum å…¶å®æ˜¯è¯­æ³•ç³–ï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘ä¸ºèŒƒå‹ç±»ã€‚\nabstract class Enum\u0026lt;E extends Enum\u0026lt;E\u0026gt;\u0026gt; { ... } Kotlin ä¸ä¾‹å¤–ï¼Œenum class ä¹Ÿæ˜¯è¯­æ³•ç³–ï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘ä¸ºèŒƒå‹ç±»ã€‚\nabstract class Enum\u0026lt;E : Enum\u0026lt;E\u0026gt;\u0026gt; { ... } å½“ä¸¤ä¸ªæšä¸¾å¯¹æ¯”çš„æ—¶å€™ï¼Œç›¸å½“ä¸æ˜¯åŒä¸€ä¸ªç±»çš„ä¸åŒèŒƒå‹ï¼Œæ‰€ä»¥èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œä¸ä¼šå‡ºç°ç±»å‹ä¸åŒ¹é…é—®é¢˜ã€‚\nè¿™é‡Œï¼ŒIDEA å‘Šè­¦ INCOMPATIBLE_ENUM_COMPARISON ç»™å‡ºå‹å¥½æç¤ºã€‚\n3. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ Java çš„å¯¹è±¡å¯¹æ¯”ï¼Œä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿ Kotlin ä¸­æœ‰ä¸¥æ ¼çš„ Nullable / Notnull è¯­æ³•ã€‚\nå½“ä¸ Java çš„ç±»è¿›è¡Œäº’ç›¸è°ƒç”¨æ—¶ï¼Œç”±äº Java ä¸­çš„ Null ä¿¡æ¯ä¸ç¡®å®šï¼Œç¼–è¯‘å™¨æ— æ³•æ¨æ–­å‡º Java ç±»çš„å…·ä½“ Null ä¿¡æ¯(é»˜è®¤è§†ä¸º Nullable)ã€‚ å¯ä»¥åœ¨ IDEA çš„æ™ºèƒ½ç±»å‹æ¨æ–­ä¸­çœ‹åˆ° ! çš„æ ‡è¯†ã€‚ ï¼ˆåœ¨ Java ä¸­æ˜¾å¼ä½¿ç”¨ JetBrains æä¾›çš„ @Nullable / @NotNull è¿™ä¸¤ä¸ªæ³¨è§£ï¼Œå¯ä»¥è®© Kotlin ç¼–è¯‘å™¨æ­£ç¡®æ¨æ–­å‡º Null ä¿¡æ¯ï¼‰ ã€TODOï¼Œæä¾› IDEA æˆªå›¾æ›´å¥½ã€‘\næ‰€ä»¥ä¸¤ä¸ª Nullable ç±»å‹çš„è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šèµ°åˆ° b === null è¿™ä¸ªåˆ¤æ–­ï¼Œä¸ä¼šæŠ¥é”™ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚\n4. Kotlin nullable çš„æšä¸¾ç±»ä¸ºä»€ä¹ˆå¯ä»¥ä¸ Java çš„é™æ€ç±»å‹å¯¹æ¯”ï¼Ÿ è¿›è¡Œä¸Šè¿°å‰ç½®æ¢ç´¢ï¼Œç»ˆäºåˆ°è¿™æ¬¡é—®é¢˜çš„ç»ˆç‚¹ã€‚ç»“åˆä¸Šé¢çš„ç»“è®ºï¼Œæ€»ç»“å¦‚ä¸‹ï¼š\n æšä¸¾ç±»ç¼–è¯‘åæ˜¯åŒä¸€ä¸ª Enum ç±»ï¼› Java çš„é™æ€ç±»å‹ Null ä¿¡æ¯æœªçŸ¥ï¼› ä¸¤ä¸ª Nullable ç±»å‹è¿›è¡Œå¯¹æ¯”ï¼Œä¼šèµ°åˆ° b === null åˆ¤æ–­ï¼Œä¸ä¼šæŠ¥é”™ï¼Œèƒ½å¤Ÿç¼–è¯‘ã€‚  // ç»™ Java çš„ç±»æ˜ç¡®çš„ Null ä¿¡æ¯ // IDEA å‡ºç°å‹å¥½è­¦å‘Š [INCOMPATIBLE_ENUM_COMPARISON] fun if_NullableKotlinEnum_To_JavaStatic(a: AnnotationRetention?) { // ä½¿ç”¨ !! å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ˜ç¡® Null ä¿¡æ¯æ˜¯ Notnull  if (a == JobState.CANCELED!!) { // [INCOMPATIBLE_ENUM_COMPARISON] Comparison of incompatible enums  // \u0026#39;AnnotationRetention?\u0026#39; and \u0026#39;JobState\u0026#39; is always unsuccessful  } } ğŸ‘€æ€»ç»“  æ•´ä¸ªæ¢æ±‚çœŸç›¸çš„è¿‡ç¨‹è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ï¼› æœ€åçŸ¥é“çœŸç›¸åï¼Œè¿˜æ˜¯è‡ªå·±å¤ªèœäº†ï¼ŒåŸºç¡€çŸ¥è¯†æ²¡æœ‰å®Œå…¨æŒæ¡ï¼› æ·±å…¥æ¢ç©¶äº† Kotlin å’Œ Java çš„ç›¸ç­‰å’Œæšä¸¾ç›¸å…³çš„å†…å®¹ï¼› ä¸‹ä¸€æ­¥ï¼šè¶ç€è¿™è‚¡å¥½å¥‡å¿ƒï¼Œå»äº†è§£ Kotlin ç¼–è¯‘å™¨çš„ç›¸ç­‰ç±»å‹åˆ¤æ–­æºç ã€‚  ğŸ”—ç›¸å…³é“¾æ¥  GitHub Source Code Kotlin Equality Docs JavaPoet KotlinPoet JavaGenerated.java KotlinGenerated.kt  ","permalink":"https://lexcao.io/zh/posts/kotlin-equality-diving/","summary":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªå¹³æ—¶æ²¡æ€ä¹ˆå…³æ³¨çš„ Kotlin ç›¸ç­‰é—®é¢˜ï¼Œå†³å®šè®°å½•ä¸€ä¸‹æ¢ç©¶è¿‡ç¨‹ã€‚\näº‹ç”± ä»¥ä¸‹ä»£ç ç‰‡æ®µ Kotlin ç‰ˆæœ¬ 1.3.72ã€‚\nè¿˜åŸé—®é¢˜ä»£ç ï¼Œå·²å»é™¤ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä»…ä¿ç•™å…³é”®ä»£ç ï¼Œç‰‡æ®µå¦‚ä¸‹ï¼š\n// æœ‰ä¸€ä¸ªçŠ¶æ€æšä¸¾ enum class MyState { OK, CANCELED } // æŸä¸ªå¤„ç†å‡½æ•°ä¼šè¿”å› nullable MyState fun processing(): MyState? { // å‡è®¾å½“å‰æŸç§æƒ…å†µä¸‹è¿”å› å–æ¶ˆ è¿™ä¸ªçŠ¶æ€  return MyState.CANCELED } // åœ¨å¤„ç†çŠ¶æ€æ—¶ fun handleState() { // æ­¤æ—¶ç¼–è¯‘å™¨æ¨æ–­å‡ºç±»å‹ä¸º State?  val state = processing() if (state == CANCELED) { // å½“å¤„ç† CANCELED ä»¥ä¸‹ä»£ç æ²¡æœ‰æ‰§è¡Œ  println(\u0026#34;Handle \u0026lt;CANCELED\u0026gt; state\u0026#34;) } } å½“å¤„ç† CANCELED ä»£ç æ²¡æœ‰æ‰§è¡Œï¼ŒåŸå› åœ¨äº***ã€Œimportã€***ã€‚\nimport javax.print.attribute.standard.JobState.CANCELED // æ­¤å¤„ä½¿ç”¨é™æ€å¯¼å…¥å¼•å…¥äº†ä¸€ä¸ªå…¶ä»–åŒ…ä¸­åŒåçš„ä¸€ä¸ªé™æ€å˜é‡ï¼Œè¯¥å˜é‡å£°æ˜å¦‚ä¸‹ // public static final JobState CANCELED = new JobState (7); è§£å†³æ–¹æ³•ï¼š","title":"Kotlin å¥‡æ€ªçš„ç›¸ç­‰ç°è±¡æ¢ç©¶"},{"content":"èƒŒæ™¯ Web åå°å¼€å‘ä¸­ï¼Œå¯¹äºä¸€ä¸ªå®ä½“çš„æ“ä½œä¼šè¡ç”Ÿå‡ºå¤šä¸ªç±»ä¼¼çš„å¯¹è±¡è¿›è¡Œæ“ä½œï¼ˆé¿å…ç›´æ¥ä½¿ç”¨å®ä½“ï¼‰ï¼Œç”±æ­¤å‡ºç°ç›¸å…³åè¯\n æŒä¹…åŒ–å¯¹è±¡ï¼Œå³å®ä½“ PO(Persistent Object) ä¼ è¾“å¯¹è±¡ DTO(Data Transfer Object) ä¸šåŠ¡å¯¹è±¡ BO(Business Object) å±•ç¤ºå¯¹è±¡ VO(View Object) ç­‰ç­‰â€¦â€¦ è¿™äº›å¯¹è±¡å¤§å¤šæ•°ç›´æ¥ä»å®ä½“é‡Œé¢è£å‰ªå‡ ä¸ªå­—æ®µï¼Œæ¯”å¦‚ï¼Œåœ¨ä¸€æ¬¡åˆ›å»ºè®¢å•è¯·æ±‚ä¸­ä»¥è®¢å•å®ä½“ï¼ˆOrderEntityï¼‰ä¸ºä¾‹ï¼Œç»å†å¦‚ä¸‹æµç¨‹ï¼š  1. æ¥æ”¶è¯·æ±‚ä½“ CreateOrderRequest 2. æ ¹æ® OrderQuery æ„é€ æŸ¥è¯¢å¯¹è±¡æŸ¥è¯¢è®¢å• 3. æ„é€  OrderEntity è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ 4. æ„é€  OrderBO è¿›è¡Œä¸‹æ¸¸æ¶ˆè´¹ 5. è¿”å›å“åº”ä½“ CreateOrderResponse å¯è§ï¼Œä» OrderEntity è¡ç”Ÿå‡º 4 ä¸ªå¯¹è±¡ï¼Œä»…ä»…æ˜¯å¯¹è®¢å•çš„å®ä½“çš„éƒ¨åˆ†è£å‰ªï¼Œä½†æ˜¯è¦ç¼–å†™å¾ˆå¤šé‡å¤çš„ä»£ç ï¼ˆå¤åˆ¶ä¹Ÿè¡Œï¼‰ã€‚å½“ç„¶ï¼Œå¦‚æœæ˜¯æ–°å¢å­—æ®µçš„è¯å¯ä»¥ä½¿ç”¨ç»§æ‰¿è§£å†³ã€‚\nåœ¨ Kotlin Web åå°å¼€å‘ä¸­ï¼Œdata class çš„è¯­æ³•ç‰¹æ€§å¸¦æ¥å¾ˆå¤šä¼˜åŠ¿ï¼Œä½†è¿˜æ˜¯é¿å…ä¸äº†åˆ›å»ºç±»ä¼¼çš„é‡å¤å¯¹è±¡ã€‚ æ‰€ä»¥ Konverter è¯ç”Ÿäºæ­¤ï¼Œè§£å†³å®ä½“å¯¹è±¡è£å‰ªé—®é¢˜ã€‚è¿˜æœ‰å¦ä¸€ä¸ªåŠŸèƒ½é‚£å°±æ˜¯è‡ªåŠ¨ç”Ÿæˆä¸¤ä¸ªå®ä½“é—´çš„è½¬æ¢æ–¹æ³•ã€‚\n æ³¨æ„ï¼šç›®å‰åªæ”¯æŒ Kotlinï¼Œå¹¶ä¸”ç”Ÿæˆçš„è½¬æ¢æ–¹æ³•æ˜¯é€šè¿‡æ‰©å±•å‡½æ•°å®ç°\n æ˜¯ä»€ä¹ˆ é€šè¿‡ KAPT(Kotlin Annotation Processing Tool æ³¨è§£å¤„ç†ä»¥åŠ Kotlin Poet ä»£ç ç”Ÿæˆï¼Œå®ç°è‡ªåŠ¨ç”Ÿæˆå¯¹å®ä½“çš„ç›¸å…³è£å‰ªçš„å¯¹è±¡ã€‚ ä¸»è¦æœ‰ä¸¤ä¸ªæ³¨è§£ï¼š\n @Konvertable ç”Ÿæˆè£å‰ªçš„å®ä½“ä»¥åŠå¯¹åº”çš„è½¬æ¢æ–¹æ³• @Konvert å•ç‹¬é’ˆå¯¹æŸä¸ªç±»ç”Ÿæˆè½¬æ¢æ–¹æ³•  åºŸè¯ä¸å¤šè¯´æ¥çœ‹æ€ä¹ˆä½¿ç”¨ã€‚\næ€ä¹ˆç”¨ 1. å¼•å…¥ä¾èµ– // for build.gradle.kts repositories { maven(\u0026quot;https://jitpack.io\u0026quot;) } dependencies { kapt(\u0026quot;com.github.lexcao:konverter:master-SNAPSHOT\u0026quot;) implementation(\u0026quot;com.github.lexcao:konverter-annotation:master-SNAPSHOT\u0026quot;) } // for build.gradle repositories { maven { url 'https://jitpack.io' } } dependencies { kapt 'com.github.lexcao:konverter:master-SNAPSHOT' implementation 'com.github.lexcao:konverter-annotation:master-SNAPSHOT' } 2. åœ¨éœ€è¦è½¬æ¢çš„ç±»ä¸ŠåŠ ä¸Šæ³¨è§£ @Konvertable( To(name = \u0026quot;LoginDTO\u0026quot;, pick = [\u0026quot;username\u0026quot;, \u0026quot;password\u0026quot;]), To(name = \u0026quot;UserListDTO\u0026quot;, omit = [\u0026quot;password\u0026quot;]) ) @Konvert(to = UserVO::class) data class UserEntity( val id: Long, @Konvert.Field(\u0026quot;name\u0026quot;) val username: String, val password: String, @Konvert.By(GenderEnumConverter::class) val gender: Int ) 3. ç”Ÿæˆçš„ä»£ç å¦‚ä¸‹ï¼š // @Konvertable /** * Auto generated code by @Konvertable */ data class LoginDTO( val username: String, val password: String ) /** * Auto generated code by @Konvertable */ data class UserListDTO( val id: Long, val username: String, val gender: Int ) /** * Auto generated code by @Konvert */ fun UserEntity.toLoginDTO(username: String = this@toLoginDTO.username, password: String = this@toLoginDTO.password): LoginDTO = LoginDTO(username=username,password=password) /** * Auto generated code by @Konvert */ fun LoginDTO.toUserEntity( id: Long = 0L, username: String = this@toUserEntity.username, password: String = this@toUserEntity.password, gender: Int = 0 ): UserEntity = UserEntity(id=id,username=username,password=password,gender=gender) /** * Auto generated code by @Konvert */ fun UserEntity.toUserListDTO( id: Long = this@toUserListDTO.id, username: String = this@toUserListDTO.username, gender: Int = this@toUserListDTO.gender ): UserListDTO = UserListDTO(id=id,username=username,gender=gender) /** * Auto generated code by @Konvert */ fun UserListDTO.toUserEntity( id: Long = this@toUserEntity.id, username: String = this@toUserEntity.username, password: String = \u0026quot;\u0026quot;, gender: Int = this@toUserEntity.gender ): UserEntity = UserEntity(id=id,username=username,password=password,gender=gender) /** * Auto generated code by @Konvert */ fun UserEntity.toRegisterDTO( username: String = this@toRegisterDTO.username, password: String = this@toRegisterDTO.password, gender: Int = this@toRegisterDTO.gender ): RegisterDTO = RegisterDTO(username=username,password=password,gender=gender) /** * Auto generated code by @Konvert */ fun RegisterDTO.toUserEntity( id: Long = 0L, username: String = this@toUserEntity.username, password: String = this@toUserEntity.password, gender: Int = this@toUserEntity.gender ): UserEntity = UserEntity(id=id,username=username,password=password,gender=gender) // @Konvert // è½¬æ¢ä¸ºå¦‚ä¸‹å¯¹è±¡ data class UserVO( val id: String, val name: String, val gender: GenderEnum ) enum class GenderEnum { MALE, FEMALE; } object GenderEnumConverter : Konvert.KonvertBy\u0026lt;Int, GenderEnum\u0026gt; { override fun Int.forward(): GenderEnum { return GenderEnum.values()[this] } override fun GenderEnum.backward(): Int { return this.ordinal } } // ç”Ÿæˆçš„ä»£ç  ** * Auto generated code by @Konvert */ fun UserEntity.toUserVO( id: String = this@toUserVO.id.toString(), name: String = this@toUserVO.username, gender: GenderEnum = with(GenderEnumConverter) { this@toUserVO.gender.forward() } ): UserVO = UserVO(id=id,name=name,gender=gender) /** * Auto generated code by @Konvert */ fun UserVO.toUserEntity( id: Long = this@toUserEntity.id.toLong(), username: String = this@toUserEntity.name, password: String = \u0026quot;\u0026quot;, gender: Int = with(GenderEnumConverter) { this@toUserEntity.gender.backward() } ): UserEntity = UserEntity(id=id,username=username,password=password,gender=gender) ç›¸å…³ API è¯´æ˜ è½¬æ¢è§„åˆ™\n å¦‚æœè½¬æ¢è‡³ String ç±»å‹ï¼ŒåŸç±»å‹ä¸åŒ¹é…æ—¶ä¼šè°ƒç”¨ toString() å¦‚æœè½¬æ¢è‡³åŸºç¡€æ•°æ®ç±»å‹ï¼Œè½¬æ¢å­—æ®µç¼ºå¤±æ—¶ä¼šä½¿ç”¨é»˜è®¤ç±»å‹ å¦‚æœè½¬æ¢è‡³å…è®¸ä¸º null ç±»å‹ï¼ŒåŸç±»å‹ä¸åŒ¹é…æ—¶ä¼šä½¿ç”¨é»˜è®¤å€¼ null å¦‚æœè½¬æ¢è‡³å¼•ç”¨ç±»å‹ï¼ˆString é™¤å¤–ï¼‰æˆ–è€…æ‰¾ä¸åˆ°æ˜ å°„éœ€è¦åœ¨è½¬æ¢æ–¹æ³•æ˜¾å¼èµ‹å€¼  ä¸‹ä¸€æ­¥  ä»£ç é‡æ„ï¼Œæ–°å¢æµ‹è¯•ç”¨ä¾‹ æ”¯æŒå¼•ç”¨ç±»å‹é»˜è®¤å€¼ æ”¯æŒåµŒå¥—å¯¹è±¡ æ”¯æŒ Java å·²çŸ¥ BUG ä¿®å¤ æ”¯æŒæ˜ å°„å¤±è´¥å­—æ®µè·å–åŸç±»å‹çš„æ„é€ å‡½æ•°å‚æ•°é»˜è®¤å€¼ï¼Œæˆ–è€…æˆå‘˜å˜é‡é»˜è®¤å€¼ï¼ˆç›®å‰ Kotlin KAPT å·²æ”¯æŒè·å–æˆå‘˜å˜é‡é»˜è®¤å€¼ï¼Œæš‚ä¸æ”¯æŒè·å–å‡½æ•°å‚æ•°é»˜è®¤å€¼ï¼‰  å·²çŸ¥ BUG  ç›¸åŒ name åœ¨ @Konvertable å†²çª @Konvertable å‚æ•°åˆæ³•æ€§æ ¡éªŒä»¥åŠå‹å¥½æŠ¥é”™ KonvertBy ç›®å‰ä½¿ç”¨ Class æŠ¥é”™æˆ–è€…ä½¿ç”¨ Companion æŠ¥é”™  æœ€å Konverter æºç åœ¨ GitHub\nç›¸å…³çš„æ ·ä¾‹ä»£ç  GitHub\n","permalink":"https://lexcao.io/zh/posts/konverter/","summary":"èƒŒæ™¯ Web åå°å¼€å‘ä¸­ï¼Œå¯¹äºä¸€ä¸ªå®ä½“çš„æ“ä½œä¼šè¡ç”Ÿå‡ºå¤šä¸ªç±»ä¼¼çš„å¯¹è±¡è¿›è¡Œæ“ä½œï¼ˆé¿å…ç›´æ¥ä½¿ç”¨å®ä½“ï¼‰ï¼Œç”±æ­¤å‡ºç°ç›¸å…³åè¯\n æŒä¹…åŒ–å¯¹è±¡ï¼Œå³å®ä½“ PO(Persistent Object) ä¼ è¾“å¯¹è±¡ DTO(Data Transfer Object) ä¸šåŠ¡å¯¹è±¡ BO(Business Object) å±•ç¤ºå¯¹è±¡ VO(View Object) ç­‰ç­‰â€¦â€¦ è¿™äº›å¯¹è±¡å¤§å¤šæ•°ç›´æ¥ä»å®ä½“é‡Œé¢è£å‰ªå‡ ä¸ªå­—æ®µï¼Œæ¯”å¦‚ï¼Œåœ¨ä¸€æ¬¡åˆ›å»ºè®¢å•è¯·æ±‚ä¸­ä»¥è®¢å•å®ä½“ï¼ˆOrderEntityï¼‰ä¸ºä¾‹ï¼Œç»å†å¦‚ä¸‹æµç¨‹ï¼š  1. æ¥æ”¶è¯·æ±‚ä½“ CreateOrderRequest 2. æ ¹æ® OrderQuery æ„é€ æŸ¥è¯¢å¯¹è±¡æŸ¥è¯¢è®¢å• 3. æ„é€  OrderEntity è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ 4. æ„é€  OrderBO è¿›è¡Œä¸‹æ¸¸æ¶ˆè´¹ 5. è¿”å›å“åº”ä½“ CreateOrderResponse å¯è§ï¼Œä» OrderEntity è¡ç”Ÿå‡º 4 ä¸ªå¯¹è±¡ï¼Œä»…ä»…æ˜¯å¯¹è®¢å•çš„å®ä½“çš„éƒ¨åˆ†è£å‰ªï¼Œä½†æ˜¯è¦ç¼–å†™å¾ˆå¤šé‡å¤çš„ä»£ç ï¼ˆå¤åˆ¶ä¹Ÿè¡Œï¼‰ã€‚å½“ç„¶ï¼Œå¦‚æœæ˜¯æ–°å¢å­—æ®µçš„è¯å¯ä»¥ä½¿ç”¨ç»§æ‰¿è§£å†³ã€‚\nåœ¨ Kotlin Web åå°å¼€å‘ä¸­ï¼Œdata class çš„è¯­æ³•ç‰¹æ€§å¸¦æ¥å¾ˆå¤šä¼˜åŠ¿ï¼Œä½†è¿˜æ˜¯é¿å…ä¸äº†åˆ›å»ºç±»ä¼¼çš„é‡å¤å¯¹è±¡ã€‚ æ‰€ä»¥ Konverter è¯ç”Ÿäºæ­¤ï¼Œè§£å†³å®ä½“å¯¹è±¡è£å‰ªé—®é¢˜ã€‚è¿˜æœ‰å¦ä¸€ä¸ªåŠŸèƒ½é‚£å°±æ˜¯è‡ªåŠ¨ç”Ÿæˆä¸¤ä¸ªå®ä½“é—´çš„è½¬æ¢æ–¹æ³•ã€‚\n æ³¨æ„ï¼šç›®å‰åªæ”¯æŒ Kotlinï¼Œå¹¶ä¸”ç”Ÿæˆçš„è½¬æ¢æ–¹æ³•æ˜¯é€šè¿‡æ‰©å±•å‡½æ•°å®ç°\n æ˜¯ä»€ä¹ˆ é€šè¿‡ KAPT(Kotlin Annotation Processing Tool æ³¨è§£å¤„ç†ä»¥åŠ Kotlin Poet ä»£ç ç”Ÿæˆï¼Œå®ç°è‡ªåŠ¨ç”Ÿæˆå¯¹å®ä½“çš„ç›¸å…³è£å‰ªçš„å¯¹è±¡ã€‚ ä¸»è¦æœ‰ä¸¤ä¸ªæ³¨è§£ï¼š\n @Konvertable ç”Ÿæˆè£å‰ªçš„å®ä½“ä»¥åŠå¯¹åº”çš„è½¬æ¢æ–¹æ³• @Konvert å•ç‹¬é’ˆå¯¹æŸä¸ªç±»ç”Ÿæˆè½¬æ¢æ–¹æ³•  åºŸè¯ä¸å¤šè¯´æ¥çœ‹æ€ä¹ˆä½¿ç”¨ã€‚","title":"ä½¿ç”¨ KAPT ç”Ÿæˆ Kotlin Data Class è½¬æ¢å™¨"},{"content":"èƒŒæ™¯ æŸæ¬¡å‘ç‰ˆä¹‹åï¼Œçº¿ä¸ŠæœåŠ¡ä½æ¦‚ç‡å‡ºç°æŸå°å®ä¾‹æ¥å£å“åº”è¶…æ—¶ï¼Œå…·ä½“è¡¨ç°ä¸ºï¼š\n /health æ¥å£è¶…æ—¶æŠ¥è­¦ï¼› çº¿ç¨‹æ­»é”ï¼ŒTomcat çº¿ç¨‹æ± åƒæ»¡ï¼› æœåŠ¡å®Œå…¨æ— å“åº”ã€‚  ä¿ç•™ä¸‹å½“å‰ heap dump å’Œ thread stack åï¼Œä¸´æ—¶é‡å¯æœåŠ¡å™¨æ¢å¤æ­£å¸¸ã€‚\n# heap dump $ jmap -dump:format=b,file=dump.hprof [pid] # thread stack jstack [pid] \u0026gt; stack.txt æ¥ä¸‹æ¥ç®€å•è®°å½•ä¸€ä¸‹æ’æŸ¥ç»“æœã€‚ ï¼ˆæ­¤æ–‡ä¸ºå›å¿†æ‰€å†™ï¼Œå½“æ—¶æ’æŸ¥çš„æ€è€ƒç»†èŠ‚å’Œè¿‡ç¨‹å·²çœç•¥ï¼‰\næ’æŸ¥ heap dump ä½¿ç”¨å·¥å…· Eclipse + MAT\nå®‰è£… # å®‰è£… eclipse $ brew cask install eclipse-java # å®‰è£… eclipse MAT $ brew cask install mat # æ˜¯çš„ï¼Œè¿™ä¸ªå°±æ˜¯ eclipse-mat ç›¸å…³è¿æ¥   Eclipse\n  Eclipse MAT\n  ä½¿ç”¨   æŠŠ heap dump æ–‡ä»¶ dump.hprof å¯¼å…¥åˆ° MATã€‚\n  å‘ç°æœ‰ä¸€ä¸ªåç§°ä¸º Spring-Async-Scheduler å¼‚æ­¥é˜Ÿåˆ—å ç”¨ç‰¹åˆ«å¤§ã€‚ã€TODO å›¾ç‰‡ã€‘\n  è¿™é‡Œæ’æŸ¥æ–¹å‘æœ‰äº†ï¼šå¼‚æ­¥è°ƒç”¨ç›¸å…³ã€‚\nthread stack ä½¿ç”¨å·¥å…· ç›´æ¥ä½œä¸º txt æ‰“å¼€ï¼Œæˆ–è€…ä½¿ç”¨ IDEA è‡ªå¸¦çš„çº¿ç¨‹æ ˆåˆ†æã€‚\nä½¿ç”¨  æ‰“å¼€ IDEA èœå•æ  Analyze \u0026gt; Analyze Stack Trace or Thread Dumpï¼› å¤åˆ¶ thread.txt å†…å®¹åˆ°çª—å£åŒºï¼› å®˜æ–¹è¯´æ˜ IDEA Analyze Stacktrace ï¼› å¦‚æœæ˜¯åŒä¸€ä¸ªé¡¹ç›®çš„è°ƒç”¨æ ˆï¼ŒIDEA æ”¯æŒè·³è½¬åˆ°å…·ä½“çš„æ–¹æ³•ï¼Œå¼ºçƒˆæ¨èğŸ‘ã€‚ ã€TODO å›¾ç‰‡ã€‘  æ’æŸ¥ é€šè¿‡ IDEA ä¸­å‹å¥½çš„çº¿ç¨‹æ ˆä¿¡æ¯å¯è§ï¼Œã€TODO æˆªå›¾ã€‘\n  Tomcat-NIO å…¨éƒ¨ 200 ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…ï¼Œæ²¡æœ‰çº¿ç¨‹ç»§ç»­å¤„ç†åç»­çš„è¯·æ±‚ï¼›\n  Spring-Async å…¨éƒ¨ 4 ä¸ªçº¿ç¨‹ä¹Ÿåœ¨ç­‰å¾…ï¼›\n  \u0026quot;async-1\u0026quot; #151 prio=5 os_prio=0 tid=0x00007f18001a1000 nid=0x94 waiting on condition [0x00007f17be9ea000] java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for \u0026lt;0x00000000e176e988\u0026gt; (a java.util.concurrent.CompletableFuture$Signaller) \u0026quot;async-2\u0026quot; #152 prio=5 os_prio=0 tid=0x00007f18001a4800 nid=0x95 waiting on condition [0x00007f17be8e9000] java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for \u0026lt;0x00000000e177c3c8\u0026gt; (a java.util.concurrent.CompletableFuture$Signaller) \u0026quot;async-3\u0026quot; #153 prio=5 os_prio=0 tid=0x00007f18001dc800 nid=0x96 waiting on condition [0x00007f17be7e8000] java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for \u0026lt;0x00000000e1794a08\u0026gt; (a java.util.concurrent.CompletableFuture$Signaller) \u0026quot;async-4\u0026quot; #160 prio=5 os_prio=0 tid=0x00007f182002d800 nid=0x9d waiting on condition [0x00007f17be0e1000] java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for \u0026lt;0x00000000e176e958\u0026gt; (a java.util.concurrent.CompletableFuture$Signaller) ä¸ºä»€ä¹ˆ Spring-Async-Pool çº¿ç¨‹æ± åªæœ‰ 4 ä¸ªçº¿ç¨‹ æŸ¥çœ‹ @EnablePooledAsync \u0026gt; AsyncAutoConfigurer \u0026gt; PooledAsyncProperties\n// é»˜è®¤é…ç½®å¦‚ä¸‹ // æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° var corePoolSize: Int = Runtime.getRuntime().availableProcessors() // æœ€å¤§çº¿ç¨‹æ± å¤§å° var maxPoolSize: Int = Math.max(Runtime.getRuntime().availableProcessors() shl 2, 64) // é˜Ÿåˆ—å®¹é‡ var queueCapacity: Int = 500_00 è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æ˜¯å¹³å°ç»„æä¾›çš„é€šç”¨ç»„ä»¶ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨ CPU æ ¸æ•°ã€‚\nå·²çŸ¥æœåŠ¡å™¨é…ç½®ä¸º 4 æ ¸ï¼Œæ‰€ä»¥æ ¸å¿ƒçº¿ç¨‹æ± æ•°é‡ä¸º 4ã€‚\nğŸ¤”æ€è€ƒ 4 ä¸ªå¼‚æ­¥çº¿ç¨‹é˜Ÿåˆ—ç­‰å¾…ï¼ŒTomcat çš„ 200 ä¸ªçº¿ç¨‹ä¹Ÿåœ¨ç­‰å¾…ã€‚\n ä¼šä¸ä¼šæ˜¯å¼‚æ­¥è°ƒç”¨ä¸­å‡ºç°å¾ªç¯ç­‰å¾…é€ æˆæ­»é”ï¼Ÿ  ï¼ˆéœ€è¦çœ‹ä¸€ä¸‹è¿™æ¬¡ç‰ˆæœ¬ä¸Šçº¿æ–°å¢çš„å¼‚æ­¥è°ƒç”¨ä»£ç ï¼‰   æœ‰æ²¡æœ‰å¯èƒ½åœ¨å¼‚æ­¥è°ƒç”¨é€”ä¸­å‘ç”Ÿå¼‚å¸¸ï¼Ÿ å¯ä»¥æ ¹æ® Tomcat ä¸­å·²ç»é˜»å¡çš„çº¿ç¨‹çœ‹ä¸‹å…·ä½“æ˜¯å“ªäº›æ¥å£å¼•èµ·ï¼Ÿ  æŸ¥çœ‹ä»£ç  æ–°ä¸Šçº¿çš„å¼‚æ­¥ä»£ç å«Œç–‘æœ€å¤§ï¼Œè¿™é‡Œå®šä½åˆ°ä¸€ä¸ªè°ƒç”¨å¼‚æ­¥æ–¹æ³•ï¼Œå·²åˆ é™¤ä¸šåŠ¡é€»è¾‘ï¼Œæå–å‡ºä»¥ä¸‹ä»£ç ç»“æ„ï¼š\n@GetMapping(\u0026#34;/test\u0026#34;) fun test() { val future = async { fetch(listOf(1,2,3)) } future.await() // #2 } fun fetch(ids: List\u0026lt;Long\u0026gt;): DTO { return async { doFetch() }.await() // #1 } ç®€å•è¯´ä¸€ä¸‹ä¸Šé¢ä»£ç çš„è°ƒç”¨ï¼Œasync å†…è°ƒç”¨ fetch() æ–¹æ³•ï¼Œè€Œé‡Œé¢åµŒå¥—äº†ä¸€ä¸ª async è°ƒç”¨ã€‚\n è¿™é‡Œè°ƒç”¨æ–¹å¯èƒ½å¹¶ä¸çŸ¥é“ fetch() å‡½æ•°é‡Œé¢å·²ç»å¼€å¯äº†ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨ï¼Œå‡ºç°å¼‚æ­¥åµŒå¥—è°ƒç”¨çš„ç°è±¡ã€‚  ä¸‹é¢åˆ†æä¸€ä¸‹ã€Œå¼‚æ­¥å†…è°ƒç”¨å¼‚æ­¥ã€ä¸ºä»€ä¹ˆä¼šå‡ºç°ç›¸äº’ç­‰å¾…å¯¼è‡´çº¿ç¨‹æ­»é”ã€‚\nå·²çŸ¥å½“å‰å£°æ˜çš„ Async-Pool çº¿ç¨‹æ± çº¿ç¨‹æ•°ä¸º 4 ä¸ªï¼š\n å¹¶å‘è¯·æ±‚å‡ºç°ï¼ŒåŒæ—¶å‡ºç° 4ä¸ªä»¥ä¸Š #1 åœ¨ç­‰å¾… #1 å¤„äº§ç”Ÿçš„å¼‚æ­¥è°ƒç”¨è¿›å…¥ Asnyc-Pool-Queue ä¸­æ’é˜Ÿ #2 å¤„ç­‰å¾… #1 ä¸­çš„è¿”å› #1 åœ¨ç­‰å¾…å…¶å­ä»»åŠ¡ #2 åœ¨ç­‰å¾… #1 ä½†æ˜¯é˜Ÿä¸­ç­‰å¾…çš„åªæœ‰ #2ï¼Œ#1 çš„å­ä»»åŠ¡è¿˜åœ¨æ’é˜Ÿä¸­ å‡ºç°ç›¸äº’ç­‰å¾…çš„æƒ…å†µï¼Œå¯¼è‡´æ— é™ç­‰ä¸‹å»äº†  è¿™é‡Œç®€å•æ¨¡æ‹Ÿäº†ä¸€ä¸‹å¼‚æ­¥é˜Ÿåˆ—é‡Œé¢çš„ä»»åŠ¡æƒ…å†µ 1. å½“å‰é˜Ÿåˆ—ä¸ºç©º \u0026gt; async-pool - [] \u0026gt; async-pool-queue - [] 2. ä¸€ä¸ªè¯·æ±‚è¿›æ¥ \u0026gt; async-pool - [#2, #1] \u0026gt; async-pool-queue - [] 3. å¤šä¸ªè¯·æ±‚é¡ºåºè¿›æ¥ - ç†æƒ³æƒ…å†µ \u0026gt; async-pool - [#2, #1, #2, #1] \u0026gt; async-pool-queue - [#2, #1] ---- ä»¥ä¸‹æ˜¯å¼‚å¸¸æƒ…å†µ 4. å½“å¤šä¸ªè¯·æ±‚å¹¶å‘è¿›æ¥ - å®é™…ä¸Š \u0026gt; async-pool - [#2, #2, #2, #2] \u0026gt; async-pool-queue - [#1, #1, #1, #1, #1] --\u0026gt; æ­¤å¤„è§¦å‘æ— é™ç­‰å¾… ç»“è®º å¼‚æ­¥é‡Œé¢åµŒå¥—å¼‚æ­¥çš„æƒ…å†µï¼Œå¦‚æœä¸¤ä¸ªå¼‚æ­¥ä½¿ç”¨åŒä¸€ä¸ªå¼‚æ­¥é˜Ÿåˆ—ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ä¼šå‡ºç°å¼‚æ­¥çº¿ç¨‹ç›¸äº’ç­‰å¾…å¯¼è‡´æ­»é”é—®é¢˜ã€‚\nè§£å†³æ–¹æ¡ˆï¼š\n ä½¿ç”¨åŒä¸€ä¸ªçº¿ç¨‹æ± çš„å¼‚æ­¥çº¿ç¨‹ç¦æ­¢åµŒå¥—è°ƒç”¨ï¼› å¦‚æœéœ€è¦å¼‚æ­¥åµŒå¥—å¼‚æ­¥è°ƒç”¨ï¼Œä¸¤ä¸ªå¼‚æ­¥éœ€è¦æ‹¥æœ‰ä¸åŒçš„å¼‚æ­¥é˜Ÿåˆ—ã€‚  å‚è€ƒé“¾æ¥  Eclipse Eclipse MAT JStack IDEA Analyze Stacktrace  ","permalink":"https://lexcao.io/zh/posts/async-within-async/","summary":"èƒŒæ™¯ æŸæ¬¡å‘ç‰ˆä¹‹åï¼Œçº¿ä¸ŠæœåŠ¡ä½æ¦‚ç‡å‡ºç°æŸå°å®ä¾‹æ¥å£å“åº”è¶…æ—¶ï¼Œå…·ä½“è¡¨ç°ä¸ºï¼š\n /health æ¥å£è¶…æ—¶æŠ¥è­¦ï¼› çº¿ç¨‹æ­»é”ï¼ŒTomcat çº¿ç¨‹æ± åƒæ»¡ï¼› æœåŠ¡å®Œå…¨æ— å“åº”ã€‚  ä¿ç•™ä¸‹å½“å‰ heap dump å’Œ thread stack åï¼Œä¸´æ—¶é‡å¯æœåŠ¡å™¨æ¢å¤æ­£å¸¸ã€‚\n# heap dump $ jmap -dump:format=b,file=dump.hprof [pid] # thread stack jstack [pid] \u0026gt; stack.txt æ¥ä¸‹æ¥ç®€å•è®°å½•ä¸€ä¸‹æ’æŸ¥ç»“æœã€‚ ï¼ˆæ­¤æ–‡ä¸ºå›å¿†æ‰€å†™ï¼Œå½“æ—¶æ’æŸ¥çš„æ€è€ƒç»†èŠ‚å’Œè¿‡ç¨‹å·²çœç•¥ï¼‰\næ’æŸ¥ heap dump ä½¿ç”¨å·¥å…· Eclipse + MAT\nå®‰è£… # å®‰è£… eclipse $ brew cask install eclipse-java # å®‰è£… eclipse MAT $ brew cask install mat # æ˜¯çš„ï¼Œè¿™ä¸ªå°±æ˜¯ eclipse-mat ç›¸å…³è¿æ¥   Eclipse\n  Eclipse MAT\n  ä½¿ç”¨   æŠŠ heap dump æ–‡ä»¶ dump.","title":"ä¸€æ¬¡çº¿ç¨‹æ­»é”æ’æŸ¥è®°å½•"},{"content":"ç¿»è¯‘è‡ª Reactive Streams\nReactive Streams  æ³¨ï¼šReactive Streams ç›´è¯‘ä¸ºå“åº”å¼æµï¼Œè¿™é‡Œä¿ç•™è‹±æ–‡åŸè¯ã€‚\n Reactive Streams æ˜¯ä¸€é¡¹æè®®ï¼Œæ—¨åœ¨ä¸ºå…·æœ‰æ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥å¤„ç†æµæä¾›æ ‡å‡†ã€‚è¿™åŒ…æ‹¬é’ˆå¯¹è¿è¡Œç¯å¢ƒï¼ˆJVM å’Œ JavaScriptï¼‰ä»¥åŠç½‘ç»œåè®®çš„åŠªåŠ›ã€‚\nReactive Streams æ˜¯ä¸ºäº†æä¾›ä¸€ä¸ªæ— é˜»å¡èƒŒå‹å¼‚æ­¥æµå¼å¤„ç†çš„æ ‡å‡†çš„ä¸€ä¸ªæè®®ã€‚\nJDK9 java.util.concurrent.Flow åœ¨ JDK 9 çš„ java.util.concurrent.Flow ä¸­å¯ç”¨çš„æ¥å£ï¼Œåˆ†åˆ«ä¸º 1 ï¼š1 è¯­ä¹‰ä¸Šå„è‡ªå¯¹åº”äº Reactive Streamsã€‚è¿™æ„å‘³ç€å°†ä¼šæœ‰ä¸€ä¸ªè¿ç§»æœŸï¼Œåº“ï¼ˆLibrariesï¼‰å°†é‡‡ç”¨ JDK ä¸­çš„æ–°ç±»å‹ï¼Œä½†æ˜¯ç”±äºåº“çš„å®Œå…¨è¯­ä¹‰ç­‰æ•ˆä»¥åŠ Reactive Streams \u0026lt;-\u0026gt; Flow é€‚é…å™¨åº“å’Œç›´æ¥ä¸ JDK Flow ç±»å‹å…¼å®¹çš„ TCKï¼Œå› æ­¤è¿™ä¸ªè¿ç§»æœŸé¢„è®¡ä¼šå¾ˆçŸ­ã€‚\nå¦‚æœä½ æœ‰å…´è¶£äº†è§£æœ‰å…³ JVM Reactive Streamsï¼Œè¯·é˜…è¯»æ­¤ æ–‡ç« \né—®é¢˜ åœ¨å¼‚æ­¥ç³»ç»Ÿä¸­ï¼Œå¤„ç†æµæ•°æ®ï¼ˆå°¤å…¶æ˜¯æ•°é‡æœªå…ˆç¡®å®šçš„çš„â€œå®æ—¶â€æ•°æ®ï¼‰éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚æœ€çªå‡ºçš„é—®é¢˜æ˜¯ï¼Œéœ€è¦æ§åˆ¶èµ„æºæ¶ˆè€—ï¼Œè¿™æ ·å¿«é€Ÿæ•°æ®æºä¸ä¼šå‹å®æµç›®çš„åœ°ã€‚ä¸ºäº†åœ¨å¹¶è¡Œç½‘ç»œä¸»æœºæˆ–ä¸€å°å¤šæ ¸æœºå™¨ä¸Šå¹¶è¡Œåœ°ä½¿ç”¨è®¡ç®—èµ„æºï¼Œéœ€è¦å¼‚æ­¥ã€‚\nReactive Streams çš„ä¸»è¦ç›®æ ‡æ˜¯ç®¡ç†è·¨å¼‚æ­¥è¾¹ç•Œçš„æµæ•°æ®äº¤æ¢ï¼ˆè€ƒè™‘å°†å…ƒç´ ä¼ é€’åˆ°å¦ä¸€ä¸ªçº¿ç¨‹æˆ–çº¿ç¨‹æ± ï¼‰ï¼ŒåŒæ—¶ç¡®ä¿æ¥æ”¶æ–¹ä¸å¼ºåˆ¶ç¼“å­˜ä»»æ„æ•°é‡çš„æ•°æ®ã€‚æ¢å¥è¯è¯´ï¼ŒèƒŒå‹æ˜¯æ­¤æ¨¡å‹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä½¿åœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡Œè°ƒèŠ‚çš„é˜Ÿåˆ—æ”¶åˆ°é™åˆ¶ã€‚å¦‚æœèƒŒå‹çš„é€šä¿¡æ˜¯åŒæ­¥çš„ï¼Œåˆ™å¼‚æ­¥å¤„ç†çš„å¥½å¤„å°†è¢«æŠµæ¶ˆï¼ˆå¦è¯·çœ‹ Reactive Manifestoï¼‰ï¼Œå› æ­¤å¿…é¡»æ³¨æ„å¯¹ Reactive Streams å®ç°çš„æ‰€æœ‰æ–¹é¢è¿›è¡Œå®Œå…¨æ— é˜»å¡å’Œå¼‚æ­¥è¡Œä¸ºæˆæƒã€‚\næœ¬è¯´æ˜ä¹¦æ—¨åœ¨å…è®¸åˆ›å»ºè®¸å¤šç¬¦åˆè¦æ±‚çš„å®ç°ï¼Œè¿™äº›å®ç°é€šè¿‡éµå®ˆè§„åˆ™å°†èƒ½å¤Ÿå¹³æ»‘åœ°äº’ç›¸æ“ä½œï¼Œå¹¶åœ¨æµåº”ç”¨ç¨‹åºçš„æ•´ä¸ªå¤„ç†å›¾ä¸­ä¿ç•™ä¸Šè¿°å¥½å¤„å’Œç‰¹æ€§ã€‚\nèŒƒå›´ Reactive Streams çš„èŒƒå›´æ˜¯æ‰¾æ¥å£ã€æ–¹æ³•å’Œåè®®çš„æœ€å°é›†ï¼Œè¿™äº›æ¥å£ã€æ–¹æ³•å’Œåè®®å°†æè¿°å®ç°ç›®æ ‡â€”â€”æ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥å¤„ç†æµï¼Œæ‰€éœ€è¦çš„æ“ä½œå’Œå®ä½“ã€‚\nç«¯ç”¨æˆ· DSLsï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰æˆ–è€…åè®®ç»‘å®š APIï¼ˆåº”ç”¨ç¼–ç¨‹æ¥å£ï¼‰æœ‰ç›®çš„åœ°è¢«æ’é™¤åœ¨èŒƒå›´ä¹‹å¤–ï¼Œä»¥é¼“åŠ±å’Œæ”¯æŒå¯èƒ½ä½¿ç”¨ä¸åŒç¼–ç¨‹è¯­è¨€çš„ä¸åŒå®ç°ï¼Œä»¥å°½å¯èƒ½åœ°éµå¾ªå…¶å¹³å°çš„ä¹ æƒ¯ç”¨æ³•ã€‚\næˆ‘ä»¬é¢„è®¡ï¼Œæ¥å—è¿™ä¸ª Reactive Streams è§„èŒƒä»¥åŠå®ƒçš„å®ç°ç»éªŒå°†å…±åŒå¯¼å‘å¹¿æ³›çš„é›†æˆï¼Œä¾‹å¦‚ï¼ŒåŒ…æ‹¬å°†æ¥ JDK ç‰ˆæœ¬ä¸­çš„ Java å¹³å°æ”¯æŒæˆ–è€…åœ¨å°†æ¥çš„ç½‘é¡µæµè§ˆå™¨ä¸­ç½‘ç»œåè®®çš„æ”¯æŒã€‚\nå·¥ä½œç»„ åŸºæœ¬å«ä¹‰ åŸºæœ¬å«ä¹‰å®šä¹‰äº†å¦‚ä½•é€šè¿‡èƒŒå‹æ¥è°ƒèŠ‚æµä¸­å…ƒç´ çš„ä¼ è¾“ã€‚å…ƒç´ çš„ä¼ è¾“æ–¹å¼ï¼Œä¼ è¾“è¿‡ç¨‹ä¸­çš„è¡¨ç°å½¢å¼æˆ–è€…èƒŒå‹çš„ä¿¡å·å‘é€æ–¹å¼å‡ä¸å±äºæœ¬è§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚\nJVM æ¥å£ï¼ˆå·²å®Œæˆï¼‰ å·¥ä½œç»„å°†åŸºæœ¬è¯­ä¹‰åº”ç”¨äºä¸€ç»„ç¼–ç¨‹æ¥å£ï¼Œè¿™äº›ç¼–ç¨‹æ¥å£çš„ä¸»è¦ç›®çš„æ˜¯å…è®¸ä½¿ç”¨å…±äº«å†…å­˜å †åœ¨ JVM å†…çš„å¯¹è±¡å’Œçº¿ç¨‹ä¹‹é—´ä¼ é€’æµï¼Œä»è€Œå®ç°ä¸åŒä¸€è‡´æ€§çš„å®ç°å’Œè¯­è¨€ç»‘å®šçš„äº’æ“ä½œã€‚\nåœ¨ 2019 å¹´ 8 æœˆ 23 æ—¥ï¼Œæˆ‘ä»¬å‘å¸ƒäº†é’ˆå¯¹ JVM çš„ Reactive Streams 1.0.3 ç‰ˆæœ¬ï¼ŒåŒ…å«äº† Java APIï¼Œ ä¸€ä¸ªæ–‡æœ¬ è¯´æ˜, ä¸€ä¸ª TCK å’Œ å®ç°ç¤ºä¾‹.\n1.0.3 çš„æ–°åŠŸèƒ½æ˜¯ä¸» jar ä¸­åŒ…å« JDK 9ï¼ˆé€‚é…å™¨åº“ï¼‰ã€‚Maven Central ä¸Šæä¾›äº†ç›¸åº”çš„ä»£ç åº“ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.reactivestreams\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;reactive-streams\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.reactivestreams\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;reactive-streams-tck\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.reactivestreams\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;reactive-streams-tck-flow\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.reactivestreams\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;reactive-streams-examples\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; è¿™äº›ä»£ç çš„æºç åœ¨ GitHubã€‚è¯·ä½¿ç”¨ GitHub Issues æ¥æä¾›åé¦ˆã€‚\næ‰€æœ‰çš„åº“å’Œè¯´æ˜éƒ½åœ¨ çŸ¥è¯†å…±äº«é›¶ ä¸‹å‘å¸ƒåˆ°äº†å…¬å…±é¢†åŸŸã€‚\nåœ¨ è¿™é‡Œ é˜…è¯»æ›´å¤šæœ‰å…³ Reactive Streams 1.0.3 ç›¸å…³å†…å®¹ã€‚\nå®ç°é¡»çŸ¥ ä¸ºäº†ç€æ‰‹å®ç°æœ€ç»ˆè§„èŒƒï¼Œå»ºè®®å…ˆé˜…è¯» README å’Œè¿™ä¸ª Java API æ–‡æ¡£ï¼Œç„¶åçœ‹ä¸€ä¸‹è¿™ä¸ª è§„èŒƒï¼Œå†çœ‹ä¸€ä¸‹è¿™ä¸ª TCK ä»¥åŠ ç¤ºä¾‹å®ç°ã€‚å¦‚æœä½ å¯¹ä»¥ä¸Šæœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·å…ˆçœ‹ä¸€ä¸‹ å…³é—­çš„é—®é¢˜ï¼Œå¦‚æœå°šæœªè§£å†³ï¼Œè¯·æ‰“å¼€ä¸€ä¸ª æ–°çš„é—®é¢˜ã€‚\nè¿™é¡¹å·¥ä½œæ˜¯åœ¨ reactive-streams-jvm ä»“åº“æ‰§è¡Œçš„ã€‚\nJavaScript æ¥å£ è¿™ä¸ªå·¥ä½œç»„å®šä¹‰äº†ä¸€ç»„æœ€å°çš„å¯¹è±¡å±æ€§ï¼Œç”¨äºè§‚å¯Ÿ JavaScript è¿è¡Œç¯å¢ƒä¸­çš„æµå…ƒç´ ã€‚ç›®çš„æ˜¯æä¾›ä¸€ä¸ªå¯æµ‹è¯•çš„è§„èŒƒï¼Œè¯¥è§„èŒƒå…è®¸ä¸åŒå®ç°åœ¨åŒä¸€ä¸ªè¿è¡Œç¯å¢ƒè¿›è¡Œäº’æ“ä½œã€‚\nè¿™é¡¹å·¥ä½œæ˜¯åœ¨ reactive-streams-js ä»“åº“æ‰§è¡Œçš„ã€‚\nç½‘è·¯åè®® è¯¥å·¥ä½œç»„å®šä¹‰äº†ç”¨äºåœ¨å„ç§ä¼ è¾“ä»‹è´¨ä¸Šä¼ é€’ Reactive Streamsï¼Œå…¶ä¸­æ¶‰åŠåˆ°å…ƒç´ çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚æ­¤ç±»ä¼ è¾“åª’ä»‹ä¾‹å¦‚ TCPï¼ŒUDPï¼ŒHTTP å’Œ WebSocketsã€‚\nè¿™é¡¹å·¥ä½œæ˜¯åœ¨ reactive-streams-io ä»“åº“æ‰§è¡Œçš„ã€‚\n","permalink":"https://lexcao.io/zh/posts/reactive-streams/","summary":"ç¿»è¯‘è‡ª Reactive Streams\nReactive Streams  æ³¨ï¼šReactive Streams ç›´è¯‘ä¸ºå“åº”å¼æµï¼Œè¿™é‡Œä¿ç•™è‹±æ–‡åŸè¯ã€‚\n Reactive Streams æ˜¯ä¸€é¡¹æè®®ï¼Œæ—¨åœ¨ä¸ºå…·æœ‰æ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥å¤„ç†æµæä¾›æ ‡å‡†ã€‚è¿™åŒ…æ‹¬é’ˆå¯¹è¿è¡Œç¯å¢ƒï¼ˆJVM å’Œ JavaScriptï¼‰ä»¥åŠç½‘ç»œåè®®çš„åŠªåŠ›ã€‚\nReactive Streams æ˜¯ä¸ºäº†æä¾›ä¸€ä¸ªæ— é˜»å¡èƒŒå‹å¼‚æ­¥æµå¼å¤„ç†çš„æ ‡å‡†çš„ä¸€ä¸ªæè®®ã€‚\nJDK9 java.util.concurrent.Flow åœ¨ JDK 9 çš„ java.util.concurrent.Flow ä¸­å¯ç”¨çš„æ¥å£ï¼Œåˆ†åˆ«ä¸º 1 ï¼š1 è¯­ä¹‰ä¸Šå„è‡ªå¯¹åº”äº Reactive Streamsã€‚è¿™æ„å‘³ç€å°†ä¼šæœ‰ä¸€ä¸ªè¿ç§»æœŸï¼Œåº“ï¼ˆLibrariesï¼‰å°†é‡‡ç”¨ JDK ä¸­çš„æ–°ç±»å‹ï¼Œä½†æ˜¯ç”±äºåº“çš„å®Œå…¨è¯­ä¹‰ç­‰æ•ˆä»¥åŠ Reactive Streams \u0026lt;-\u0026gt; Flow é€‚é…å™¨åº“å’Œç›´æ¥ä¸ JDK Flow ç±»å‹å…¼å®¹çš„ TCKï¼Œå› æ­¤è¿™ä¸ªè¿ç§»æœŸé¢„è®¡ä¼šå¾ˆçŸ­ã€‚\nå¦‚æœä½ æœ‰å…´è¶£äº†è§£æœ‰å…³ JVM Reactive Streamsï¼Œè¯·é˜…è¯»æ­¤ æ–‡ç« \né—®é¢˜ åœ¨å¼‚æ­¥ç³»ç»Ÿä¸­ï¼Œå¤„ç†æµæ•°æ®ï¼ˆå°¤å…¶æ˜¯æ•°é‡æœªå…ˆç¡®å®šçš„çš„â€œå®æ—¶â€æ•°æ®ï¼‰éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚æœ€çªå‡ºçš„é—®é¢˜æ˜¯ï¼Œéœ€è¦æ§åˆ¶èµ„æºæ¶ˆè€—ï¼Œè¿™æ ·å¿«é€Ÿæ•°æ®æºä¸ä¼šå‹å®æµç›®çš„åœ°ã€‚ä¸ºäº†åœ¨å¹¶è¡Œç½‘ç»œä¸»æœºæˆ–ä¸€å°å¤šæ ¸æœºå™¨ä¸Šå¹¶è¡Œåœ°ä½¿ç”¨è®¡ç®—èµ„æºï¼Œéœ€è¦å¼‚æ­¥ã€‚\nReactive Streams çš„ä¸»è¦ç›®æ ‡æ˜¯ç®¡ç†è·¨å¼‚æ­¥è¾¹ç•Œçš„æµæ•°æ®äº¤æ¢ï¼ˆè€ƒè™‘å°†å…ƒç´ ä¼ é€’åˆ°å¦ä¸€ä¸ªçº¿ç¨‹æˆ–çº¿ç¨‹æ± ï¼‰ï¼ŒåŒæ—¶ç¡®ä¿æ¥æ”¶æ–¹ä¸å¼ºåˆ¶ç¼“å­˜ä»»æ„æ•°é‡çš„æ•°æ®ã€‚æ¢å¥è¯è¯´ï¼ŒèƒŒå‹æ˜¯æ­¤æ¨¡å‹ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä½¿åœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡Œè°ƒèŠ‚çš„é˜Ÿåˆ—æ”¶åˆ°é™åˆ¶ã€‚å¦‚æœèƒŒå‹çš„é€šä¿¡æ˜¯åŒæ­¥çš„ï¼Œåˆ™å¼‚æ­¥å¤„ç†çš„å¥½å¤„å°†è¢«æŠµæ¶ˆï¼ˆå¦è¯·çœ‹ Reactive Manifestoï¼‰ï¼Œå› æ­¤å¿…é¡»æ³¨æ„å¯¹ Reactive Streams å®ç°çš„æ‰€æœ‰æ–¹é¢è¿›è¡Œå®Œå…¨æ— é˜»å¡å’Œå¼‚æ­¥è¡Œä¸ºæˆæƒã€‚\næœ¬è¯´æ˜ä¹¦æ—¨åœ¨å…è®¸åˆ›å»ºè®¸å¤šç¬¦åˆè¦æ±‚çš„å®ç°ï¼Œè¿™äº›å®ç°é€šè¿‡éµå®ˆè§„åˆ™å°†èƒ½å¤Ÿå¹³æ»‘åœ°äº’ç›¸æ“ä½œï¼Œå¹¶åœ¨æµåº”ç”¨ç¨‹åºçš„æ•´ä¸ªå¤„ç†å›¾ä¸­ä¿ç•™ä¸Šè¿°å¥½å¤„å’Œç‰¹æ€§ã€‚\nèŒƒå›´ Reactive Streams çš„èŒƒå›´æ˜¯æ‰¾æ¥å£ã€æ–¹æ³•å’Œåè®®çš„æœ€å°é›†ï¼Œè¿™äº›æ¥å£ã€æ–¹æ³•å’Œåè®®å°†æè¿°å®ç°ç›®æ ‡â€”â€”æ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥å¤„ç†æµï¼Œæ‰€éœ€è¦çš„æ“ä½œå’Œå®ä½“ã€‚\nç«¯ç”¨æˆ· DSLsï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰æˆ–è€…åè®®ç»‘å®š APIï¼ˆåº”ç”¨ç¼–ç¨‹æ¥å£ï¼‰æœ‰ç›®çš„åœ°è¢«æ’é™¤åœ¨èŒƒå›´ä¹‹å¤–ï¼Œä»¥é¼“åŠ±å’Œæ”¯æŒå¯èƒ½ä½¿ç”¨ä¸åŒç¼–ç¨‹è¯­è¨€çš„ä¸åŒå®ç°ï¼Œä»¥å°½å¯èƒ½åœ°éµå¾ªå…¶å¹³å°çš„ä¹ æƒ¯ç”¨æ³•ã€‚\næˆ‘ä»¬é¢„è®¡ï¼Œæ¥å—è¿™ä¸ª Reactive Streams è§„èŒƒä»¥åŠå®ƒçš„å®ç°ç»éªŒå°†å…±åŒå¯¼å‘å¹¿æ³›çš„é›†æˆï¼Œä¾‹å¦‚ï¼ŒåŒ…æ‹¬å°†æ¥ JDK ç‰ˆæœ¬ä¸­çš„ Java å¹³å°æ”¯æŒæˆ–è€…åœ¨å°†æ¥çš„ç½‘é¡µæµè§ˆå™¨ä¸­ç½‘ç»œåè®®çš„æ”¯æŒã€‚","title":"Reactive Streams è§„èŒƒç¿»è¯‘"},{"content":"ç®€ä»‹ æœ€è¿‘æˆ‘åœ¨å¯»æ‰¾ä¸€ä¸ªæ–¹æ³•ç»™è‡ªå·±å–ä¸€ä¸ªè‹±æ–‡åå­—ï¼Œç„¶åæˆ‘å‘ç°è¿™ç¯‡æ–‡ç« ï¼Œå¦‚ä½•é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—ã€‚è¯¥æ–‡ç« åœ¨é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—æå‡ºäº†ä¸€ä¸ªè¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•ï¼Œæˆ‘ç”¨è¯¥æ–¹æ³•åˆ¶ä½œäº†ä¸€ä¸ªåº”ç”¨æ¥å¸®åŠ©é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—ã€‚\nä½ å¯ä»¥åœ¨ è¿™é‡Œ å°è¯•ä¸€ä¸‹ã€‚\næˆ‘ä¼šåœ¨ä¸‹é¢å±•å¼€è®²ä¸€ä¸‹é‚£ç¯‡æ–‡ç« å’Œè¿™ä¸ªåº”ç”¨ã€‚\næ–‡ç« æ‰€è¯´ ä»¥ä¸‹æ˜¯æ–‡ç« åŸæ–‡ã€‚\nDo not try to be creative in picking an English name.\nAvoid:\n  Do not try to pick a fun or cute-sounding name from a movie, television, or video game character Do not pick a name that you think sounds cool or trendy, because Americans will think it sounds stupid Do not pick a name because your friends think it sounds cute, because your friends are not the Americans you have to interact with in the future Do not translate some positive-sounding word in your language into English and make that into your name   Do:\n  Choose a name from the 100 most popular names for your birth year If possible, choose a name that sounds somewhat similar to your real name Do not choose a variation as your official name Do not worry about what a name means   ä»¥ä¸‹æ˜¯æˆ‘çš„ç¿»è¯‘ç‰ˆæœ¬ã€‚\nä¸è¦å°è¯•åœ¨é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åä¸Šå¯Œæœ‰åˆ›é€ åŠ›ã€‚\né¿å…ï¼š\n ä¸è¦ä»ç”µå½±ï¼Œç”µè§†æˆ–è€…æ¸¸æˆé‡Œçš„è§’è‰²å»é€‰æ‹©ä¸€ä¸ªæœ‰è¶£æˆ–å‘éŸ³å¯çˆ±çš„åå­— ä¸è¦é€‰æ‹©ä¸€ä¸ªä½ è®¤ä¸ºå¬èµ·æ¥å¾ˆé…·æˆ–è€…æ–°æ½®çš„ï¼Œå› ä¸ºç¾å›½äººå¯èƒ½è®¤ä¸ºå¾ˆè ¢ ä¸è¦é€‰æ‹©ä¸€ä¸ªåå­—å› ä¸ºä½ æœ‹å‹è®¤ä¸ºå¬èµ·æ¥å¾ˆå¯çˆ±ï¼Œå› ä¸ºä½ çš„æœ‹å‹ä¸æ˜¯å°†æ¥è¦å’Œä½ äº’åŠ¨çš„ç¾å›½äºº ä¸è¦ç›´æ¥ç¿»è¯‘ä¸€äº›ä½ æ¯è¯­å½“ä¸­æ­£é¢çš„è¯æ±‡ä¸ºè‹±è¯­å¹¶æŠŠå®ƒå½“ä½œä½ çš„åå­—  æ¨èï¼š\n ä» ä½ å‡ºç”Ÿé‚£å¹´æœ€æµè¡Œçš„ 100 ä¸ªåå­— é‡Œé¢é€‰æ‹©ä¸€ä¸ª å¦‚æœå¯ä»¥ï¼Œé€‰æ‹©ä¸€ä¸ªå¬èµ·æ¥è·Ÿä½ çœŸå®åå­—æœ‰æŸäº›ç›¸ä¼¼çš„åå­— ä¸è¦é€‰æ‹©ä¸€ä¸ªåå­—çš„å˜ä½“ä½œä¸ºä½ çš„å®˜æ–¹åå­— ä¸è¦æ‹…å¿ƒä¸€ä¸ªåå­—çš„å«ä¹‰  åº”ç”¨æ‰€åš  ä» ä½ å‡ºç”Ÿé‚£å¹´æœ€æµè¡Œçš„ 100 ä¸ªåå­— é‡Œé¢é€‰æ‹©ä¸€ä¸ª\n æˆ‘æ ¹æ®æ–‡ç« çš„å»ºè®®ä» ç¾å›½ç¤¾ä¿å±€å‡ºç”Ÿå©´å„¿åå­—æ•°æ® ä¸‹è½½äº†åŸå§‹æ•°æ®ã€‚\næŠŠå®ƒæ”¾åˆ°äº† GitHub ä¸Šï¼Œå¹¶ä¸”å·²ç»åšäº†ä¸€ä¸ª JSON æ ¼å¼çš„ã€‚\nè¯·åœ¨é˜…è¯»ä»–ä»¬çš„ è¯´æ˜ ä¹‹åå…è´¹ä½¿ç”¨ï¼ŒEnjoyï¼\næˆ‘æ˜¯æ€ä¹ˆé€‰æ‹©çš„  ä»æˆ‘çš„ä¸­æ–‡åä¸­æ‰¾çµæ„Ÿï¼ŒLixin Caoï¼Œæˆ‘æƒ³è¦ä¸€ä¸ªä»¥ L å¼€å¤´çš„è‹±æ–‡åã€‚ æ‰¾åˆ°æˆ‘å‡ºç”Ÿå¹´çš„è‹±æ–‡åå­—ï¼Œé€‰å‡ºä¸€äº›æˆ‘å–œæ¬¢çš„ã€‚  Levi Alex Lucas Liam   å¸¦ä¸Šæˆ‘çš„å§“æ°ï¼Œæ¯”å¦‚ LeviCaoï¼Œå»ç¤¾äº¤ç½‘ç«™çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰è¢«å ç”¨ã€‚  Levi ï¼ˆåœ£ç»ç›¸å…³çš„ï¼‰ Alex ï¼ˆå·²ç»è¢«äººå ç”¨ï¼‰ Lucas ï¼ˆå¤ªæµè¡Œï¼‰ Liam ï¼ˆå¤ªæµè¡Œï¼‰   åœ¨ nameberry å’Œ behindthename æœç´¢åå­—çš„å«ä¹‰å’Œä¸€äº›å˜ä½“ã€‚ æˆ‘æœ€å–œæ¬¢ Alexï¼Œç„¶åæˆ‘æœ€åé€‰æ‹©äº† Lex ä½œä¸ºæˆ‘çš„è‹±æ–‡åå­—ã€‚  å‚è€ƒé“¾æ¥  è‹±æ–‡åé€‰æ‹©å™¨ è‹±æ–‡åé€‰æ‹©å™¨ æºç  ç¾å›½ç¤¾ä¿å±€è‹±æ–‡åæ•°æ® GitHub å¦‚ä½•é€‰æ‹©ä¸€ä¸ªè‹±æ–‡å ç¾å›½ç¤¾ä¿å±€å‡ºç”Ÿå©´å„¿åå­— ç¾å›½ç¤¾ä¿å±€å‡ºç”Ÿå©´å„¿åå­—æ•°æ®  ","permalink":"https://lexcao.io/zh/posts/choose-english-name/","summary":"ç®€ä»‹ æœ€è¿‘æˆ‘åœ¨å¯»æ‰¾ä¸€ä¸ªæ–¹æ³•ç»™è‡ªå·±å–ä¸€ä¸ªè‹±æ–‡åå­—ï¼Œç„¶åæˆ‘å‘ç°è¿™ç¯‡æ–‡ç« ï¼Œå¦‚ä½•é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—ã€‚è¯¥æ–‡ç« åœ¨é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—æå‡ºäº†ä¸€ä¸ªè¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•ï¼Œæˆ‘ç”¨è¯¥æ–¹æ³•åˆ¶ä½œäº†ä¸€ä¸ªåº”ç”¨æ¥å¸®åŠ©é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—ã€‚\nä½ å¯ä»¥åœ¨ è¿™é‡Œ å°è¯•ä¸€ä¸‹ã€‚\næˆ‘ä¼šåœ¨ä¸‹é¢å±•å¼€è®²ä¸€ä¸‹é‚£ç¯‡æ–‡ç« å’Œè¿™ä¸ªåº”ç”¨ã€‚\næ–‡ç« æ‰€è¯´ ä»¥ä¸‹æ˜¯æ–‡ç« åŸæ–‡ã€‚\nDo not try to be creative in picking an English name.\nAvoid:\n  Do not try to pick a fun or cute-sounding name from a movie, television, or video game character Do not pick a name that you think sounds cool or trendy, because Americans will think it sounds stupid Do not pick a name because your friends think it sounds cute, because your friends are not the Americans you have to interact with in the future Do not translate some positive-sounding word in your language into English and make that into your name   Do:","title":"é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åå­—"},{"content":"é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ¯”è¾ƒéš¾ï¼Œå°¤å…¶æ˜¯å½“ä½ ç¬¬ä¸€æ¬¡æƒ³è¦æ­å»ºä¸€ä¸ªåšå®¢ç½‘ç«™çš„æ—¶å€™ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ­å»ºä¸€ä¸ªåšå®¢å¹¶ä¸”æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å°è¯•æ‰€æœ‰å¸¸è§çš„ç”Ÿæˆå™¨ï¼Œæˆ‘é€‰æ‹©äº† Jekyll ä½œä¸ºç¬¬ä¸€æ¬¡æ­å»ºä½¿ç”¨çš„ç”Ÿæˆå™¨ï¼Œå°½ç®¡å®ƒå¯èƒ½ä¸æ˜¯æœ€å¥½çš„ä¸€ä¸ªã€‚æˆ‘å‡†å¤‡ä»¥åå†å°è¯•å…¶ä»–ç”Ÿæˆå™¨ã€‚\nè¿™æ˜¯æˆ‘ä» Google æ‰¾åˆ°çš„ä¸€äº›ç®€è¦çš„æè¿°ï¼Œå¸Œæœ›å®ƒèƒ½å¯¹ä½ é€‰æ‹©ä»€ä¹ˆç”Ÿæˆå™¨å¼€å§‹æ­å»ºç½‘ç«™æœ‰å¸®åŠ©ã€‚\næˆ‘ä» GitHub é€‰æ‹©äº†ä»¥ä¸‹ä¸‰ä¸ªé™æ€åšå®¢ç”Ÿæˆå™¨è¿›è¡Œæ¯”è¾ƒ\n Jekyll Hugo Hexo  ä»€ä¹ˆæ˜¯é™æ€ç½‘ç«™ç”Ÿæˆå™¨  HTML æ–‡ä»¶ï¼› æ²¡æœ‰æœåŠ¡ç«¯å¤„ç†æˆ–è€…æ•°æ®åº“äº¤äº’ï¼› æ¯”åŠ¨æ€ç½‘ç«™æ›´å®‰å…¨ï¼› åˆ©äºä½¿ç”¨ CDN è¿›è¡Œæ‰©å±•ï¼› ç¼“å­˜ä¼šå¸¦æ¥æ¯”åŠ¨æ€ç½‘é¡µæ›´é«˜çš„æ•ˆç‡ï¼› è¯·æ±‚è¶…å¿«é€Ÿã€‚  Jekyll  ä½¿ç”¨è¯­è¨€ Rubyï¼› GitHub æ”¯æŒï¼› ä½¿ç”¨ GitHub Pages å…è´¹éƒ¨ç½²ã€‚  ä¼˜åŠ¿  å…è´¹ä¸”å¼€æºï¼› RubyGems æ”¯æŒæ„å»ºä¸»é¢˜ä¸º gems æ–¹ä¾¿åˆ†å‘ï¼› ç®€å•ä¾¿æ·ä½¿ç”¨ï¼› å¼ºå¤§çš„ GitHub Pages æ”¯æŒï¼› å¼€ç®±å³ç”¨çš„åˆé€‚çš„é»˜è®¤æç®€ä¸»é¢˜ã€‚  åŠ£åŠ¿ å½“ç½‘ç«™å†…å®¹ä¸æ–­å¢åŠ åï¼Œæ„å»ºé€Ÿåº¦ä¼šæ˜æ˜¾å˜æ…¢ã€‚\nåŠŸèƒ½  Liquid æ¨¡ç‰ˆå¼•æ“ï¼› åŸºäº Gem ä¸»é¢˜ï¼› Markdown å’Œ YAML ç±»å‹æ”¯æŒï¼› Sass é¢„å¤„ç† CSS æ”¯æŒï¼› å®˜æ–¹æ’ä»¶æ”¯æŒ CoffeeScriptã€‚  Hugo  ä½¿ç”¨è¯­è¨€ Go.  ä¼˜åŠ¿  å…è´¹å¼€æºï¼› é€Ÿåº¦éå¸¸å¿«ï¼Œå¯¹æ„å»ºé€Ÿåº¦åšäº†ä¼˜åŒ–ï¼› å†…ç½®æ”¯æŒå¾ˆå¤šåŠŸèƒ½ï¼š  åŠ¨æ€ API è¯·æ±‚çš„å†…å®¹ï¼› æ— é™åˆ¶å†…å®¹ç±»å‹ï¼› shortcakesï¼Œ ä¸€ä¸ªçµæ´»çš„ Markdown æ›¿ä»£ï¼› å›½é™…åŒ–ï¼› åˆ«åé‡å®šå‘ï¼› åˆ†é¡µã€‚   é¢„åˆ¶çš„ Go æ¨¡ç‰ˆå’Œæ¨¡å¼ï¼› æ— éœ€ä¾èµ–ï¼ˆä¸ç”¨å®‰è£… Goï¼Œå› ä¸ºå®ƒæ˜¯ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ï¼‰ï¼› åŠŸèƒ½å¼ºå¤§çš„å†…å®¹æ¨¡å‹ã€‚  åŠ£åŠ¿  ä¸»é¢˜ä½¿ç”¨ Go æ¨¡ç‰ˆï¼Œæ‰€ä»¥éœ€è¦ç†Ÿæ‚‰ Goï¼› æ²¡æœ‰å†…ç½®é»˜è®¤ä¸»é¢˜ï¼› ç¼ºå°‘æ‰©å±•æ€§å’Œæ’ä»¶ï¼ˆå› ä¸º Go æ˜¯ç¼–è¯‘å‹è¯­è¨€ï¼‰ã€‚  åŠŸèƒ½  Go æ¨¡ç‰ˆï¼› å›½é™…åŒ–; æ”¯æŒåŠ¨æ€ APIã€‚  Hexo  ä½¿ç”¨ Node.js.  ä¼˜åŠ¿  ç›¸å½“å¿«é€Ÿï¼› åœ¨ GitHub Pages éƒ¨ç½²ç®€å•ï¼› ä¸­æ–‡æ”¯æŒï¼ˆå¯èƒ½æ˜¯åŠ£åŠ¿å¯¹äºéä¸­æ–‡ç”¨æˆ·ï¼‰ï¼› ä¸­æ–‡ç¤¾åŒºã€‚  åŠ£åŠ¿  æ²¡æœ‰è‹±æ–‡ã€‚  åŠŸèƒ½  EJS æ¨¡ç‰ˆå¼•æ“; æ”¯æŒ ä¸­æ–‡; å¯¹äº HTML + CSS + Javascript éå¸¸å‹å¥½ã€‚  æˆ‘æ­£åœ¨ä½¿ç”¨ Jekyll\nå–œæ¬¢  éå¸¸å¤šçš„å…è´¹ä¸»é¢˜å’Œæ’ä»¶ï¼› æœ‰å¾ˆå¤šæ•™ç¨‹å¯¹äºåˆå­¦è€…æ¥è¯´ï¼› ä¸éœ€è¦ä»»ä½•æŠ€èƒ½å°±èƒ½éƒ¨ç½²åˆ° GitHub Pages ä¸Šã€‚  ä¸å–œæ¬¢  å¯¹äºå¤§å¤šæ•°æ’ä»¶æ²¡æœ‰è¢« GitHub Pages æ”¯æŒï¼› ä¸æ”¯æŒå›½é™…åŒ–ã€‚  é¡ºä¾¿ä¸€æï¼Œç”±äºç›®å‰æ–‡ç« æ•°é‡æ¯”è¾ƒå°‘ï¼Œæ„å»ºé€Ÿåº¦ä¸åœ¨æˆ‘çš„è€ƒè™‘èŒƒå›´ä¹‹å†…ï¼Œå°†æ¥å¦‚æœç”¨ Jekyll æ˜æ˜¾æ„Ÿåˆ°æ„å»ºå˜æ…¢çš„æ—¶å€™ï¼Œæˆ‘å°±ä¼šå°è¯•å…¶ä»–çš„ç”Ÿæˆå™¨ã€‚\nä»¥ä¸Šä¸‰ä¸ªç”Ÿæˆå™¨çš„æ„å»ºé€Ÿåº¦æ’åï¼šHugo \u0026gt; Hexo \u0026gt; jekyllã€‚\nä¸‹ä¸€ä¸ªå°†æ¥è¦å°è¯•çš„ç”Ÿæˆå™¨åº”è¯¥æ˜¯ Hugoï¼Œåˆ°æ—¶å€™æˆ‘ä¼šæ›´æ–°è¿™ç¯‡æ–‡ç« ï¼Œå†™ä¸€äº›å®é™…çš„ä½¿ç”¨æ„Ÿå—ã€‚\nå‚è€ƒé“¾æ¥  å¦‚ä½•é€‰æ‹©æ­£ç¡®çš„é™æ€ç”Ÿæˆå™¨ Jekyll vs. Hugo vs. Hexo é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ¯”è¾ƒ  ","permalink":"https://lexcao.io/zh/posts/jekyll-hugo-hexo/","summary":"é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ¯”è¾ƒéš¾ï¼Œå°¤å…¶æ˜¯å½“ä½ ç¬¬ä¸€æ¬¡æƒ³è¦æ­å»ºä¸€ä¸ªåšå®¢ç½‘ç«™çš„æ—¶å€™ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ­å»ºä¸€ä¸ªåšå®¢å¹¶ä¸”æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å°è¯•æ‰€æœ‰å¸¸è§çš„ç”Ÿæˆå™¨ï¼Œæˆ‘é€‰æ‹©äº† Jekyll ä½œä¸ºç¬¬ä¸€æ¬¡æ­å»ºä½¿ç”¨çš„ç”Ÿæˆå™¨ï¼Œå°½ç®¡å®ƒå¯èƒ½ä¸æ˜¯æœ€å¥½çš„ä¸€ä¸ªã€‚æˆ‘å‡†å¤‡ä»¥åå†å°è¯•å…¶ä»–ç”Ÿæˆå™¨ã€‚\nè¿™æ˜¯æˆ‘ä» Google æ‰¾åˆ°çš„ä¸€äº›ç®€è¦çš„æè¿°ï¼Œå¸Œæœ›å®ƒèƒ½å¯¹ä½ é€‰æ‹©ä»€ä¹ˆç”Ÿæˆå™¨å¼€å§‹æ­å»ºç½‘ç«™æœ‰å¸®åŠ©ã€‚\næˆ‘ä» GitHub é€‰æ‹©äº†ä»¥ä¸‹ä¸‰ä¸ªé™æ€åšå®¢ç”Ÿæˆå™¨è¿›è¡Œæ¯”è¾ƒ\n Jekyll Hugo Hexo  ä»€ä¹ˆæ˜¯é™æ€ç½‘ç«™ç”Ÿæˆå™¨  HTML æ–‡ä»¶ï¼› æ²¡æœ‰æœåŠ¡ç«¯å¤„ç†æˆ–è€…æ•°æ®åº“äº¤äº’ï¼› æ¯”åŠ¨æ€ç½‘ç«™æ›´å®‰å…¨ï¼› åˆ©äºä½¿ç”¨ CDN è¿›è¡Œæ‰©å±•ï¼› ç¼“å­˜ä¼šå¸¦æ¥æ¯”åŠ¨æ€ç½‘é¡µæ›´é«˜çš„æ•ˆç‡ï¼› è¯·æ±‚è¶…å¿«é€Ÿã€‚  Jekyll  ä½¿ç”¨è¯­è¨€ Rubyï¼› GitHub æ”¯æŒï¼› ä½¿ç”¨ GitHub Pages å…è´¹éƒ¨ç½²ã€‚  ä¼˜åŠ¿  å…è´¹ä¸”å¼€æºï¼› RubyGems æ”¯æŒæ„å»ºä¸»é¢˜ä¸º gems æ–¹ä¾¿åˆ†å‘ï¼› ç®€å•ä¾¿æ·ä½¿ç”¨ï¼› å¼ºå¤§çš„ GitHub Pages æ”¯æŒï¼› å¼€ç®±å³ç”¨çš„åˆé€‚çš„é»˜è®¤æç®€ä¸»é¢˜ã€‚  åŠ£åŠ¿ å½“ç½‘ç«™å†…å®¹ä¸æ–­å¢åŠ åï¼Œæ„å»ºé€Ÿåº¦ä¼šæ˜æ˜¾å˜æ…¢ã€‚\nåŠŸèƒ½  Liquid æ¨¡ç‰ˆå¼•æ“ï¼› åŸºäº Gem ä¸»é¢˜ï¼› Markdown å’Œ YAML ç±»å‹æ”¯æŒï¼› Sass é¢„å¤„ç† CSS æ”¯æŒï¼› å®˜æ–¹æ’ä»¶æ”¯æŒ CoffeeScriptã€‚  Hugo  ä½¿ç”¨è¯­è¨€ Go.","title":"Jekyll / Hugo / Hexo æ¯”è¾ƒ"},{"content":"å®ç°ç›®æ ‡  æ”¯æŒå¤šè¯­è¨€ï¼Œè‹±æ–‡ä¸ºä¸»ï¼Œä¸­æ–‡ä¸ºè¾…ï¼› å½“è®¿é—® / æ ¹ç›®å½•ä¸‹é¡µé¢ï¼Œæ¯”å¦‚ /about.html /posts/hello-world æ˜¾ç¤ºè‹±æ–‡é¡µé¢ï¼› å½“è®¿é—® /zh/ ç›®å½•ä¸‹é¡µé¢ï¼Œæ¯”å¦‚ /zh/about.html /zh/posts/hello-world æ˜¾ç¤ºä¸­æ–‡é¡µé¢ï¼› å½“è®¿é—® ../hello-world æ–‡ç« æ—¶ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥è·³è½¬åˆ°å¯¹åº”è¯­è¨€é¡µé¢ï¼› archive å’Œ index é¡µé¢ä¸­ä»…æ˜¾ç¤ºå‡ºå½“å‰è¯­è¨€é¡µé¢ã€‚  ç›¸å…³ç¼ºé™·  404 é¡µé¢æ— æ³•é…ç½®ï¼Œåªèƒ½åœ¨ 404.html é¡µé¢å†™ä¸Šä¸¤ç§è¯­è¨€ï¼› æ”¯æŒå¤šè¯­è¨€æ–‡ç« çš„åˆ†é¡µæ’ä»¶ jekyll-paginate-v2 æ²¡åœ¨ GitHub Pages æ”¯æŒçš„æ’ä»¶ç™½åå•å†…ï¼Œç›®å‰æœ¬åšå®¢é¦–é¡µä¸æ”¯æŒåˆ†é¡µã€‚å¤šè¯­è¨€åˆ†é¡µè¯¦è§ä¸‹æ–‡ï¼› å¤šè¯­è¨€æ—¶é—´è¡¨ç¤ºæœ‰ç‚¹éº»çƒ¦ï¼Œéœ€è¦åšä¸€äº›å­—ç¬¦ä¸²å¤„ç†å·¥ä½œï¼Œèƒ½å®ç°ä½†æ˜¯ä¸å¤ªä¼˜é›…ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ Jekyll-Date-Formattingã€‚  å¼€å§‹é…ç½® æœ€åˆï¼Œæˆ‘æœç´¢åˆ° i18n æ’ä»¶ Jekyll-Multiple-Languages-Pluginã€‚\nè¯¥ä»“åº“çš„ Star æ•°æ˜¯å¤šè¯­è¨€æ’ä»¶ä¸­æœ€å¤šçš„ï¼ŒåŒæ—¶é‡Œé¢ä¹Ÿåˆ—å‡ºäº†ç›¸å…³å…¶ä»–å¤šè¯­è¨€æ’ä»¶ï¼Œå·²ç»æ¯”è¾ƒå®Œå–„ï¼Œä¸æƒ³æŠ˜è…¾çš„å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚\nç›®å‰æˆ‘ä¸ºäº†ç®€å•å’Œå¯å®šåˆ¶åŒ–ï¼ŒåŒæ—¶çœç•¥æ‰æ’ä»¶ä¸­ä¸å¿…è¦çš„åŠŸèƒ½ï¼Œé€‰æ‹©ä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™æ¥å®ç°å¤šè¯­è¨€åŠŸèƒ½ã€‚\n1. å•ä¸ªåšæ–‡é…ç½® æ¯ä¸€ç¯‡æ–‡ç« å’Œé¡µé¢éœ€è¦å®šä¹‰ä¸¤ä¸ªå±æ€§ï¼š\n uid æ ‡ç¤ºæ–‡ç« å”¯ä¸€ï¼Œä¸€ç¯‡æ–‡ç« çš„ä¸­æ–‡ç‰ˆæœ¬å’Œè‹±æ–‡ç‰ˆæœ¬ uid ç›¸åŒï¼›  æ³¨æ„ï¼šuid å¯ä»¥è®¾ç½®ä¸ºä»»æ„å‘½åï¼Œæ¯”å¦‚ document_id ã€‚   locale æ ‡ç¤ºæ–‡ç« è¯­è¨€ï¼Œä¸€ç¯‡æ–‡ç« è¢«æ¸²æŸ“åä½œä¸ºå“ªç§è¯­è¨€å±•ç¤ºã€‚  æ‰€ä»¥æ¯ç¯‡æ–‡ç« çš„ Front Matter æ–°å¢å¦‚ä¸‹è®¾ç½®\n--- uid: hello-world locale: zh --- 2. å¯¹äºæ–‡ç«  posts æ¯ç¯‡æ–‡ç« éƒ½éœ€è¦åœ¨ Front Matter ä¸­å†™ä¸Š locale é‡å¤å¤šä½™ã€‚ä¸è¦é‡å¤è‡ªå·±ã€‚æˆ‘å‡†å¤‡ä½¿ç”¨ä¸åŒæ–‡ä»¶å¤¹æ¥åŒºåˆ†ä¸åŒè¯­è¨€çš„æ–‡ç« ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶è®¾ç½® locale çš„é»˜è®¤å€¼ã€‚\nåœ¨ _posts ç›®å½•ä¸‹åˆ›å»º zh æ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾ä¸­æ–‡æ–‡ç« ã€‚å½“è®¿é—® /zh/posts/xxx æ—¶å³å±•ç¤ºä¸­æ–‡é¡µé¢ã€‚\nï¼ˆå½“ç„¶ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸åŒçš„ç›®å½•ï¼Œå‚ç…§ä»¥ä¸‹é…ç½®è¿›è¡Œè®¾ç½®ä¸åŒçš„ path ï¼‰\ndefaults: - values: #1  locale: en - scope: #2 path: _posts/zh/** type: posts values: locale: zh  #1 æœªæŒ‡å®š scope å…¨å±€é»˜è®¤ï¼šæ‰€æœ‰æ–‡ç«  posts å’Œé¡µé¢ pages é»˜è®¤ enï¼› #2 æŒ‡å®š scope è·¯å¾„ _posts/zh/** ä¸‹ posts ç±»å‹ï¼šzhã€‚  3. å¯¹äºé¡µé¢ä¸­é€šç”¨çš„å­—ç¬¦ä¸² å¯¼èˆªæ ä¸­ å½’æ¡£ å…³äº æˆ–è€… ä¸‹ä¸€é¡µ ç­‰è¿™æ ·çš„é€šç”¨å­—ç¬¦ä¸²ã€‚\nä½¿ç”¨ site.data åŠŸèƒ½æ¥å®ç°ï¼Œåœ¨ /_data ç›®å½•ä¸‹åˆ›å»º locales æ–‡ä»¶å¤¹ï¼Œå¹¶åˆ†åˆ«åˆ›å»º en.yml å’Œ zh.yml ç”¨äºå­˜æ”¾è‹±æ–‡å’Œä¸­æ–‡å­—ç¬¦ä¸²ã€‚\n# /_data/locales/en.yml æ–‡ä»¶ä¸­ menu: about: About archive: Archive # /_data/locales/zh.yml æ–‡ä»¶ä¸­ menu: about: å…³äº archive: å½’æ¡£ é…ç½®å¥½è¿™äº›å­—ç¬¦ä¸²åï¼Œåœ¨éœ€è¦æ›¿æ¢æ–‡å­—çš„åœ°æ–¹ä½¿ç”¨\n\u0026lt;nav class=\u0026#34;menu-content\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;/about\u0026#34;\u0026gt;{{ site.data.locales[page.locale].menu.about }}\u0026lt;/a\u0026gt; \u0026lt;/nav\u0026gt; 4. å¯¹äºé¡µé¢ pages ä¸€äº›é€šç”¨é¡µé¢ï¼šarchive.html about.html ç­‰ pages ç±»å‹ã€‚\nå•ç‹¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ _zhï¼Œå¹¶ä½œä¸º collection æ¥é…ç½®\ncollections: zh: output: true åœ¨ _zh æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå¯¹åº”é¡µé¢\n /menu/archive.html /menu/about.html  5. è¯­è¨€é€‰æ‹©å™¨ ç”¨äºåœ¨ä¸åŒè¯­è¨€çš„æ–‡ç« æˆ–é¡µé¢ä¸­æ ¹æ® locale è¿›è¡Œåˆ‡æ¢ã€‚\nåœ¨ _includes æ–‡ä»¶å¤¹ä¸‹æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶ language-selector.htmlã€‚\néå† postsã€ pages å’Œ collections æ‰¾åˆ°ç›¸åº”çš„è¯­è¨€é¡µé¢\n{% if page.uid %} \u0026lt;!-- #1 --\u0026gt; \u0026lt;div class=\u0026#34;language-selector\u0026#34;\u0026gt; {% assign postsOrPages = site.posts \u0026lt;!-- #2 --\u0026gt; | concat: site.pages | concat: site.zh | where: \u0026#34;uid\u0026#34;, page.uid | sort: \u0026#34;locale\u0026#34; %} {% for item in postsOrPages %} {% unless item.url contains \u0026#39;/page/\u0026#39; %} \u0026lt;!-- #3 --\u0026gt; \u0026lt;a href=\u0026#34;{{ item.url }}\u0026#34; class=\u0026#34;{{ item.locale }}\u0026#34;\u0026gt; {{ site.data.locales[item.locale].name }} \u0026lt;!-- #4 --\u0026gt; \u0026lt;/a\u0026gt; {% endunless %} {% endfor %} \u0026lt;/div\u0026gt; {% endif %}  #1 ä»…åœ¨æœ‰ uid çš„é¡µé¢æ˜¾ç¤ºè¯­è¨€é€‰æ‹©å™¨ #2 æ‹¼æ¥ posts pages zh æ•°ç»„ï¼Œæ‰¾åˆ° uid å¯¹åº”çš„é¡µé¢ï¼Œæ ¹æ® local æ’åº #3 è¿‡æ»¤æ‰ /pages/ ç›®å½•ä¸‹é¡µé¢ #4 æ‹¿åˆ° locale å¯¹åº”çš„è¯­è¨€æ–‡å­—ï¼Œå¦‚ EN ä¸­  6. å½’æ¡£é¡µé¢ éœ€è¦æ‰‹åŠ¨å¤šè™‘æ‰éæœ¬è¯­è¨€é¡µé¢çš„æ–‡ç« ã€‚\npost.next æä¾›ä¾¿æ·è·å–ä¸‹ä¸€ç¯‡æ–‡ç« çš„æ–¹æ³•ï¼Œä½†æ˜¯åœ¨å¤šè¯­è¨€æ–‡ç« ä¸­æ— æ³•ä¿è¯ locale çš„ä¸€è‡´æ€§ï¼Œéœ€è¦ä½œå‡ºå¦‚ä¸‹ä¿®æ”¹\n\u0026lt;!-- archive.html --\u0026gt; \u0026lt;!-- ä½¿ç”¨ posts çš„ä¸‹æ ‡ï¼Œè€Œä¸ç”¨ post.next --\u0026gt; {% assign posts = site.posts | where: \u0026#34;locale\u0026#34;, page.locale %} {% for index in (0..posts.size) limit: posts.size %} {% assign post = posts[index] %} {% assign prevIndex = index | minus: 1 %} {% assign prev = posts[prevIndex] %} {% capture year %}{{ post.date | date: \u0026#39;%Y\u0026#39; }}{% endcapture %} {% capture prevYear %}{{ prev.date | date: \u0026#39;%Y\u0026#39; }}{% endcapture %} {% if year != prevYear or index == 0 %} \u0026lt;h3\u0026gt;{{ year }}\u0026lt;/h3\u0026gt; {% endif %} \u0026lt;li itemscope\u0026gt; \u0026lt;a href=\u0026#34;{{ post.url }}\u0026#34;\u0026gt;{{ post.title }}\u0026lt;/a\u0026gt; \u0026lt;p class=\u0026#34;post-date\u0026#34;\u0026gt;\u0026lt;span\u0026gt;{{ post.date | date: \u0026#34;%B %-d\u0026#34; }}\u0026lt;/span\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;/li\u0026gt; {% endfor %} æ ¸å¿ƒæ€æƒ³ï¼šå…ˆæ ¹æ® locale è¿‡æ»¤ï¼Œéå†çš„æ—¶å€™ä½¿ç”¨ä¸‹æ ‡è€Œä¸æ˜¯ post.nextã€‚\n7. å¤šè¯­è¨€ SEO åœ¨ _includes æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»ºä¸€ä¸ªæ–°é¡µé¢ language-seo.htmlã€‚\né€šè¿‡ hreflang æŒ‡ç¤ºå¯¹åº”çš„è¯­è¨€\n{% assign posts = site.posts | where:\u0026#34;uid\u0026#34;, page.uid | sort: \u0026#39;locale\u0026#39; %} {% for post in posts %} \u0026lt;link rel=\u0026#34;alternate\u0026#34; hreflang=\u0026#34;{{ post.locale }}\u0026#34; href=\u0026#34;{{ post.url }}\u0026#34; /\u0026gt; {% endfor %} å¹¶ä¸”åœ¨ head.html å¼•ç”¨\n\u0026lt;!-- Language SEO --\u0026gt; {% include language-seo.html %} æœ€å æˆ‘çœç•¥äº†ä¸€äº›ä¸é‡è¦çš„å¸¸è§„é…ç½®ï¼Œæºç è¯·çœ‹ GitHub: lexcao.github.io\nç›¸å…³å‚è€ƒé“¾æ¥  Jekyll Multiple Language Plugin Making Jekyll Multilingual Multi-Languages-with-Jekyll Deploy A Multi-Language Jekyll Site jekyll-paginate-v2  å¦ä¸€ä»¶äº‹ å¤šè¯­è¨€æ”¯æŒåˆ†é¡µ æ—§çš„åˆ†é¡µæ’ä»¶ jekyll-pagination-v1 æ— æ³•æ ¹æ®ç­›é€‰æ¡ä»¶è¿‡æ»¤å·²ç»ä¸å†é€‚åˆï¼Œä¸èƒ½åœ¨å¯¹åº”çš„è¯­è¨€é¡µé¢æ˜¾ç¤ºå¯¹åº”çš„è¯­è¨€æ–‡ç« åˆ—è¡¨ã€‚\nå¦‚æœæƒ³åœ¨å¤šè¯­è¨€ä¸‹æ”¯æŒåˆ†é¡µï¼Œå¯ä»¥ä½¿ç”¨ jekyll-pagination-v2ã€‚æˆ‘ä¸Šé¢æåˆ°è¿‡ Github Pages æ’ä»¶ ç™½åå•åˆ—è¡¨ ä¸æ”¯æŒè¯¥æ’ä»¶ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å°±éœ€è¦ æ‰‹åŠ¨å®ç°éƒ¨ç½²ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•é…ç½®ä½¿ç”¨ jekyll-pagination-v2\nGemfile å®‰è£… $ gem \u0026#39;jekyll-paginate-v2\u0026#39; _config.yml é…ç½® æ³¨æ„ï¼šv2 å’Œ v1 çš„é…ç½®ä¸å…¼å®¹ï¼Œéœ€è¦æŒ‰ç…§å¦‚ä¸‹é…ç½®åšç›¸åº”ä¿®æ”¹\nplugins: - jekyll-paginate-v2 pagination: enabled: true per_page: 5 permalink: /page/:num/ sort_reverse: true pages é¡µé¢é…ç½® é¦–é¡µ index.html è¿›è¡Œåˆ†é¡µï¼Œéœ€è¦æ·»åŠ å¦‚ä¸‹é…ç½®\n# /index.html --- pagination: enabled: true # æ˜¯çš„ï¼Œè¿™é‡Œè¿˜éœ€è¦å†æ¬¡å¼€å¯ä¸€æ¬¡ locale: en --- pagination.locale æ­¤å¤„ç”¨æ¥é…ç½®åˆ†é¡µç­›é€‰æ¡ä»¶ï¼Œæ ¹æ®é¡µé¢çš„ locale å­—æ®µè¿›è¡Œè¿‡æ»¤ã€‚è¿™ä¹Ÿæ˜¯æˆ‘åœ¨ Front Matter ç”¨ locale å­—æ®µæ¥æ ‡å¿—è¯­è¨€çš„åŸå› ï¼Œå¤ç”¨ã€‚\nå¯¹åº”çš„ï¼Œåœ¨ _zh æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»ºä¸­æ–‡é¦–é¡µ index.htmlã€‚\n# /_zh/index.html --- permalink: /zh/ # æ­¤å¤„æ˜¯ä¸ºäº†è®©é¦–é¡µä¸æ˜¾ç¤º .html åç¼€ pagination: enabled: true locale: zh --- æ³¨æ„ï¼šæˆ‘åœ¨è¿™é‡Œé…ç½®çš„æ—¶å€™ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘æŠŠ index.html æ”¾åˆ° _zh æ–‡ä»¶å¤¹åï¼Œåˆ†é¡µ locale ç­›é€‰ä¸èµ·ä½œç”¨ï¼Œç›®å‰è¿˜æ²¡è§£å†³ã€‚\nä¸´æ—¶è§£å†³æ–¹æ¡ˆæ˜¯å°† zh/index.html æ”¾åœ¨æ ¹ç›®å½•ï¼Œå¹¶æ”¹åä¸º index_zh.htmlã€‚\nåˆ†é¡µä½¿ç”¨ ä½¿ç”¨æ²¡æœ‰å˜åŒ–ï¼Œå’Œ v1 ä¸€æ ·çš„ä½¿ç”¨æ–¹å¼ï¼Œè¯¦ç»†è¯·çœ‹ Pagination\nç›¸å…³å‚è€ƒé“¾æ¥  Jekyll-Paginate-v2 Jekyll-Paginate-V2 Filter Locales  ","permalink":"https://lexcao.io/zh/posts/jekyll-multi-language-without-plugin/","summary":"å®ç°ç›®æ ‡  æ”¯æŒå¤šè¯­è¨€ï¼Œè‹±æ–‡ä¸ºä¸»ï¼Œä¸­æ–‡ä¸ºè¾…ï¼› å½“è®¿é—® / æ ¹ç›®å½•ä¸‹é¡µé¢ï¼Œæ¯”å¦‚ /about.html /posts/hello-world æ˜¾ç¤ºè‹±æ–‡é¡µé¢ï¼› å½“è®¿é—® /zh/ ç›®å½•ä¸‹é¡µé¢ï¼Œæ¯”å¦‚ /zh/about.html /zh/posts/hello-world æ˜¾ç¤ºä¸­æ–‡é¡µé¢ï¼› å½“è®¿é—® ../hello-world æ–‡ç« æ—¶ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥è·³è½¬åˆ°å¯¹åº”è¯­è¨€é¡µé¢ï¼› archive å’Œ index é¡µé¢ä¸­ä»…æ˜¾ç¤ºå‡ºå½“å‰è¯­è¨€é¡µé¢ã€‚  ç›¸å…³ç¼ºé™·  404 é¡µé¢æ— æ³•é…ç½®ï¼Œåªèƒ½åœ¨ 404.html é¡µé¢å†™ä¸Šä¸¤ç§è¯­è¨€ï¼› æ”¯æŒå¤šè¯­è¨€æ–‡ç« çš„åˆ†é¡µæ’ä»¶ jekyll-paginate-v2 æ²¡åœ¨ GitHub Pages æ”¯æŒçš„æ’ä»¶ç™½åå•å†…ï¼Œç›®å‰æœ¬åšå®¢é¦–é¡µä¸æ”¯æŒåˆ†é¡µã€‚å¤šè¯­è¨€åˆ†é¡µè¯¦è§ä¸‹æ–‡ï¼› å¤šè¯­è¨€æ—¶é—´è¡¨ç¤ºæœ‰ç‚¹éº»çƒ¦ï¼Œéœ€è¦åšä¸€äº›å­—ç¬¦ä¸²å¤„ç†å·¥ä½œï¼Œèƒ½å®ç°ä½†æ˜¯ä¸å¤ªä¼˜é›…ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ Jekyll-Date-Formattingã€‚  å¼€å§‹é…ç½® æœ€åˆï¼Œæˆ‘æœç´¢åˆ° i18n æ’ä»¶ Jekyll-Multiple-Languages-Pluginã€‚\nè¯¥ä»“åº“çš„ Star æ•°æ˜¯å¤šè¯­è¨€æ’ä»¶ä¸­æœ€å¤šçš„ï¼ŒåŒæ—¶é‡Œé¢ä¹Ÿåˆ—å‡ºäº†ç›¸å…³å…¶ä»–å¤šè¯­è¨€æ’ä»¶ï¼Œå·²ç»æ¯”è¾ƒå®Œå–„ï¼Œä¸æƒ³æŠ˜è…¾çš„å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚\nç›®å‰æˆ‘ä¸ºäº†ç®€å•å’Œå¯å®šåˆ¶åŒ–ï¼ŒåŒæ—¶çœç•¥æ‰æ’ä»¶ä¸­ä¸å¿…è¦çš„åŠŸèƒ½ï¼Œé€‰æ‹©ä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™æ¥å®ç°å¤šè¯­è¨€åŠŸèƒ½ã€‚\n1. å•ä¸ªåšæ–‡é…ç½® æ¯ä¸€ç¯‡æ–‡ç« å’Œé¡µé¢éœ€è¦å®šä¹‰ä¸¤ä¸ªå±æ€§ï¼š\n uid æ ‡ç¤ºæ–‡ç« å”¯ä¸€ï¼Œä¸€ç¯‡æ–‡ç« çš„ä¸­æ–‡ç‰ˆæœ¬å’Œè‹±æ–‡ç‰ˆæœ¬ uid ç›¸åŒï¼›  æ³¨æ„ï¼šuid å¯ä»¥è®¾ç½®ä¸ºä»»æ„å‘½åï¼Œæ¯”å¦‚ document_id ã€‚   locale æ ‡ç¤ºæ–‡ç« è¯­è¨€ï¼Œä¸€ç¯‡æ–‡ç« è¢«æ¸²æŸ“åä½œä¸ºå“ªç§è¯­è¨€å±•ç¤ºã€‚  æ‰€ä»¥æ¯ç¯‡æ–‡ç« çš„ Front Matter æ–°å¢å¦‚ä¸‹è®¾ç½®\n--- uid: hello-world locale: zh --- 2.","title":"Jekyll ä¸ä½¿ç”¨æ’ä»¶æ”¯æŒå¤šè¯­è¨€"},{"content":"åšå®¢é…ç½®ï¼š\n é™æ€ç½‘é¡µç”Ÿæˆå™¨  Jekyll 3.8.5 Ruby 2.6.0 ä¸»é¢˜ lagrange   ç½‘é¡µåˆ†æ  Google Aynalysis Baidu Aynalysis   éƒ¨ç½²  GitHub Pages    è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä½œä¸ºæœ€ç®€å•çš„ â€œä½ å¥½ ä¸–ç•Œâ€ï¼Œæˆ‘æƒ³è®°å½•ä¸€ä¸‹è¯¥åšå®¢çš„è¯ç”Ÿè¿‡ç¨‹ï¼Œä»¥åŠå¦‚æœä½ ä¹Ÿæƒ³æ­å»ºä¸€ä¸ªè‡ªå·±çš„åšå®¢åº”è¯¥æ€ä¹ˆåšã€‚\næœ¬æ–‡ç« å°†ä¼šæ¶‰åŠä¸‰ä¸ªéƒ¨åˆ†ï¼š\n é€‰æ‹©åšå®¢ç±»å‹ å‡†å¤‡å¥½æ‰€éœ€å†…å®¹ å°†ä»–ä»¬ç¼–æ’èµ·æ¥  ç¬¬ä¸€æ­¥ é€‰æ‹©åšå®¢ç±»å‹ æ ¹æ®å‰ç«¯ç½‘é¡µæ˜¯å¦ä¸åå°æœåŠ¡å™¨æˆ–è€…æ•°æ®åº“äº¤äº’åˆ†ä¸ºï¼šé™æ€ç½‘ç«™ / åŠ¨æ€ç½‘ç«™\né™æ€ç½‘ç«™ï¼š\n ä»…ä¾é  HTML / CSS / JS æ²¡æœ‰åå°æœåŠ¡å™¨å­˜å‚¨æ•°æ® æ•°æ®æ˜¯é¢„å…ˆç”Ÿæˆçš„  åŠ¨æ€ç½‘ç«™ï¼š\n ä¾èµ–å‰ç«¯ HTML / CSS / JS æ•°æ®ä»åå°æœåŠ¡å™¨è·å– èƒ½å¤ŸåŠ¨æ€å“åº”ç”¨æˆ·è¯·æ±‚  æ‰€ä»¥ï¼Œé™æ€åšå®¢ï¼š\n æ–‡ç« é¢„å…ˆç”Ÿæˆ ä¸ä¾èµ–åå°æœåŠ¡å™¨  åŠ¨æ€åšå®¢ï¼š\n æ–‡ç« ä»åå°æœåŠ¡å™¨è·å– å‰ç«¯é¡µé¢åŠ¨æ€è·å–  è€ƒè™‘åˆ°åˆšæ¥è§¦åˆ°åšå®¢æ­å»ºï¼Œå…ˆä»ç®€å•çš„é™æ€åšå®¢å…¥æ‰‹ã€‚ç›®å‰ GitHub ä¸Šæœ‰å¾ˆå¤šå¼€æºçš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ä½¿ç”¨ Jekyllã€‚\né€‰æ‹©åˆé€‚çš„é™æ€åšå®¢ç”Ÿæˆå™¨è¯·çœ‹ [Jekyll / Hugo / Hexo æ¯”è¾ƒ]({{ \u0026ldquo;/zh/posts/jekyll-hugo-hexo\u0026rdquo; | relative_url }})ã€‚\nç¬¬äºŒæ­¥ å‡†å¤‡å¥½æ‰€éœ€å†…å®¹ å‡†å¤‡å†…å®¹æ¶‰åŠä»¥ä¸‹æ–¹é¢ï¼š\n åšå®¢æ–‡ç«  åšå®¢ä»‹ç» ä½œè€…ä¿¡æ¯ åšå®¢åŸŸå  åšå®¢æ–‡ç«  æå‰å†™å¥½æ–‡ç« å‡†å¤‡å‘å¸ƒ\n GitHub Pages éƒ¨ç½²è®°å½•ï¼ˆæœ¬æ–‡ ğŸ˜†ï¼‰ [Jekyll ä¸ä½¿ç”¨æ’ä»¶æ”¯æŒå¤šè¯­è¨€]({{ \u0026ldquo;/zh/posts/jekyll-multi-language-without-plugin\u0026rdquo; | relative_url }})ï¼ˆæœ¬åšå®¢æ˜¯ä¸­æ–‡å’Œè‹±æ–‡ ğŸ˜†ï¼‰ [Jekyll / Hugo / Hexo æ¯”è¾ƒ]({{ \u0026ldquo;/zh/posts/jekyll-hugo-hexo\u0026rdquo; | relative_url }})ï¼ˆæœ¬åšå®¢ç”¨ Jekyll ğŸ˜†ï¼‰ å¦‚ä½•é€‰æ‹©ä¸€ä¸ªè‹±æ–‡åï¼ˆLex Cao ğŸ˜†ï¼‰  åšå®¢ä»‹ç» æå‰å†™å¥½åšå®¢ä»‹ç»ï¼Œåšå®¢åˆ›å»ºåˆæœŸå¯ä»¥åªåŒ…å«ç®€ç•¥ä¿¡æ¯ï¼Œä»¥åå†æ…¢æ…¢è¡¥å……ï¼Œ\nè¯¦ç»†è¯·çœ‹ [å…³äº]({{ \u0026ldquo;/zh/menu/about.html\u0026rdquo; | relative_url }})ã€‚\nä½œè€…ä¿¡æ¯ ç¬”å è¿™é‡Œæˆ‘ç»™è‡ªå·±å–äº†ä¸€ä¸ªè‹±æ–‡å Lex Cao\nå–è‹±æ–‡åå¯ä»¥å‚è€ƒ å¦‚ä½•é€‰æ‹©ä¸€ä¸ªè‹±æ–‡å\nåšå®¢å ä¸­æ–‡å ä»£ç ç¬”è®°\nè‹±æ–‡å CodingNotes\nåšå®¢åŸŸå caolixin.com ä¸­æ–‡æ‹¼éŸ³æ²¡å®é™…æ„ä¹‰\nlexcao.com å·²ç»è¢«å ç”¨\nthecodingnotes.com å¥½åƒä¸é”™ï¼Œä½†æ˜¯æœ‰ç‚¹é•¿\nç¬¬ä¸‰æ­¥ ç¼–æ’èµ·æ¥ Jekyll å®‰è£… ç›¸å…³å‚è€ƒé“¾æ¥\n Install on MacOS Jekyll with Bundle Creating a GitHub Pages with Jekyll  ä½¿ç”¨åˆ°çš„å‘½ä»¤\n# install ruby 2.6.0+ $ xcode-select --install $ brew install ruby $ export PATH=/usr/local/opt/ruby/bin:$PATH $ source ~/.zshrc # install jekyll \u0026amp; bundler $ gem install --user-install bundler jekyll $ export PATH=$HOME/.gem/ruby/2.6.0/bin:$PATH $ source ~/.zshrc # init $ cd /blogs/github-pages-jekyll $ git init $ jekyll new . $ jekyll serve # serve with bundle $ bundle exec jekyll serve ä¸»é¢˜é€‰æ‹© å…³äºä¸»é¢˜ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢ç®€çº¦ä¸€ç‚¹ã€‚\nåœ¨ç›¸å…³ä¸»é¢˜æµè§ˆç½‘ç«™ï¼š\n jekyllthemes.org/ jekyllthemes.io/  æ‰¾åˆ°çš„å¿ƒä»ªçš„ä¸»é¢˜ï¼š\n Lagrange Chalk Type Kikofri  é€‰å‡ºä»¥ä¸Š 4 ä¸ªä¸»é¢˜ï¼Œæœ€åä½¿ç”¨ lagrange ä½œä¸ºåšå®¢ä¸»é¢˜ã€‚\næ’ä»¶è¯´æ˜  GitHub Pages é›†æˆ Jekyll å®ç°è‡ªåŠ¨éƒ¨ç½²éœ€è¦æ’ä»¶ github-pagesã€‚è¯¥æ’ä»¶ä»…å…è®¸ä½¿ç”¨ç™½åå•å†…æ’ä»¶ï¼Œå…·ä½“è¯·çœ‹å…è®¸æ’ä»¶åŠç‰ˆæœ¬ï¼› è¦æƒ³ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶ï¼ˆç™½åå•ä»¥å¤–çš„æ’ä»¶ï¼‰ï¼Œä¸èƒ½ GitHub Pages çš„è‡ªåŠ¨éƒ¨ç½²åŠŸèƒ½ï¼Œéœ€è¦å°† _site ç›®å½•æ”¾åˆ°ä»“åº“ä¸Šï¼Œæ‰‹åŠ¨å®ç°è‡ªåŠ¨éƒ¨ç½²ï¼› æœ¬æ¬¡æ˜¯ç¬¬ä¸€æ¬¡æ­å»ºåšå®¢ï¼Œæ‰€ä»¥é€‰ç”¨äº† GitHub Pages çš„è‡ªåŠ¨éƒ¨ç½²ã€‚  å¤šè¯­è¨€é…ç½® å¤šè¯­è¨€é…ç½®ï¼Œéœ€è¦æŠ˜è…¾çš„åœ°æ–¹æ¯”è¾ƒå¤šï¼Œè¯¦ç»†è¯·çœ‹æ–‡ç« \nJekyll ä¸ä½¿ç”¨æ’ä»¶æ”¯æŒå¤šè¯­è¨€ã€‚\néƒ¨ç½²åˆ° GitHub Pages å®˜æ–¹æ•™ç¨‹\nåˆ›å»ºä¸€ä¸ªä»“åº“ ä»“åº“åéœ€è¦æŒ‰ç…§å›ºå®šæ ¼å¼ \u0026lt;user\u0026gt;.github.io\nå¦‚ï¼šlexcao.github.io\nå°†æ–‡ç« æ¨åˆ° GitHub # æ·»åŠ è¿œç¨‹ä»“åº“ $ git remote add origin https://github.com/lexcao/lexcao.github.io.git $ git push -u origin master ç½‘ç«™å·²å¯ä»¥è®¿é—® è¿›å…¥ä»“åº“è®¾ç½®é¡µé¢ Settings \u0026gt; Options \u0026gt; æ‹‰åˆ°æœ€ä¸‹é¢ï¼Œ\nYour site is published at https://lexcao.github.io/ åšå®¢å·²ç»å‘å¸ƒæˆåŠŸã€‚\nè®¿é—® https://lexcao.github.io/ å³å¯çœ‹åˆ°ã€‚\nå¯ä»¥åœ¨ environment çœ‹åˆ°åšå®¢éƒ¨ç½²æƒ…å†µï¼Œé»˜è®¤é…ç½®æ˜¯ master åˆ†æ”¯æœ‰ä»£ç æ›´æ–°ä¼šè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²ã€‚\nç½‘ç«™ç»Ÿè®¡ åšå®¢å¯ä»¥è®¿é—®ä»¥åï¼Œå°±å¯ä»¥å¼€å§‹æ¥å…¥ç½‘ç«™ç»Ÿè®¡ç›¸å…³åŠŸèƒ½ï¼Œå€ŸåŠ©ç¬¬ä¸‰æ–¹å¹³å°ã€‚\nGoogle Analytics  åœ¨ Google Analytics åˆ›å»ºåª’ä½“èµ„æºï¼Œæ‹¿åˆ°ä¸€ä¸ª UA-xxx-x IDï¼Œå¹¶ä¸”å¼•å…¥ç»Ÿè®¡ä»£ç ï¼› åœ¨ Google Tag Manager åˆ›å»ºè·Ÿè¸ªä»£ç ï¼Œæ ¹æ®ä¸Šé¢æ‹¿åˆ°çš„ UA-xxx-x ID æ–°å¢ä¸€ä¸ª Google Analytics ä»£ç è·Ÿè¸ªï¼Œå¼•å…¥å…¨å±€ç»Ÿè®¡ä»£ç ï¼Œå¹¶å‘å¸ƒã€‚ å¯é€‰æ‹©ï¼Œåœ¨ Google Analytics å…³è” Google Search Consoleã€‚  æ³¨æ„äº‹é¡¹ï¼š\n Google Tag Manager ä¸å…è®¸å˜é‡ä¸ºä¸­æ–‡å; é‡æ–°å‘å¸ƒ GitHub Pages ç”Ÿæ•ˆåï¼Œå¦‚æœè¯·æ±‚ js æ–‡ä»¶ net::ERR_BLOCKED_BY_CLIENT é”™è¯¯ï¼Œå…³æ‰å¹¿å‘Šæ‹¦æˆªæ’ä»¶é‡è¯•ã€‚  Baidu Analytics åœ¨ ç™¾åº¦ç»Ÿè®¡ å…³è”ä¸Šç½‘é¡µï¼Œå¼•å…¥ç»Ÿè®¡ä»£ç ï¼Œå®Œæˆé…ç½®ã€‚\nå®æ—¶æ€§æ¯” Google ç¨å¾®å·®ä¸€ç‚¹ï¼ˆå¯èƒ½æ˜¯ github.io è¿™ä¸ªåŸŸååœ¨å›½å¤–çš„åŸå› ï¼‰\nç»“è¯­ è‡³æ­¤ï¼Œæ•´ä¸ªåšå®¢å·²ç»å®Œç¾è¿è½¬äº†ï¼Œå¯ä»¥å¼€å§‹ä¸“å¿ƒå†™æ–‡ç« äº† ğŸ˜Šã€‚\n","permalink":"https://lexcao.io/zh/posts/hello-world/","summary":"åšå®¢é…ç½®ï¼š\n é™æ€ç½‘é¡µç”Ÿæˆå™¨  Jekyll 3.8.5 Ruby 2.6.0 ä¸»é¢˜ lagrange   ç½‘é¡µåˆ†æ  Google Aynalysis Baidu Aynalysis   éƒ¨ç½²  GitHub Pages    è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä½œä¸ºæœ€ç®€å•çš„ â€œä½ å¥½ ä¸–ç•Œâ€ï¼Œæˆ‘æƒ³è®°å½•ä¸€ä¸‹è¯¥åšå®¢çš„è¯ç”Ÿè¿‡ç¨‹ï¼Œä»¥åŠå¦‚æœä½ ä¹Ÿæƒ³æ­å»ºä¸€ä¸ªè‡ªå·±çš„åšå®¢åº”è¯¥æ€ä¹ˆåšã€‚\næœ¬æ–‡ç« å°†ä¼šæ¶‰åŠä¸‰ä¸ªéƒ¨åˆ†ï¼š\n é€‰æ‹©åšå®¢ç±»å‹ å‡†å¤‡å¥½æ‰€éœ€å†…å®¹ å°†ä»–ä»¬ç¼–æ’èµ·æ¥  ç¬¬ä¸€æ­¥ é€‰æ‹©åšå®¢ç±»å‹ æ ¹æ®å‰ç«¯ç½‘é¡µæ˜¯å¦ä¸åå°æœåŠ¡å™¨æˆ–è€…æ•°æ®åº“äº¤äº’åˆ†ä¸ºï¼šé™æ€ç½‘ç«™ / åŠ¨æ€ç½‘ç«™\né™æ€ç½‘ç«™ï¼š\n ä»…ä¾é  HTML / CSS / JS æ²¡æœ‰åå°æœåŠ¡å™¨å­˜å‚¨æ•°æ® æ•°æ®æ˜¯é¢„å…ˆç”Ÿæˆçš„  åŠ¨æ€ç½‘ç«™ï¼š\n ä¾èµ–å‰ç«¯ HTML / CSS / JS æ•°æ®ä»åå°æœåŠ¡å™¨è·å– èƒ½å¤ŸåŠ¨æ€å“åº”ç”¨æˆ·è¯·æ±‚  æ‰€ä»¥ï¼Œé™æ€åšå®¢ï¼š\n æ–‡ç« é¢„å…ˆç”Ÿæˆ ä¸ä¾èµ–åå°æœåŠ¡å™¨  åŠ¨æ€åšå®¢ï¼š\n æ–‡ç« ä»åå°æœåŠ¡å™¨è·å– å‰ç«¯é¡µé¢åŠ¨æ€è·å–  è€ƒè™‘åˆ°åˆšæ¥è§¦åˆ°åšå®¢æ­å»ºï¼Œå…ˆä»ç®€å•çš„é™æ€åšå®¢å…¥æ‰‹ã€‚ç›®å‰ GitHub ä¸Šæœ‰å¾ˆå¤šå¼€æºçš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ä½¿ç”¨ Jekyllã€‚","title":"ä½ å¥½ ä¸–ç•Œ"},{"content":"ä½ å¥½ ç½‘ä¸Šé‚»å±… æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œæˆ‘æ˜¯ æ›¹å†é‘« Lex Caoã€‚\næœ¬åšå®¢åä¸º ä»£ç ç¬”è®° CodingNotesã€‚\næœ¬åšå®¢ç”¨äº åˆ†äº«/æ€»ç»“/è®°å½• æˆ‘çš„ç”Ÿæ´»æˆ–å·¥ä½œä¸­è·Ÿç¼–ç¨‹æœ‰å…³çš„ çŸ¥è¯†/æ€è€ƒ/æƒ³æ³•ã€‚\nå…³äºæˆ‘ ç°å±… æ·±åœ³ã€‚\nä½¿ç”¨\n Java / Kotlinï¼ˆä¸»è¦ä½¿ç”¨ â¤ï¸ï¼‰ï¼› SpringBootï¼› SpringCloudã€‚  å¦‚æœä½ æƒ³ è”ç³»æˆ‘ã€‚\nå…³äºåšå®¢ é™æ€ç½‘ç«™ç”Ÿæˆå™¨\n Jekyll 4.0 https://jekyllrb.com/ ä½¿ç”¨ä¸»é¢˜ Lagrange http://jekyllthemes.org/themes/lagrange/  ä»£ç æ‰˜ç®¡\n GitHub åšå®¢æºç åœ¨è¿™é‡Œ  åšå®¢éƒ¨ç½²\n GitHub Pages  ä¸­è‹±æ”¯æŒ ä¸ºäº†æ›´å¥½çš„ç»ƒä¹ è‹±æ–‡ï¼Œæœ¬åšå®¢æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡ä¸¤ç§è¯­è¨€ã€‚æœ‰å¯¹åº”è¯­è¨€çš„é¡µé¢æ—¶ï¼Œå¯ä»¥ç‚¹å‡»å³ä¸Šè§’çš„è¯­è¨€å­—ç¬¦è¿›è¡Œåˆ‡æ¢ã€‚\né¡ºä¾¿ä¸€æï¼Œæœ¬åšå®¢ä»¥è‹±æ–‡ä¸ºä¸»ï¼Œå½“ç„¶ï¼Œä¹Ÿä¼šæœ‰ç›¸åº”çš„ä¸­æ–‡å†…å®¹ã€‚\næ•¬è¯·æœŸå¾…ã€‚\næ„Ÿè°¢ä½ çš„é©»è¶³ ç›¸å…³é“¾æ¥  Codeicon by Icons8 Powered by Jekyll with Lagrange theme Deployed by GitHub Pages Free to use photos by Pexels Free to use photos by Unsplash  ","permalink":"https://lexcao.io/zh/about/","summary":"ä½ å¥½ ç½‘ä¸Šé‚»å±… æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œæˆ‘æ˜¯ æ›¹å†é‘« Lex Caoã€‚\næœ¬åšå®¢åä¸º ä»£ç ç¬”è®° CodingNotesã€‚\næœ¬åšå®¢ç”¨äº åˆ†äº«/æ€»ç»“/è®°å½• æˆ‘çš„ç”Ÿæ´»æˆ–å·¥ä½œä¸­è·Ÿç¼–ç¨‹æœ‰å…³çš„ çŸ¥è¯†/æ€è€ƒ/æƒ³æ³•ã€‚\nå…³äºæˆ‘ ç°å±… æ·±åœ³ã€‚\nä½¿ç”¨\n Java / Kotlinï¼ˆä¸»è¦ä½¿ç”¨ â¤ï¸ï¼‰ï¼› SpringBootï¼› SpringCloudã€‚  å¦‚æœä½ æƒ³ è”ç³»æˆ‘ã€‚\nå…³äºåšå®¢ é™æ€ç½‘ç«™ç”Ÿæˆå™¨\n Jekyll 4.0 https://jekyllrb.com/ ä½¿ç”¨ä¸»é¢˜ Lagrange http://jekyllthemes.org/themes/lagrange/  ä»£ç æ‰˜ç®¡\n GitHub åšå®¢æºç åœ¨è¿™é‡Œ  åšå®¢éƒ¨ç½²\n GitHub Pages  ä¸­è‹±æ”¯æŒ ä¸ºäº†æ›´å¥½çš„ç»ƒä¹ è‹±æ–‡ï¼Œæœ¬åšå®¢æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡ä¸¤ç§è¯­è¨€ã€‚æœ‰å¯¹åº”è¯­è¨€çš„é¡µé¢æ—¶ï¼Œå¯ä»¥ç‚¹å‡»å³ä¸Šè§’çš„è¯­è¨€å­—ç¬¦è¿›è¡Œåˆ‡æ¢ã€‚\né¡ºä¾¿ä¸€æï¼Œæœ¬åšå®¢ä»¥è‹±æ–‡ä¸ºä¸»ï¼Œå½“ç„¶ï¼Œä¹Ÿä¼šæœ‰ç›¸åº”çš„ä¸­æ–‡å†…å®¹ã€‚\næ•¬è¯·æœŸå¾…ã€‚\næ„Ÿè°¢ä½ çš„é©»è¶³ ç›¸å…³é“¾æ¥  Codeicon by Icons8 Powered by Jekyll with Lagrange theme Deployed by GitHub Pages Free to use photos by Pexels Free to use photos by Unsplash  ","title":"å…³äº"},{"content":"Reactive Streams Reactive Streams åœ¨ Netflix ã€Pivotal å’Œ Lightbend å·¥ç¨‹å¸ˆäº 2013 å¹´åº•å‘èµ·è¿™é¡¹è®¡åˆ’ã€‚\n Reactive Streams æ˜¯ä¸€é¡¹æè®®ï¼Œä¸ºæ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥æµæä¾›ä¸€ä¸ªæ ‡å‡†ã€‚è¿™åŒ…æ‹¬é’ˆå¯¹è¿è¡Œæ—¶ç¯å¢ƒï¼ˆJVM å’Œ JavaScriptï¼‰ä»¥åŠç½‘ç»œåè®®ä¸Šçš„å·¥ä½œã€‚\n ä½ å¯ä»¥åœ¨ Reactive Streams å®˜ç½‘ç½‘ç«™é˜…è¯»è¿™ä¸ªåŸå§‹è§„èŒƒã€‚\nä½ ä¹Ÿå¯ä»¥åœ¨ è¿™é‡Œ é˜…è¯»å®ƒçš„ä¸­æ–‡ç¿»è¯‘ã€‚\næ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥æµå¤„ç† Reactive Streams ç”±ä»¥ä¸‹ç»„æˆï¼š\n å¼‚æ­¥ï¼› æµå¼ï¼› æ— é˜»å¡ï¼› èƒŒå‹ï¼ˆå›å‹ï¼‰ã€‚  ä»¥ä¸‹æ˜¯ Java æ¥å£ï¼Œä½ å¯ä»¥åœ¨ GitHub é˜…è¯»æ›´è¯¦ç»†å†…å®¹ã€‚\npublic interface Publisher\u0026lt;T\u0026gt; { public void subscribe(Subscriber\u0026lt;? super T\u0026gt; s); } public interface Subscriber\u0026lt;T\u0026gt; { public void onSubscribe(Subscription s); public void onNext(T t); public void onError(Throwable t); public void onComplete(); } public interface Subscription { public void request(long n); public void cancel(); } public interface Processor\u0026lt;T, R\u0026gt; extends Subscriber\u0026lt;T\u0026gt;, Publisher\u0026lt;R\u0026gt; { } Reactive Extensions  ç”¨äºå¯è§‚å¯Ÿæµçš„å¼‚æ­¥ç¼–ç¨‹ APIã€‚\nReactiveX æ˜¯æ¥è‡ªè§‚å¯Ÿè€…æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ä»¥åŠå‡½æ•°å¼ç¼–ç¨‹çš„æœ€ä½³åˆ›æ„ç»„åˆã€‚\n\u0026ndash; Reactive Extensions\n Project Reactor  Reactor æ˜¯ç¬¬å››ä»£ Reactive å‡½æ•°åº“ï¼ŒåŸºäº Reactive Streams è§„èŒƒ åœ¨ JVM ä¸Šæ„å»ºæ— é˜»å¡åº”ç”¨ã€‚\n   å¯ç»„åˆæ€§å’Œå¯è¯»æ€§ ä»¥ä¸°å¯Œçš„æ“ä½œç¬¦æ–¹æ³•æ“ä½œæ•°æ®æµ è®¢é˜…ä¹‹å‰æ²¡æœ‰ä»»ä½•ååº” èƒŒå‹æˆ–è€…æ¶ˆè´¹è€…å…·æœ‰é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§é€Ÿç‡è¿‡é«˜èƒ½åŠ› å¹¶å‘ä¸Šçš„é«˜çº§æŠ½è±¡  \u0026ndash; From Imperative to Reactive Programming\n åŠŸèƒ½ï¼š\n å®Œå…¨æ— é˜»å¡ï¼› é›†æˆ Java APIï¼š  Completable Future Stream Duration   Flux å’Œ Mono  Fluxï¼šä¸€ä¸ª Reactive Streams å‘å¸ƒè€…ï¼Œå…·æœ‰ rx æ“ä½œç¬¦ï¼Œå®ƒå‘å‡º 0 åˆ° N ä¸ªå…ƒç´ ï¼Œç„¶åå®Œæˆã€‚ Monoï¼šä¸€ä¸ª Reactive Streams å‘å¸ƒè€…ï¼Œå…·æœ‰ rx æ“ä½œç¬¦ï¼Œå‘å‡º ä¸€ä¸ª å…ƒç´ æˆåŠŸå®Œæˆï¼Œæˆ–è€…ä¸€ä¸ªå¼‚å¸¸ã€‚   å®ç°äº† Reactive Streams è§„èŒƒã€‚  ä½ å¯ä»¥åœ¨ GitHub é˜…è¯»æ›´å¤šç»†èŠ‚ã€‚\nå½“ç„¶ï¼Œä½ å¯ä»¥æ ¹æ®è¿™ä¸ª å¿«é€Ÿä¸Šæ‰‹ Rx API æ¥å­¦ä¹ åŸºç¡€çš„æ¥å£ã€‚\nè¿™é‡Œæœ‰ä¸ª å¸®åŠ©ä½ å¦‚ä½•é€‰æ‹©æ“ä½œç¬¦\nReactor Netty  Reactor Netty åŸºäº Netty æ¡†æ¶ï¼Œæä¾›æ— é˜»å¡å’ŒèƒŒå‹å°±ç»ªçš„ TCP/HTTP/UDP å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ã€‚\n\u0026ndash; Reactor Netty\n Spring Reactor WebFlux  Reactive æŠ€æœ¯æ ˆçš„ç½‘ç»œæ¡†æ¶ï¼ŒSpring WebFluxï¼Œåœ¨ 5.0ç‰ˆæœ¬åæœŸåŠ å…¥ã€‚å®ƒæ˜¯å®Œå…¨æ— é˜»å¡ï¼Œæ”¯æŒ Reactive Streams èƒŒå‹ï¼Œå¹¶ä¸”åœ¨ Nettyã€Undertow ä»¥åŠ Servlet .3.1+ ç­‰æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚\n\u0026ndash; Spring WebFlux\n RSocket åŸºäº Reactive Sreams èƒŒå‹çš„ä¸€ä¸ªäºŒè¿›åˆ¶åè®®\nåŠŸèƒ½ï¼š\n åŒå‘çš„ å¤šè·¯å¤ç”¨ åŸºäºæ¶ˆæ¯ï¼ˆmessage drivenï¼‰ äºŒè¿›åˆ¶åè®®  äº¤äº’æ¨¡å‹ï¼š\n è¯·æ±‚-å“åº”ï¼ˆ 1 å¯¹ 1 ï¼‰ å‘é€ - å¿˜å´ ï¼ˆ 1 å¯¹ 0 UDPï¼‰ è¯·æ±‚ - æµå¼ï¼ˆ 1 å¯¹å¤šï¼Œå‘å¸ƒ / è®¢é˜…ï¼‰ è¯·æ±‚ - é€šé“ ï¼ˆå¤šå¯¹å¤šï¼‰  é€šä¿¡åè®®\n WebSocket TCP UDP  æ€»ç»“ Reactive Streams æ˜¯ä¸€ä¸ªè§„èŒƒã€‚\nProject Reactor æ˜¯åŸºäºè§„èŒƒçš„ JVM å®ç°ã€‚\nSpring WebFlux æ˜¯ Spring æ¡†æ¶é›†æˆ Project Reactorã€‚\nRSocket æ˜¯åŸºäºè§„èŒƒäºŒè¿›åˆ¶åè®®å®ç°ã€‚\nå‚è€ƒé“¾æ¥  Reactive Streams Reactive Streams JVM Reactive Extensions Project Reactor Reactor Core å¿«é€Ÿä¸Šæ‰‹ Rx API å¸®åŠ©ä½ å¦‚ä½•é€‰æ‹©æ“ä½œç¬¦ Reactor Netty Spring WebFlux  ","permalink":"https://lexcao.io/zh/posts/reactive-overview/","summary":"Reactive Streams Reactive Streams åœ¨ Netflix ã€Pivotal å’Œ Lightbend å·¥ç¨‹å¸ˆäº 2013 å¹´åº•å‘èµ·è¿™é¡¹è®¡åˆ’ã€‚\n Reactive Streams æ˜¯ä¸€é¡¹æè®®ï¼Œä¸ºæ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥æµæä¾›ä¸€ä¸ªæ ‡å‡†ã€‚è¿™åŒ…æ‹¬é’ˆå¯¹è¿è¡Œæ—¶ç¯å¢ƒï¼ˆJVM å’Œ JavaScriptï¼‰ä»¥åŠç½‘ç»œåè®®ä¸Šçš„å·¥ä½œã€‚\n ä½ å¯ä»¥åœ¨ Reactive Streams å®˜ç½‘ç½‘ç«™é˜…è¯»è¿™ä¸ªåŸå§‹è§„èŒƒã€‚\nä½ ä¹Ÿå¯ä»¥åœ¨ è¿™é‡Œ é˜…è¯»å®ƒçš„ä¸­æ–‡ç¿»è¯‘ã€‚\næ— é˜»å¡èƒŒå‹çš„å¼‚æ­¥æµå¤„ç† Reactive Streams ç”±ä»¥ä¸‹ç»„æˆï¼š\n å¼‚æ­¥ï¼› æµå¼ï¼› æ— é˜»å¡ï¼› èƒŒå‹ï¼ˆå›å‹ï¼‰ã€‚  ä»¥ä¸‹æ˜¯ Java æ¥å£ï¼Œä½ å¯ä»¥åœ¨ GitHub é˜…è¯»æ›´è¯¦ç»†å†…å®¹ã€‚\npublic interface Publisher\u0026lt;T\u0026gt; { public void subscribe(Subscriber\u0026lt;? super T\u0026gt; s); } public interface Subscriber\u0026lt;T\u0026gt; { public void onSubscribe(Subscription s); public void onNext(T t); public void onError(Throwable t); public void onComplete(); } public interface Subscription { public void request(long n); public void cancel(); } public interface Processor\u0026lt;T, R\u0026gt; extends Subscriber\u0026lt;T\u0026gt;, Publisher\u0026lt;R\u0026gt; { } Reactive Extensions  ç”¨äºå¯è§‚å¯Ÿæµçš„å¼‚æ­¥ç¼–ç¨‹ APIã€‚","title":"Reactive æ¦‚è§ˆ"},{"content":"","permalink":"https://lexcao.io/zh/projects/","summary":"","title":"é¡¹ç›®"}]